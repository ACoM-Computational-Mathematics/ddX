\hypertarget{namespaceddx__constants}{}\doxysection{ddx\+\_\+constants Module Reference}
\label{namespaceddx__constants}\index{ddx\_constants@{ddx\_constants}}


Run-\/time constants.  


\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespaceddx__constants_aa10b4ebb5a70e2cac960a9f0a955b29a}{constants\+\_\+init}} (params, constants, info)
\begin{DoxyCompactList}\small\item\em Compute all necessary constants. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__constants_ac2f7e9e3cf53501601684b98199d97eb}{build\+\_\+itrnl}} (constants, params)
\item 
subroutine \mbox{\hyperlink{namespaceddx__constants_a82cd03b034a0452e6ca6a495408fed03}{build\+\_\+l}} (constants, params)
\item 
subroutine \mbox{\hyperlink{namespaceddx__constants_a224edbeb3786b8d69a5dbbe6856a0df1}{build\+\_\+b}} (constants, params)
\item 
subroutine \mbox{\hyperlink{namespaceddx__constants_af5826bc847008b2eb36949c6b05b3e5d}{mkpmat}} (params, constants, isph, pmat)
\item 
subroutine \mbox{\hyperlink{namespaceddx__constants_ad201f9bbff917677cd4aeb165d296fad}{constants\+\_\+geometry\+\_\+init}} (params, constants, info)
\begin{DoxyCompactList}\small\item\em Initialize geometry-\/related constants like list of neighbouring spheres. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__constants_a2e8004415b03c502f25cffc06095f7f7}{neighbor\+\_\+list\+\_\+init}} (params, constants, info)
\item 
subroutine \mbox{\hyperlink{namespaceddx__constants_a4dac7789e6c13db2e1faaf356c3bd465}{neighbor\+\_\+list\+\_\+init\+\_\+fmm}} (params, constants, info)
\item 
subroutine \mbox{\hyperlink{namespaceddx__constants_abb90d5f168551ac11b842a8166c8b859}{constants\+\_\+geometry\+\_\+update}} (params, constants, info)
\begin{DoxyCompactList}\small\item\em Update geometry-\/related constants like list of neighbouring spheres. \end{DoxyCompactList}\item 
real(dp) function \mbox{\hyperlink{namespaceddx__constants_abb0c060445e3b2d40b770eda26d20fdb}{fsw}} (t, se, eta)
\begin{DoxyCompactList}\small\item\em Switching function. \end{DoxyCompactList}\item 
real(dp) function \mbox{\hyperlink{namespaceddx__constants_a66fd73de84672f0f78f4c9c4e2c620b5}{dfsw}} (t, se, eta)
\begin{DoxyCompactList}\small\item\em Derivative of a switching function. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__constants_a5d1fc3f2c16984ceaa0e1ed9de8fb548}{mkprec}} (lmax, nbasis, nsph, ngrid, eps, ui, wgrid, vgrid, vgrid\+\_\+nbasis, rx\+\_\+prc, info, error\+\_\+message)
\begin{DoxyCompactList}\small\item\em Compute preconditioner. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__constants_a71a53ad578c20da9306b93deda562aeb}{tree\+\_\+rib\+\_\+build}} (nsph, csph, rsph, order, cluster, children, parent, cnode, rnode, snode)
\begin{DoxyCompactList}\small\item\em Build a recursive inertial binary tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__constants_a7c5d6aebc32c85aa05d4a74678ff95f7}{tree\+\_\+rib\+\_\+node\+\_\+bisect}} (nsph, csph, n, order, div)
\begin{DoxyCompactList}\small\item\em Divide given cluster of spheres into two subclusters by inertial bisection. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__constants_a3e9f0301398a1007b912f94c7239dffd}{tree\+\_\+get\+\_\+farnear\+\_\+work}} (n, children, cnode, rnode, lwork, iwork, jwork, work, nnfar, nfar, nnnear, nnear)
\begin{DoxyCompactList}\small\item\em Find near and far admissible pairs of tree nodes and store it in work array. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__constants_afa4961d4e2731a6ade2dd395d00a87d9}{tree\+\_\+get\+\_\+farnear}} (jwork, lwork, work, n, nnfar, nfar, sfar, far, nnnear, nnear, snear, near)
\item 
subroutine \mbox{\hyperlink{namespaceddx__constants_a585af3a4fe1789337b34397ffcb34d45}{constants\+\_\+free}} (constants, info)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Run-\/time constants. 

\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespaceddx__constants_aa10b4ebb5a70e2cac960a9f0a955b29a}\label{namespaceddx__constants_aa10b4ebb5a70e2cac960a9f0a955b29a}} 
\index{ddx\_constants@{ddx\_constants}!constants\_init@{constants\_init}}
\index{constants\_init@{constants\_init}!ddx\_constants@{ddx\_constants}}
\doxysubsubsection{\texorpdfstring{constants\_init()}{constants\_init()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+constants\+::constants\+\_\+init (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(out)}]{constants,  }\item[{integer, intent(out)}]{info }\end{DoxyParamCaption})}



Compute all necessary constants. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em params} & Object containing all inputs. \\
\hline
\mbox{\texttt{ out}}  & {\em constants} & Object containing all constants. \\
\hline
\mbox{\texttt{ out}}  & {\em info} & flag of succesfull exit = 0\+: Succesfull exit = -\/1\+: params is in error state = 1\+: Allocation of memory failed. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__constants_8f90_source_l00262}{262}} of file \mbox{\hyperlink{ddx__constants_8f90_source}{ddx\+\_\+constants.\+f90}}.

\mbox{\Hypertarget{namespaceddx__constants_ac2f7e9e3cf53501601684b98199d97eb}\label{namespaceddx__constants_ac2f7e9e3cf53501601684b98199d97eb}} 
\index{ddx\_constants@{ddx\_constants}!build\_itrnl@{build\_itrnl}}
\index{build\_itrnl@{build\_itrnl}!ddx\_constants@{ddx\_constants}}
\doxysubsubsection{\texorpdfstring{build\_itrnl()}{build\_itrnl()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+constants\+::build\+\_\+itrnl (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(inout)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__constants_8f90_source_l00646}{646}} of file \mbox{\hyperlink{ddx__constants_8f90_source}{ddx\+\_\+constants.\+f90}}.

\mbox{\Hypertarget{namespaceddx__constants_a82cd03b034a0452e6ca6a495408fed03}\label{namespaceddx__constants_a82cd03b034a0452e6ca6a495408fed03}} 
\index{ddx\_constants@{ddx\_constants}!build\_l@{build\_l}}
\index{build\_l@{build\_l}!ddx\_constants@{ddx\_constants}}
\doxysubsubsection{\texorpdfstring{build\_l()}{build\_l()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+constants\+::build\+\_\+l (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(inout)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__constants_8f90_source_l00666}{666}} of file \mbox{\hyperlink{ddx__constants_8f90_source}{ddx\+\_\+constants.\+f90}}.

\mbox{\Hypertarget{namespaceddx__constants_a224edbeb3786b8d69a5dbbe6856a0df1}\label{namespaceddx__constants_a224edbeb3786b8d69a5dbbe6856a0df1}} 
\index{ddx\_constants@{ddx\_constants}!build\_b@{build\_b}}
\index{build\_b@{build\_b}!ddx\_constants@{ddx\_constants}}
\doxysubsubsection{\texorpdfstring{build\_b()}{build\_b()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+constants\+::build\+\_\+b (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(inout)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__constants_8f90_source_l00728}{728}} of file \mbox{\hyperlink{ddx__constants_8f90_source}{ddx\+\_\+constants.\+f90}}.

\mbox{\Hypertarget{namespaceddx__constants_af5826bc847008b2eb36949c6b05b3e5d}\label{namespaceddx__constants_af5826bc847008b2eb36949c6b05b3e5d}} 
\index{ddx\_constants@{ddx\_constants}!mkpmat@{mkpmat}}
\index{mkpmat@{mkpmat}!ddx\_constants@{ddx\_constants}}
\doxysubsubsection{\texorpdfstring{mkpmat()}{mkpmat()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+constants\+::mkpmat (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(in)}]{constants,  }\item[{integer, intent(in)}]{isph,  }\item[{real(dp), dimension(constants \% nbasis, constants \% nbasis0), intent(inout)}]{pmat }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__constants_8f90_source_l00801}{801}} of file \mbox{\hyperlink{ddx__constants_8f90_source}{ddx\+\_\+constants.\+f90}}.

\mbox{\Hypertarget{namespaceddx__constants_ad201f9bbff917677cd4aeb165d296fad}\label{namespaceddx__constants_ad201f9bbff917677cd4aeb165d296fad}} 
\index{ddx\_constants@{ddx\_constants}!constants\_geometry\_init@{constants\_geometry\_init}}
\index{constants\_geometry\_init@{constants\_geometry\_init}!ddx\_constants@{ddx\_constants}}
\doxysubsubsection{\texorpdfstring{constants\_geometry\_init()}{constants\_geometry\_init()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+constants\+::constants\+\_\+geometry\+\_\+init (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(inout)}]{constants,  }\item[{integer, intent(out)}]{info }\end{DoxyParamCaption})}



Initialize geometry-\/related constants like list of neighbouring spheres. 

This routine does not check error state of params or constants as it is intended for a low-\/level use.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em params} & Object containing all inputs. \\
\hline
\mbox{\texttt{ in,out}}  & {\em constants} & Object containing all constants. \\
\hline
\mbox{\texttt{ out}}  & {\em info} & flag of succesfull exit = 0\+: Succesfull exit = -\/1\+: params is in error state = 1\+: Allocation of memory failed. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__constants_8f90_source_l00839}{839}} of file \mbox{\hyperlink{ddx__constants_8f90_source}{ddx\+\_\+constants.\+f90}}.

\mbox{\Hypertarget{namespaceddx__constants_a2e8004415b03c502f25cffc06095f7f7}\label{namespaceddx__constants_a2e8004415b03c502f25cffc06095f7f7}} 
\index{ddx\_constants@{ddx\_constants}!neighbor\_list\_init@{neighbor\_list\_init}}
\index{neighbor\_list\_init@{neighbor\_list\_init}!ddx\_constants@{ddx\_constants}}
\doxysubsubsection{\texorpdfstring{neighbor\_list\_init()}{neighbor\_list\_init()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+constants\+::neighbor\+\_\+list\+\_\+init (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(inout)}]{constants,  }\item[{integer, intent(out)}]{info }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__constants_8f90_source_l01180}{1180}} of file \mbox{\hyperlink{ddx__constants_8f90_source}{ddx\+\_\+constants.\+f90}}.

\mbox{\Hypertarget{namespaceddx__constants_a4dac7789e6c13db2e1faaf356c3bd465}\label{namespaceddx__constants_a4dac7789e6c13db2e1faaf356c3bd465}} 
\index{ddx\_constants@{ddx\_constants}!neighbor\_list\_init\_fmm@{neighbor\_list\_init\_fmm}}
\index{neighbor\_list\_init\_fmm@{neighbor\_list\_init\_fmm}!ddx\_constants@{ddx\_constants}}
\doxysubsubsection{\texorpdfstring{neighbor\_list\_init\_fmm()}{neighbor\_list\_init\_fmm()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+constants\+::neighbor\+\_\+list\+\_\+init\+\_\+fmm (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(inout)}]{constants,  }\item[{integer, intent(out)}]{info }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__constants_8f90_source_l01269}{1269}} of file \mbox{\hyperlink{ddx__constants_8f90_source}{ddx\+\_\+constants.\+f90}}.

\mbox{\Hypertarget{namespaceddx__constants_abb90d5f168551ac11b842a8166c8b859}\label{namespaceddx__constants_abb90d5f168551ac11b842a8166c8b859}} 
\index{ddx\_constants@{ddx\_constants}!constants\_geometry\_update@{constants\_geometry\_update}}
\index{constants\_geometry\_update@{constants\_geometry\_update}!ddx\_constants@{ddx\_constants}}
\doxysubsubsection{\texorpdfstring{constants\_geometry\_update()}{constants\_geometry\_update()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+constants\+::constants\+\_\+geometry\+\_\+update (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(out)}]{constants,  }\item[{integer, intent(out)}]{info }\end{DoxyParamCaption})}



Update geometry-\/related constants like list of neighbouring spheres. 

This procedure simply deletes current geometry constants and initializes new ones.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em params} & Object containing all inputs. \\
\hline
\mbox{\texttt{ in,out}}  & {\em constants} & Object containing all constants. \\
\hline
\mbox{\texttt{ out}}  & {\em info} & flag of succesfull exit = 0\+: Succesfull exit = -\/1\+: params is in error state = 1\+: Allocation of memory failed. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__constants_8f90_source_l01376}{1376}} of file \mbox{\hyperlink{ddx__constants_8f90_source}{ddx\+\_\+constants.\+f90}}.

\mbox{\Hypertarget{namespaceddx__constants_abb0c060445e3b2d40b770eda26d20fdb}\label{namespaceddx__constants_abb0c060445e3b2d40b770eda26d20fdb}} 
\index{ddx\_constants@{ddx\_constants}!fsw@{fsw}}
\index{fsw@{fsw}!ddx\_constants@{ddx\_constants}}
\doxysubsubsection{\texorpdfstring{fsw()}{fsw()}}
{\footnotesize\ttfamily real(dp) function ddx\+\_\+constants\+::fsw (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{t,  }\item[{real(dp), intent(in)}]{se,  }\item[{real(dp), intent(in)}]{eta }\end{DoxyParamCaption})}



Switching function. 

This is an implementation of $ \chi(t) $ with a shift $ se $\+: \[
      \chi_\eta(t) = \left\{ \begin{array}{ll} 0, & \text{if} \quad x \geq
      1 \\ p_\eta(x), & \text{if} \quad 1-\eta < x < 1 \\ 1, & \text{if}
      \quad x \leq 1-\eta \end{array} \right.
 \] where $ x = t - \frac{1+se}{2} \eta $ is a shifted coordinate and \[
      p_\eta(x) = \frac{1}{\eta^5} (1-t)^3 (6t^2 + (15\eta-12)t + (10\eta^2
      -15\eta+6))
 \] is a smoothing polynomial of the 5th degree. In the case shift $ se=1 $ the switch function $ \chi_\eta(t) $ is 1 for $ t \in [0,1] $, is 0 for $ t \in [1+\eta, \infty) $ and varies in $ [1, 1+\eta] $ which is an external shift. In the case shift $ se=-1 $ the switch function $ \chi_\eta(t) $ is 1 for $ t \in [0,1-\eta] $, is 0 for $ t \in [1, \infty) $ and varies in $ [1-\eta, 1] $ which is an internal shift. In the case shift $ se=0 $ the switch function $ \chi_\eta(t) $ is 1 for $ t \in [0,1-\eta/2] $, is 0 for $ t \in [1+\eta/2, \infty) $ and varies in $ [1-\eta/2, 1+\eta/2] $ which is a centered shift.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em t} & real non-\/negative input value \\
\hline
\mbox{\texttt{ in}}  & {\em se} & shift \\
\hline
\mbox{\texttt{ in}}  & {\em eta} & regularization parameter $ \eta $ \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__constants_8f90_source_l01415}{1415}} of file \mbox{\hyperlink{ddx__constants_8f90_source}{ddx\+\_\+constants.\+f90}}.

\mbox{\Hypertarget{namespaceddx__constants_a66fd73de84672f0f78f4c9c4e2c620b5}\label{namespaceddx__constants_a66fd73de84672f0f78f4c9c4e2c620b5}} 
\index{ddx\_constants@{ddx\_constants}!dfsw@{dfsw}}
\index{dfsw@{dfsw}!ddx\_constants@{ddx\_constants}}
\doxysubsubsection{\texorpdfstring{dfsw()}{dfsw()}}
{\footnotesize\ttfamily real(dp) function ddx\+\_\+constants\+::dfsw (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{t,  }\item[{real(dp), intent(in)}]{se,  }\item[{real(dp), intent(in)}]{eta }\end{DoxyParamCaption})}



Derivative of a switching function. 

This is an implementation of $ \chi\textnormal{\textquotesingle}(t) $ with a shift $ se $\+: \[
      \chi_\eta\textnormal{\textquotesingle}(t) = \left\{ \begin{array}{ll} 0, & \text{if} \quad x \geq
      1 \\ p\textnormal{\textquotesingle}_\eta(x), & \text{if} \quad 1-\eta < x < 1 \\ 0, & \text{if}
      \quad x \leq 1-\eta \end{array} \right.
 \] where $ x = t - \frac{1+se}{2} \eta $ is a shifted coordinate and \[
      p\textnormal{\textquotesingle}_\eta(x) = -\frac{30}{\eta^5} (1-t)^2 (t-1+\eta)^2
 \] is a derivative of the smoothing polynomial. In the case shift $ se=1 $ the derivative $ \chi_\eta\textnormal{\textquotesingle}(t) $ is 0 for $ t \in [0,1] \cup [1+\eta, \infty) $ and varies in $ [1, 1+\eta] $ which is an external shift. In the case shift $ se=-1 $ the derivative $ \chi_\eta\textnormal{\textquotesingle}(t) $ is 0 for $ t \in [0,1-\eta] \cup [1, \infty) $ and varies in $ [1-\eta, 1] $ which is an internal shift. In the case shift $ se=0 $ the derivative $ \chi_\eta\textnormal{\textquotesingle}(t) $ is 0 for $ t \in [0,1-\eta/2] \cup [1+\eta/2, \infty) $ and varies in $ [1-\eta/2, 1+\eta/2] $ which is a centered shift.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em t} & real non-\/negative input value \\
\hline
\mbox{\texttt{ in}}  & {\em se} & shift \\
\hline
\mbox{\texttt{ in}}  & {\em eta} & regularization parameter $ \eta $ \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__constants_8f90_source_l01470}{1470}} of file \mbox{\hyperlink{ddx__constants_8f90_source}{ddx\+\_\+constants.\+f90}}.

\mbox{\Hypertarget{namespaceddx__constants_a5d1fc3f2c16984ceaa0e1ed9de8fb548}\label{namespaceddx__constants_a5d1fc3f2c16984ceaa0e1ed9de8fb548}} 
\index{ddx\_constants@{ddx\_constants}!mkprec@{mkprec}}
\index{mkprec@{mkprec}!ddx\_constants@{ddx\_constants}}
\doxysubsubsection{\texorpdfstring{mkprec()}{mkprec()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+constants\+::mkprec (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{lmax,  }\item[{integer, intent(in)}]{nbasis,  }\item[{integer, intent(in)}]{nsph,  }\item[{integer, intent(in)}]{ngrid,  }\item[{real(dp), intent(in)}]{eps,  }\item[{real(dp), dimension(ngrid, nsph), intent(in)}]{ui,  }\item[{real(dp), dimension(ngrid), intent(in)}]{wgrid,  }\item[{real(dp), dimension(vgrid\+\_\+nbasis, ngrid), intent(in)}]{vgrid,  }\item[{integer, intent(in)}]{vgrid\+\_\+nbasis,  }\item[{real(dp), dimension(nbasis, nbasis, nsph), intent(out)}]{rx\+\_\+prc,  }\item[{integer, intent(out)}]{info,  }\item[{character(len=255), intent(out)}]{error\+\_\+message }\end{DoxyParamCaption})}



Compute preconditioner. 

assemble the diagonal blocks of the reps matrix then invert them to build the preconditioner 

Definition at line \mbox{\hyperlink{ddx__constants_8f90_source_l01497}{1497}} of file \mbox{\hyperlink{ddx__constants_8f90_source}{ddx\+\_\+constants.\+f90}}.

\mbox{\Hypertarget{namespaceddx__constants_a71a53ad578c20da9306b93deda562aeb}\label{namespaceddx__constants_a71a53ad578c20da9306b93deda562aeb}} 
\index{ddx\_constants@{ddx\_constants}!tree\_rib\_build@{tree\_rib\_build}}
\index{tree\_rib\_build@{tree\_rib\_build}!ddx\_constants@{ddx\_constants}}
\doxysubsubsection{\texorpdfstring{tree\_rib\_build()}{tree\_rib\_build()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+constants\+::tree\+\_\+rib\+\_\+build (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{nsph,  }\item[{real(dp), dimension(3, nsph), intent(in)}]{csph,  }\item[{real(dp), dimension(nsph), intent(in)}]{rsph,  }\item[{integer, dimension(nsph), intent(out)}]{order,  }\item[{integer, dimension(2, 2$\ast$nsph-\/1), intent(out)}]{cluster,  }\item[{integer, dimension(2, 2$\ast$nsph-\/1), intent(out)}]{children,  }\item[{integer, dimension(2$\ast$nsph-\/1), intent(out)}]{parent,  }\item[{real(dp), dimension(3, 2$\ast$nsph-\/1), intent(out)}]{cnode,  }\item[{real(dp), dimension(2$\ast$nsph-\/1), intent(out)}]{rnode,  }\item[{integer, dimension(nsph), intent(out)}]{snode }\end{DoxyParamCaption})}



Build a recursive inertial binary tree. 

Uses inertial bisection in a recursive manner until each leaf node has only one input sphere inside. Number of tree nodes is always 2$\ast$nsph-\/1.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nsph} & Number of input spheres \\
\hline
\mbox{\texttt{ in}}  & {\em csph} & Centers of input spheres \\
\hline
\mbox{\texttt{ in}}  & {\em rsph} & Radii of input spheres \\
\hline
\mbox{\texttt{ out}}  & {\em order} & Ordering of input spheres to make spheres of one cluster contiguous. \\
\hline
\mbox{\texttt{ out}}  & {\em cluster} & Indexes in {\ttfamily order} array of the first and the last spheres of each cluster \\
\hline
\mbox{\texttt{ out}}  & {\em children} & Indexes of the first and the last children nodes. If both indexes are equal this means there is only 1 child node and if value of the first child node is 0, there are no children nodes. \\
\hline
\mbox{\texttt{ out}}  & {\em parent} & Parent of each cluster. Value 0 means there is no parent node which corresponds to the root node (with index 1). \\
\hline
\mbox{\texttt{ out}}  & {\em cnode} & Center of a bounding sphere of each node \\
\hline
\mbox{\texttt{ out}}  & {\em rnode} & Radius of a bounding sphere of each node \\
\hline
\mbox{\texttt{ out}}  & {\em snode} & Array of leaf nodes containing input spheres \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__constants_8f90_source_l01593}{1593}} of file \mbox{\hyperlink{ddx__constants_8f90_source}{ddx\+\_\+constants.\+f90}}.

\mbox{\Hypertarget{namespaceddx__constants_a7c5d6aebc32c85aa05d4a74678ff95f7}\label{namespaceddx__constants_a7c5d6aebc32c85aa05d4a74678ff95f7}} 
\index{ddx\_constants@{ddx\_constants}!tree\_rib\_node\_bisect@{tree\_rib\_node\_bisect}}
\index{tree\_rib\_node\_bisect@{tree\_rib\_node\_bisect}!ddx\_constants@{ddx\_constants}}
\doxysubsubsection{\texorpdfstring{tree\_rib\_node\_bisect()}{tree\_rib\_node\_bisect()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+constants\+::tree\+\_\+rib\+\_\+node\+\_\+bisect (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{nsph,  }\item[{real(dp), dimension(3, nsph), intent(in)}]{csph,  }\item[{integer, intent(in)}]{n,  }\item[{integer, dimension(n), intent(inout)}]{order,  }\item[{integer, intent(out)}]{div }\end{DoxyParamCaption})}



Divide given cluster of spheres into two subclusters by inertial bisection. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nsph} & Number of all input spheres \\
\hline
\mbox{\texttt{ in}}  & {\em csph} & Centers of all input spheres \\
\hline
\mbox{\texttt{ in}}  & {\em n} & Number of spheres in a given cluster \\
\hline
\mbox{\texttt{ in,out}}  & {\em order} & Indexes of spheres in a given cluster. On exit, indexes {\ttfamily order(1\+:div)} correspond to the first subcluster and indexes {\ttfamily order(div+1\+:n)} correspond to the second subcluster. \\
\hline
\mbox{\texttt{ out}}  & {\em div} & Break point of {\ttfamily order} array between two clusters. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__constants_8f90_source_l01712}{1712}} of file \mbox{\hyperlink{ddx__constants_8f90_source}{ddx\+\_\+constants.\+f90}}.

\mbox{\Hypertarget{namespaceddx__constants_a3e9f0301398a1007b912f94c7239dffd}\label{namespaceddx__constants_a3e9f0301398a1007b912f94c7239dffd}} 
\index{ddx\_constants@{ddx\_constants}!tree\_get\_farnear\_work@{tree\_get\_farnear\_work}}
\index{tree\_get\_farnear\_work@{tree\_get\_farnear\_work}!ddx\_constants@{ddx\_constants}}
\doxysubsubsection{\texorpdfstring{tree\_get\_farnear\_work()}{tree\_get\_farnear\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+constants\+::tree\+\_\+get\+\_\+farnear\+\_\+work (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{n,  }\item[{integer, dimension(2, n), intent(in)}]{children,  }\item[{real(dp), dimension(3, n), intent(in)}]{cnode,  }\item[{real(dp), dimension(n), intent(in)}]{rnode,  }\item[{integer, intent(in)}]{lwork,  }\item[{integer, intent(inout)}]{iwork,  }\item[{integer, intent(inout)}]{jwork,  }\item[{integer, dimension(3, lwork), intent(inout)}]{work,  }\item[{integer, intent(out)}]{nnfar,  }\item[{integer, dimension(n), intent(out)}]{nfar,  }\item[{integer, intent(out)}]{nnnear,  }\item[{integer, dimension(n), intent(out)}]{nnear }\end{DoxyParamCaption})}



Find near and far admissible pairs of tree nodes and store it in work array. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em n} & number of nodes \\
\hline
\mbox{\texttt{ in}}  & {\em children} & first and last children of each cluster. Value 0 means no children (leaf node). \\
\hline
\mbox{\texttt{ in}}  & {\em cnode} & center of bounding sphere of each cluster (node) of tree \\
\hline
\mbox{\texttt{ in}}  & {\em rnode} & radius of bounding sphere of each cluster (node) of tree \\
\hline
\mbox{\texttt{ in}}  & {\em lwork} & size of work array in dimension 2 \\
\hline
\mbox{\texttt{ in,out}}  & {\em iwork} & index of current pair of nodes that needs to be checked for admissibility. Must be 0 for the first call of this subroutine. If on exit iwork is less or equal to jwork, that means lwork was too small, please reallocate work array and copy all the values into new array and then run procedure again. \\
\hline
\mbox{\texttt{ in,out}}  & {\em jwork} & amount of stored possible admissible pairs of nodes. Please read iwork comments. \\
\hline
\mbox{\texttt{ in,out}}  & {\em work} & all the far and near pairs will be stored here \\
\hline
\mbox{\texttt{ out}}  & {\em nnfar} & total amount of far admissible pairs. valid only if iwork is greater than jwork on exit. \\
\hline
\mbox{\texttt{ out}}  & {\em nfar} & amount of far admissible pairs for each node. valid only if iwork is greater than jwork on exit. \\
\hline
\mbox{\texttt{ out}}  & {\em nnnear} & total amount of near admissible pairs. valid only if iwork is greater than jwork on exit \\
\hline
\mbox{\texttt{ out}}  & {\em nnear} & amount of near admissible pairs for each node. valid only if iwork is greater than jwork on exit \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__constants_8f90_source_l01804}{1804}} of file \mbox{\hyperlink{ddx__constants_8f90_source}{ddx\+\_\+constants.\+f90}}.

\mbox{\Hypertarget{namespaceddx__constants_afa4961d4e2731a6ade2dd395d00a87d9}\label{namespaceddx__constants_afa4961d4e2731a6ade2dd395d00a87d9}} 
\index{ddx\_constants@{ddx\_constants}!tree\_get\_farnear@{tree\_get\_farnear}}
\index{tree\_get\_farnear@{tree\_get\_farnear}!ddx\_constants@{ddx\_constants}}
\doxysubsubsection{\texorpdfstring{tree\_get\_farnear()}{tree\_get\_farnear()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+constants\+::tree\+\_\+get\+\_\+farnear (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{jwork,  }\item[{integer, intent(in)}]{lwork,  }\item[{integer, dimension(3, lwork), intent(in)}]{work,  }\item[{integer, intent(in)}]{n,  }\item[{integer, intent(in)}]{nnfar,  }\item[{integer, dimension(n), intent(in)}]{nfar,  }\item[{integer, dimension(n+1), intent(out)}]{sfar,  }\item[{integer, dimension(nnfar), intent(out)}]{far,  }\item[{integer, intent(in)}]{nnnear,  }\item[{integer, dimension(n), intent(in)}]{nnear,  }\item[{integer, dimension(n+1), intent(out)}]{snear,  }\item[{integer, dimension(nnnear), intent(out)}]{near }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__constants_8f90_source_l01893}{1893}} of file \mbox{\hyperlink{ddx__constants_8f90_source}{ddx\+\_\+constants.\+f90}}.

\mbox{\Hypertarget{namespaceddx__constants_a585af3a4fe1789337b34397ffcb34d45}\label{namespaceddx__constants_a585af3a4fe1789337b34397ffcb34d45}} 
\index{ddx\_constants@{ddx\_constants}!constants\_free@{constants\_free}}
\index{constants\_free@{constants\_free}!ddx\_constants@{ddx\_constants}}
\doxysubsubsection{\texorpdfstring{constants\_free()}{constants\_free()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+constants\+::constants\+\_\+free (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(out)}]{constants,  }\item[{integer, intent(out)}]{info }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__constants_8f90_source_l01947}{1947}} of file \mbox{\hyperlink{ddx__constants_8f90_source}{ddx\+\_\+constants.\+f90}}.

