\hypertarget{ddx__workspace_8f90_source}{}\doxysection{ddx\+\_\+workspace.\+f90}
\label{ddx__workspace_8f90_source}\index{src/ddx\_workspace.f90@{src/ddx\_workspace.f90}}
\mbox{\hyperlink{ddx__workspace_8f90}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00001}00001 }
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00013}00013 }
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00015}\mbox{\hyperlink{namespaceddx__workspace}{00015}} \textcolor{keyword}{module} \mbox{\hyperlink{namespaceddx__workspace}{ddx\_workspace}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00016}00016 \textcolor{comment}{! Get ddx\_params\_type and all compile-\/time definitions}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00017}00017 \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceddx__parameters}{ddx\_parameters}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00018}00018 \textcolor{comment}{! Get ddx\_constants\_type and all run-\/time constants}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00019}00019 \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceddx__constants}{ddx\_constants}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00020}00020 }
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00021}00021 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00022}00022 }
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00023}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{00023}} \textcolor{keyword}{type} \mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\_workspace\_type}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00026}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a7483e839a8de3c6ec72200b8ee0c5a78}{00026}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_pot(:,:)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00029}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_aebf5d2c2ee52f1c2874caf8c3ba0280b}{00029}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_vplm(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00032}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a12f23087d9ada629348489705280a6f7}{00032}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_vylm(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00035}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_afb187d10df7de980e20613424af8e4e8}{00035}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_vdylm(:, :, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00038}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a1bf07d8d5d56894f1702547079f28666}{00038}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_work(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00041}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_ad4499dd67712501a7516547d6ccddb23}{00041}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_vcos(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00044}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a7d59ddbc80da47dcf7a6b1689def6efe}{00044}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_vsin(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00047}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a6f29a7f1304ccd2ecfc96a5d205817d3}{00047}}     \textcolor{keywordtype}{complex(dp)}, \textcolor{keywordtype}{allocatable} :: tmp\_bessel(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00050}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_abad6029009dff4dc0e684574beabc87c}{00050}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_sph(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00054}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a534714d9a6c4bd43f7c49bf5c58f3b41}{00054}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_sph2(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00056}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a46d9193ae89a90283fc7119b68fd64dd}{00056}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_rhs(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00059}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a74e5837320ff51b364b6eebfc838a74f}{00059}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_sph\_grad(:, :, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00062}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_ab91e641fb9aa8760cc452c6f8dee2839}{00062}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_sph\_l(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00065}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a3a3e2dc0bb6ecfbfd6f20b235a3b4033}{00065}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_sph\_l\_grad(:, :, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00068}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_ab23c76a007bf0b80ff21dc2d465a3ab0}{00068}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_sph\_l\_grad2(:, :, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00071}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a63b4ca2b64cf4726749bd8b6e175a5f7}{00071}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_node\_m(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00074}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a0efb558356fe2e2d6cd26cdecfe9a910}{00074}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_node\_l(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00077}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_aba7949a50eb003cd98c57fcf4af49794}{00077}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_grid(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00080}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a1560521fda6e90a3d6a549646c4a8cfc}{00080}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_grid2(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00083}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a8a3f8bbfe55595a37926ba11247fee87}{00083}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_cav(:)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00085}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_aacd68f6c36f5920e47b0fd22f1d958e9}{00085}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_efld(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00087}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_accded5f07baea24b43213d4fb3ee551d}{00087}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_x\_new(:)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00089}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a0a126d032134efd59ce573ff00d2692a}{00089}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_y(:)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00091}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a47699384788dec40b08bbfea4491cb3a}{00091}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_x\_diis(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00093}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a1582a68a60eff8398f2a1d4e610a69e2}{00093}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_e\_diis(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00095}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_af404a9cb66c05e2c538f2a60d5c4b816}{00095}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_bmat(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00097}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a6a7c4fb6d2c4563150f0b1e48e3915b2}{00097}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: tmp\_gmresr(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00099}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_a470cbf62f970d8254fceacba85dd717f}{00099}} \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{allocatable} :: ddcosmo\_guess(:,:), hsp\_guess(:,:)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00101}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_ac92fe40596e92fc39b23a1d1825bf4b3}{00101}}     \textcolor{keywordtype}{integer} :: error\_flag = 2}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00103}\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type_abe103eff7a30b01a2009699804684656}{00103}}     \textcolor{keywordtype}{character(len=255)} :: error\_message}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00104}00104 \textcolor{keyword}{end type }\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\_workspace\_type}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00105}00105 }
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00106}00106 \textcolor{keyword}{contains}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00107}00107 }
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00108}00108 \textcolor{keyword}{subroutine }workspace\_init(params, constants, workspace, info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00109}00109     \textcolor{comment}{!! Inputs}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00110}00110     \textcolor{keywordtype}{type}(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\_params\_type}}), \textcolor{keywordtype}{intent(in)} :: params}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00111}00111     \textcolor{keywordtype}{type}(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\_constants\_type}}), \textcolor{keywordtype}{intent(in)} :: constants}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00112}00112     \textcolor{comment}{!! Outputs}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00113}00113     \textcolor{keywordtype}{type}(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\_workspace\_type}}), \textcolor{keywordtype}{intent(out)} :: workspace}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00114}00114     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(out)} :: info}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00115}00115     \textcolor{comment}{!! Local variables}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00116}00116     \textcolor{keywordtype}{character(len=255)} :: string}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00117}00117     \textcolor{comment}{!! The code}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00118}00118     \textcolor{keyword}{allocate}(workspace \% tmp\_pot(params \% ngrid, params \% nproc), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00119}00119         \& workspace \% tmp\_vplm(constants \% vgrid\_nbasis, params \% nproc), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00120}00120         \& workspace \% tmp\_vcos(constants \% vgrid\_dmax+1, params \% nproc), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00121}00121         \& workspace \% tmp\_vsin(constants \% vgrid\_dmax+1, params \% nproc), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00122}00122         \& workspace \% tmp\_work(constants \% vgrid\_dmax+1, params \% nproc), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00123}00123         \& stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00124}00124     \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00125}00125         workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00126}00126         string = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_vplm`, `tmp\_vcos` and `tmp\_vsin` "{}} \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00127}00127             \& // \textcolor{stringliteral}{"{}allocations failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00128}00128         workspace \% error\_message = string}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00129}00129         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00130}00130         info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00131}00131         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00132}00132 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00133}00133     \textcolor{keyword}{allocate}(workspace \% tmp\_vylm(constants \% vgrid\_nbasis, params \% nproc), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00134}00134         \& workspace \% tmp\_vdylm(3, constants \% vgrid\_nbasis, params \% nproc), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00135}00135         \& stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00136}00136     \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00137}00137         workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00138}00138         workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_vylm` "{}} \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00139}00139             \& // \textcolor{stringliteral}{"{}and `tmp\_vdylm` allocations failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00140}00140         info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00141}00141         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00142}00142 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00143}00143     \textcolor{keyword}{allocate}(workspace \% tmp\_sph(constants \% nbasis, params \% nsph), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00144}00144         \& stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00145}00145     \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00146}00146         workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00147}00147         workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_sph` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00148}00148             \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00149}00149         info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00150}00150         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00151}00151 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00152}00152     \textcolor{keywordflow}{if} (params \% fmm .eq. 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00153}00153         \textcolor{keyword}{allocate}(workspace \% tmp\_sph2(constants \% grad\_nbasis, params \% nsph), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00154}00154             \& stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00155}00155         \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00156}00156             workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00157}00157             workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_sph2` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00158}00158                 \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00159}00159             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00160}00160             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00161}00161 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00162}00162         \textcolor{keyword}{allocate}(workspace \% tmp\_sph\_grad( \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00163}00163             \& constants \% grad\_nbasis, 3, params \% nsph), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00164}00164             \& stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00165}00165         \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00166}00166             workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00167}00167             workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_sph\_grad` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00168}00168                 \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00169}00169             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00170}00170             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00171}00171 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00172}00172         \textcolor{keyword}{allocate}(workspace \% tmp\_sph\_l((params \% pl+1)**2, params \% nsph), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00173}00173             \& stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00174}00174         \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00175}00175             workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00176}00176             workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_sph\_l` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00177}00177                 \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00178}00178             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00179}00179             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00180}00180 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00181}00181         \textcolor{keyword}{allocate}(workspace \% tmp\_sph\_l\_grad( \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00182}00182             \& (params \% pl+1)**2, 3, params \% nsph), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00183}00183             \& stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00184}00184         \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00185}00185             workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00186}00186             workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_sph\_l\_grad` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00187}00187                 \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00188}00188             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00189}00189             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00190}00190 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00191}00191         \textcolor{keyword}{allocate}(workspace \% tmp\_sph\_l\_grad2( \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00192}00192             \& (params \% pl+1)**2, 3, params \% nsph), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00193}00193             \& stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00194}00194         \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00195}00195             workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00196}00196             workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_sph\_l\_grad2` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00197}00197                 \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00198}00198             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00199}00199             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00200}00200 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00201}00201         \textcolor{keyword}{allocate}(workspace \% tmp\_node\_m((params \% pm+1)**2, \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00202}00202             \& constants \% nclusters), stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00203}00203         \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00204}00204             workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00205}00205             workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_node\_m` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00206}00206                 \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00207}00207             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00208}00208             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00209}00209 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00210}00210         \textcolor{keyword}{allocate}(workspace \% tmp\_node\_l((params \% pl+1)**2, \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00211}00211             \& constants \% nclusters), stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00212}00212         \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00213}00213             workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00214}00214             workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_node\_l` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00215}00215                 \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00216}00216             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00217}00217             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00218}00218 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00219}00219 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00220}00220     \textcolor{keyword}{allocate}(workspace \% tmp\_grid(params \% ngrid, params \% nsph), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00221}00221         \& stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00222}00222     \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00223}00223         workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00224}00224         workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_grid` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00225}00225             \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00226}00226         info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00227}00227         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00228}00228 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00229}00229     \textcolor{keyword}{allocate}(workspace \% tmp\_grid2(params \% ngrid, params \% nsph), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00230}00230         \& stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00231}00231     \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00232}00232         workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00233}00233         workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_grid2` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00234}00234             \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00235}00235         info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00236}00236         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00237}00237 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00238}00238     \textcolor{keyword}{allocate}(workspace \% tmp\_cav(constants \% ncav), stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00239}00239     \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00240}00240         workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00241}00241         workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_cav` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00242}00242             \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00243}00243         info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00244}00244         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00245}00245 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00246}00246     \textcolor{keyword}{allocate}(workspace \% tmp\_efld(3, constants \% ncav), stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00247}00247     \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00248}00248         workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00249}00249         workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_efld` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00250}00250             \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00251}00251         info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00252}00252         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00253}00253 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00254}00254     \textcolor{keyword}{allocate}(workspace \% tmp\_x\_new(constants \% n), stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00255}00255     \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00256}00256         workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00257}00257         workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_x\_new` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00258}00258             \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00259}00259         info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00260}00260         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00261}00261 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00262}00262     \textcolor{keyword}{allocate}(workspace \% tmp\_y(constants \% n), stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00263}00263     \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00264}00264         workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00265}00265         workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_y` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00266}00266             \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00267}00267         info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00268}00268         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00269}00269 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00270}00270     \textcolor{keyword}{allocate}(workspace \% tmp\_x\_diis(constants \% n, 2*params \% jacobi\_ndiis), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00271}00271         \& stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00272}00272     \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00273}00273         workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00274}00274         workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_x\_diis` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00275}00275             \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00276}00276         info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00277}00277         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00278}00278 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00279}00279     \textcolor{keyword}{allocate}(workspace \% tmp\_e\_diis(constants \% n, 2*params \% jacobi\_ndiis), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00280}00280         \& stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00281}00281     \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00282}00282         workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00283}00283         workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_e\_diis` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00284}00284             \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00285}00285         info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00286}00286         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00287}00287 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00288}00288     \textcolor{keyword}{allocate}(workspace \% tmp\_bmat(2*params \% jacobi\_ndiis + 2, \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00289}00289         \& 2*params \% jacobi\_ndiis + 2), stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00290}00290     \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00291}00291         workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00292}00292         workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_bmat` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00293}00293             \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00294}00294         info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00295}00295         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00296}00296 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00297}00297     \textcolor{comment}{! In case of GMRESR iterative solver allocate corresponding temporary space}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00298}00298     \textcolor{keywordflow}{if} ((params \% itersolver .eq. 2) .or. (params \% model .eq. 3)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00299}00299         \textcolor{keyword}{allocate}(workspace \% tmp\_gmresr(constants \% n, \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00300}00300             \& 0:2*params \% gmresr\_j + params \% gmresr\_dim + 1), stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00301}00301         \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00302}00302             workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00303}00303             workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_gmresr` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00304}00304                 \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00305}00305             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00306}00306             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00307}00307 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00308}00308 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00309}00309     \textcolor{comment}{! Allocations for LPB model}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00310}00310     \textcolor{keywordflow}{if} (params \% model .eq. 3) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00311}00311         \textcolor{keyword}{allocate}(workspace \% tmp\_bessel(max(2, params \% lmax+1), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00312}00312             \& params \% nproc), workspace \% ddcosmo\_guess(constants \% nbasis, params \% nsph), \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00313}00313             \& workspace \% hsp\_guess(constants \% nbasis, params \% nsph), stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00314}00314         \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00315}00315             workspace \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00316}00316             workspace \% error\_message = \textcolor{stringliteral}{"{}workspace\_init: `tmp\_bessel` "{}} // \&}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00317}00317                 \& \textcolor{stringliteral}{"{}allocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00318}00318             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00319}00319             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00320}00320 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00321}00321 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00322}00322     \textcolor{comment}{! Clear error state}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00323}00323     info = 0}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00324}00324     workspace \% error\_flag = 0}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00325}00325     workspace \% error\_message = \textcolor{stringliteral}{"{}"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00326}00326 \textcolor{keyword}{end subroutine }workspace\_init}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00327}00327 }
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00328}00328 \textcolor{keyword}{subroutine }workspace\_free(workspace, info)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00329}00329     \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00330}00330     \textcolor{keywordtype}{type}(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\_workspace\_type}}), \textcolor{keywordtype}{intent(out)} :: workspace}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00331}00331     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(out)} :: info}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00332}00332     \textcolor{keywordtype}{integer} :: istat}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00333}00333 }
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00334}00334     istat = 0}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00335}00335     info = 0}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00336}00336 }
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00337}00337     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_pot)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00338}00338         \textcolor{keyword}{deallocate}(workspace \% tmp\_pot, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00339}00339         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00340}00340             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00341}00341             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_pot` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00342}00342             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00343}00343 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00344}00344 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00345}00345     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_vplm)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00346}00346         \textcolor{keyword}{deallocate}(workspace \% tmp\_vplm, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00347}00347         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00348}00348             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00349}00349             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_vplm` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00350}00350             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00351}00351 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00352}00352 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00353}00353     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_vcos)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00354}00354         \textcolor{keyword}{deallocate}(workspace \% tmp\_vcos, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00355}00355         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00356}00356             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00357}00357             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_vcos` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00358}00358             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00359}00359 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00360}00360 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00361}00361     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_vsin)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00362}00362         \textcolor{keyword}{deallocate}(workspace \% tmp\_vsin, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00363}00363         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00364}00364             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00365}00365             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_vsin` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00366}00366             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00367}00367 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00368}00368 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00369}00369     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_work)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00370}00370         \textcolor{keyword}{deallocate}(workspace \% tmp\_work, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00371}00371         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00372}00372             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00373}00373             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_work` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00374}00374             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00375}00375 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00376}00376 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00377}00377     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_vylm)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00378}00378         \textcolor{keyword}{deallocate}(workspace \% tmp\_vylm, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00379}00379         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00380}00380             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00381}00381             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_vylm` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00382}00382             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00383}00383 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00384}00384 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00385}00385     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_vdylm)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00386}00386         \textcolor{keyword}{deallocate}(workspace \% tmp\_vdylm, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00387}00387         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00388}00388             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00389}00389             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_vdylm` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00390}00390             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00391}00391 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00392}00392 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00393}00393     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_sph)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00394}00394         \textcolor{keyword}{deallocate}(workspace \% tmp\_sph, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00395}00395         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00396}00396             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00397}00397             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_sph` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00398}00398             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00399}00399 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00400}00400 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00401}00401     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_sph2)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00402}00402         \textcolor{keyword}{deallocate}(workspace \% tmp\_sph2, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00403}00403         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00404}00404             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00405}00405             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_sph2` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00406}00406             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00407}00407 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00408}00408 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00409}00409     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_sph\_grad)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00410}00410         \textcolor{keyword}{deallocate}(workspace \% tmp\_sph\_grad, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00411}00411         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00412}00412             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00413}00413             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_sph\_grad` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00414}00414             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00415}00415 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00416}00416 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00417}00417     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_sph\_l)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00418}00418         \textcolor{keyword}{deallocate}(workspace \% tmp\_sph\_l, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00419}00419         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00420}00420             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00421}00421             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_sph\_l` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00422}00422             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00423}00423 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00424}00424 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00425}00425     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_sph\_l\_grad)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00426}00426         \textcolor{keyword}{deallocate}(workspace \% tmp\_sph\_l\_grad, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00427}00427         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00428}00428             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00429}00429             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_sph\_l\_grad` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00430}00430             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00431}00431 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00432}00432 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00433}00433     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_sph\_l\_grad2)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00434}00434         \textcolor{keyword}{deallocate}(workspace \% tmp\_sph\_l\_grad2, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00435}00435         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00436}00436             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00437}00437             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_sph\_l\_grad2` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00438}00438             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00439}00439 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00440}00440 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00441}00441     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_node\_m)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00442}00442         \textcolor{keyword}{deallocate}(workspace \% tmp\_node\_m, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00443}00443         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00444}00444             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00445}00445             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_node\_m` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00446}00446             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00447}00447 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00448}00448 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00449}00449     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_node\_l)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00450}00450         \textcolor{keyword}{deallocate}(workspace \% tmp\_node\_l, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00451}00451         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00452}00452             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00453}00453             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_node\_l` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00454}00454             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00455}00455 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00456}00456 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00457}00457     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_grid)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00458}00458         \textcolor{keyword}{deallocate}(workspace \% tmp\_grid, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00459}00459         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00460}00460             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00461}00461             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_grid` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00462}00462             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00463}00463 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00464}00464 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00465}00465     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_grid2)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00466}00466         \textcolor{keyword}{deallocate}(workspace \% tmp\_grid2, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00467}00467         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00468}00468             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00469}00469             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_grid2` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00470}00470             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00471}00471 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00472}00472 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00473}00473     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_cav)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00474}00474         \textcolor{keyword}{deallocate}(workspace \% tmp\_cav, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00475}00475         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00476}00476             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00477}00477             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_cav` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00478}00478             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00479}00479 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00480}00480 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00481}00481     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_efld)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00482}00482         \textcolor{keyword}{deallocate}(workspace \% tmp\_efld, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00483}00483         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00484}00484             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00485}00485             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_efld` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00486}00486             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00487}00487 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00488}00488 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00489}00489     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_x\_new)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00490}00490         \textcolor{keyword}{deallocate}(workspace \% tmp\_x\_new, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00491}00491         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00492}00492             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00493}00493             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_x\_new` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00494}00494             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00495}00495 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00496}00496 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00497}00497     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_y)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00498}00498         \textcolor{keyword}{deallocate}(workspace \% tmp\_y, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00499}00499         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00500}00500             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00501}00501             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_y` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00502}00502             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00503}00503 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00504}00504 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00505}00505     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_x\_diis)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00506}00506         \textcolor{keyword}{deallocate}(workspace \% tmp\_x\_diis, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00507}00507         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00508}00508             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00509}00509             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_x\_diis` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00510}00510             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00511}00511 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00512}00512 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00513}00513     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_e\_diis)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00514}00514         \textcolor{keyword}{deallocate}(workspace \% tmp\_e\_diis, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00515}00515         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00516}00516             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00517}00517             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_e\_diis` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00518}00518             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00519}00519 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00520}00520 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00521}00521     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_bmat)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00522}00522         \textcolor{keyword}{deallocate}(workspace \% tmp\_bmat, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00523}00523         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00524}00524             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00525}00525             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_bmat` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00526}00526             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00527}00527 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00528}00528 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00529}00529     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_gmresr)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00530}00530         \textcolor{keyword}{deallocate}(workspace \% tmp\_gmresr, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00531}00531         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00532}00532             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00533}00533             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_gmresr` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00534}00534             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00535}00535 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00536}00536 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00537}00537     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_bessel)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00538}00538         \textcolor{keyword}{deallocate}(workspace \% tmp\_bessel, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00539}00539         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00540}00540             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00541}00541             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_bessel` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00542}00542             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00543}00543 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00544}00544 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00545}00545     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% ddcosmo\_guess)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00546}00546         \textcolor{keyword}{deallocate}(workspace \% ddcosmo\_guess, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00547}00547         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00548}00548             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00549}00549             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`ddcosmo\_guess` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00550}00550             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00551}00551 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00552}00552 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00553}00553     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% hsp\_guess)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00554}00554         \textcolor{keyword}{deallocate}(workspace \% hsp\_guess, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00555}00555         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00556}00556             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00557}00557             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`hsp\_guess` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00558}00558             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00559}00559 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00560}00560 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00561}00561     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(workspace \% tmp\_rhs)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00562}00562         \textcolor{keyword}{deallocate}(workspace \% tmp\_rhs, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00563}00563         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00564}00564             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00565}00565             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`tmp\_rhs` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00566}00566             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00567}00567 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00568}00568 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00569}00569 \textcolor{keyword}{end subroutine }workspace\_free}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00570}00570 }
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00571}00571 \textcolor{keyword}{end module}}
\DoxyCodeLine{\Hypertarget{ddx__workspace_8f90_source_l00572}00572 }

\end{DoxyCode}
