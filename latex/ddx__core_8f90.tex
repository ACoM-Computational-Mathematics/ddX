\hypertarget{ddx__core_8f90}{}\doxysection{src/ddx\+\_\+core.f90 File Reference}
\label{ddx__core_8f90}\index{src/ddx\_core.f90@{src/ddx\_core.f90}}
\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structddx__core_1_1ddx__state__type}{ddx\+\_\+core\+::ddx\+\_\+state\+\_\+type}}
\item 
type \mbox{\hyperlink{structddx__core_1_1ddx__type}{ddx\+\_\+core\+::ddx\+\_\+type}}
\begin{DoxyCompactList}\small\item\em Main ddX type that stores all required information. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Modules}
\begin{DoxyCompactItemize}
\item 
module \mbox{\hyperlink{namespaceddx__core}{ddx\+\_\+core}}
\begin{DoxyCompactList}\small\item\em Core routines and parameters of the ddX software. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespaceddx__core_ad98e6ca9db2543caa5273d4d33bb0e10}{ddx\+\_\+core\+::ddinit}} (nsph, charge, x, y, z, rvdw, model, lmax, ngrid, force, fmm, pm, pl, se, eta, eps, kappa, matvecmem, itersolver, maxiter, jacobi\+\_\+ndiis, gmresr\+\_\+j, gmresr\+\_\+dim, nproc, ddx\+\_\+data, info)
\begin{DoxyCompactList}\small\item\em Initialize ddX input with a full set of parameters. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_ab34ec195fbaa7838303efa0b7e0f0453}{ddx\+\_\+core\+::ddx\+\_\+init\+\_\+state}} (params, constants, state)
\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a7a2ec4809155b56be2c61ccb72b974ea}{ddx\+\_\+core\+::ddfromfile}} (fname, ddx\+\_\+data, tol, iprint, info)
\begin{DoxyCompactList}\small\item\em Read configuration from a file. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a3258ae6ef23a4f07ea8a14ccf612acaa}{ddx\+\_\+core\+::ddfree}} (ddx\+\_\+data)
\begin{DoxyCompactList}\small\item\em Deallocate object with corresponding data. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a5614410792c4a18a359eae6fd226cc8e}{ddx\+\_\+core\+::ddx\+\_\+free\+\_\+state}} (state)
\item 
subroutine \mbox{\hyperlink{namespaceddx__core_aa76b7e526f53c93bf1492f51b3e1a8cc}{ddx\+\_\+core\+::print\+\_\+spherical}} (label, nbasis, lmax, ncol, icol, x)
\begin{DoxyCompactList}\small\item\em Print array of spherical harmonics. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a7116b451c0d1427361e7d1437a1c5ae8}{ddx\+\_\+core\+::print\+\_\+nodes}} (label, ngrid, ncol, icol, x)
\begin{DoxyCompactList}\small\item\em Print array of quadrature points. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a7ee983451a2d6b52ce89801a59fb33e6}{ddx\+\_\+core\+::print\+\_\+ddvector}} (ddx\+\_\+data, label, vector)
\begin{DoxyCompactList}\small\item\em Print dd Solution vector. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a7c6ed3167dcc5edcd4efa59719858b72}{ddx\+\_\+core\+::ddintegrate}} (nsph, nbasis, ngrid, vwgrid, ldvwgrid, x\+\_\+grid, x\+\_\+lm)
\begin{DoxyCompactList}\small\item\em Integrate against spherical harmonics. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_af4a63e9274aa8031ba29947ec4840da1}{ddx\+\_\+core\+::dbasis}} (params, constants, x, basloc, dbsloc, vplm, vcos, vsin)
\begin{DoxyCompactList}\small\item\em Compute first derivatives of spherical harmonics. \end{DoxyCompactList}\item 
real(dp) function \mbox{\hyperlink{namespaceddx__core_af57c0e1c6dd13f71fee44d975a1080cd}{ddx\+\_\+core\+::intmlp}} (params, constants, t, sigma, basloc)
\begin{DoxyCompactList}\small\item\em TODO. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a202929912f5b0db1b6fd9f6c8809074c}{ddx\+\_\+core\+::wghpot}} (ncav, phi\+\_\+cav, nsph, ngrid, ui, phi\+\_\+grid, g)
\begin{DoxyCompactList}\small\item\em Weigh potential at cavity points by characteristic function TODO use cavity points in CSR format. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_aa459fca8ccf1b5380372e23d03d72fcf}{ddx\+\_\+core\+::hsnorm}} (lmax, nbasis, u, unorm)
\begin{DoxyCompactList}\small\item\em Compute the local Sobolev H$^\wedge$(-\/1/2)-\/norm on one sphere of u. \end{DoxyCompactList}\item 
real(dp) function \mbox{\hyperlink{namespaceddx__core_a2b3e39f4eaa589b097d4e9f37673e8f1}{ddx\+\_\+core\+::hnorm}} (lmax, nbasis, nsph, x)
\begin{DoxyCompactList}\small\item\em Compute the global Sobolev H$^\wedge$(-\/1/2)-\/norm of x. \end{DoxyCompactList}\item 
real(dp) function \mbox{\hyperlink{namespaceddx__core_af6525c3026ed48bc2e9711d7f5f993a1}{ddx\+\_\+core\+::rmsnorm}} (lmax, nbasis, nsph, x)
\begin{DoxyCompactList}\small\item\em TODO. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a4dcabcd0c6fe4d601c5a739d8d1bf86c}{ddx\+\_\+core\+::rmsvec}} (n, v, vrms, vmax)
\begin{DoxyCompactList}\small\item\em compute root-\/mean-\/square and max norm \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a506cc06b7ccdef7dae3c83c324ca2923}{ddx\+\_\+core\+::adjrhs}} (params, constants, isph, xi, vlm, work)
\begin{DoxyCompactList}\small\item\em TODO. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a96984a0f96c1a17e25c781d34ed73f80}{ddx\+\_\+core\+::calcv}} (params, constants, isph, pot, sigma, work)
\begin{DoxyCompactList}\small\item\em TODO. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_ad5b07f0450b5b0fae876973a3ce661d7}{ddx\+\_\+core\+::ddeval\+\_\+grid}} (params, constants, alpha, x\+\_\+sph, beta, x\+\_\+grid, info)
\begin{DoxyCompactList}\small\item\em Evaluate values of spherical harmonics at Lebedev grid points. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a52eaee7c9a67f2a9f317c2d6dd50426e}{ddx\+\_\+core\+::ddeval\+\_\+grid\+\_\+work}} (nbasis, ngrid, nsph, vgrid, ldvgrid, alpha, x\+\_\+sph, beta, x\+\_\+grid)
\begin{DoxyCompactList}\small\item\em Evaluate values of spherical harmonics at Lebedev grid points. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_ae804f0dbf4b9800bc75adaa57c842149}{ddx\+\_\+core\+::ddintegrate\+\_\+sph}} (params, constants, alpha, x\+\_\+grid, beta, x\+\_\+sph, info)
\begin{DoxyCompactList}\small\item\em Integrate values at grid points into spherical harmonics. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a61156a8a0aec479ea2071dd6d6922fb1}{ddx\+\_\+core\+::ddintegrate\+\_\+sph\+\_\+work}} (nbasis, ngrid, nsph, vwgrid, ldvwgrid, alpha, x\+\_\+grid, beta, x\+\_\+sph)
\begin{DoxyCompactList}\small\item\em Integrate values at grid points into spherical harmonics. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a8abb13e98d5d1eb3512e5ad55b701ef3}{ddx\+\_\+core\+::ddcav\+\_\+to\+\_\+grid}} (params, constants, x\+\_\+cav, x\+\_\+grid, info)
\begin{DoxyCompactList}\small\item\em Unwrap values at cavity points into values at all grid points. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_accaee74767f44a369c6d2d1e106c0453}{ddx\+\_\+core\+::ddcav\+\_\+to\+\_\+grid\+\_\+work}} (ngrid, nsph, ncav, icav\+\_\+ia, icav\+\_\+ja, x\+\_\+cav, x\+\_\+grid)
\begin{DoxyCompactList}\small\item\em Unwrap values at cavity points into values at all grid points. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_ac11b27bb31b5df45e810537fcb887b85}{ddx\+\_\+core\+::ddproject\+\_\+cav}} (params, constants, s, xi)
\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a1caf6da4500220161384b51938ada1f8}{ddx\+\_\+core\+::tree\+\_\+m2m\+\_\+rotation}} (params, constants, node\+\_\+m)
\begin{DoxyCompactList}\small\item\em Transfer multipole coefficients over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a824b2d46bc4f19b41d1e59efc101fe97}{ddx\+\_\+core\+::tree\+\_\+m2m\+\_\+rotation\+\_\+work}} (params, constants, node\+\_\+m, work)
\begin{DoxyCompactList}\small\item\em Transfer multipole coefficients over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_ad0d3d3c1ab770177d8e62b74b7b70a7f}{ddx\+\_\+core\+::tree\+\_\+m2m\+\_\+bessel\+\_\+rotation}} (params, constants, node\+\_\+m)
\begin{DoxyCompactList}\small\item\em Transfer multipole coefficients over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a50051b223e25bba2f92fc30c8e4e9c14}{ddx\+\_\+core\+::tree\+\_\+m2m\+\_\+bessel\+\_\+rotation\+\_\+work}} (params, constants, node\+\_\+m)
\begin{DoxyCompactList}\small\item\em Transfer multipole coefficients over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_ab680c1da4d087c3064e9fcbe4c439698}{ddx\+\_\+core\+::tree\+\_\+m2m\+\_\+rotation\+\_\+adj}} (params, constants, node\+\_\+m)
\begin{DoxyCompactList}\small\item\em Adjoint transfer multipole coefficients over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_af0f8bc57cc0a607a5f7b9d123b91e85a}{ddx\+\_\+core\+::tree\+\_\+m2m\+\_\+rotation\+\_\+adj\+\_\+work}} (params, constants, node\+\_\+m, work)
\begin{DoxyCompactList}\small\item\em Adjoint transfer multipole coefficients over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a4b801c0c80a755fcdedd743c93e63d13}{ddx\+\_\+core\+::tree\+\_\+m2m\+\_\+bessel\+\_\+rotation\+\_\+adj}} (params, constants, node\+\_\+m)
\begin{DoxyCompactList}\small\item\em Adjoint transfer multipole coefficients over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_ad57a2d9013d87acb421f0747b95f4e75}{ddx\+\_\+core\+::tree\+\_\+m2m\+\_\+bessel\+\_\+rotation\+\_\+adj\+\_\+work}} (params, constants, node\+\_\+m)
\begin{DoxyCompactList}\small\item\em Adjoint transfer multipole coefficients over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a144b53f7df72de5a2717b78c6b903160}{ddx\+\_\+core\+::tree\+\_\+l2l\+\_\+rotation}} (params, constants, node\+\_\+l)
\begin{DoxyCompactList}\small\item\em Transfer local coefficients over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a343cdc81dac01fcc275b329aaff6584d}{ddx\+\_\+core\+::tree\+\_\+l2l\+\_\+rotation\+\_\+work}} (params, constants, node\+\_\+l, work)
\begin{DoxyCompactList}\small\item\em Transfer local coefficients over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a7d65f9c7b0f00ffce03baa68fbe3cb99}{ddx\+\_\+core\+::tree\+\_\+l2l\+\_\+bessel\+\_\+rotation}} (params, constants, node\+\_\+l)
\begin{DoxyCompactList}\small\item\em Transfer local coefficients over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a7f57681126ffa1ad063103f39db026c3}{ddx\+\_\+core\+::tree\+\_\+l2l\+\_\+bessel\+\_\+rotation\+\_\+work}} (params, constants, node\+\_\+l)
\begin{DoxyCompactList}\small\item\em Transfer local coefficients over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_ab1e1fe0e572c015d8f51b716e6ec8fc4}{ddx\+\_\+core\+::tree\+\_\+l2l\+\_\+rotation\+\_\+adj}} (params, constants, node\+\_\+l)
\begin{DoxyCompactList}\small\item\em Adjoint transfer local coefficients over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a02e2c9f1fe4c143bba50d01f1b4d338f}{ddx\+\_\+core\+::tree\+\_\+l2l\+\_\+rotation\+\_\+adj\+\_\+work}} (params, constants, node\+\_\+l, work)
\begin{DoxyCompactList}\small\item\em Adjoint transfer local coefficients over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a6b92d30960fb1be121d7ab92d14365e9}{ddx\+\_\+core\+::tree\+\_\+l2l\+\_\+bessel\+\_\+rotation\+\_\+adj}} (params, constants, node\+\_\+l)
\begin{DoxyCompactList}\small\item\em Adjoint transfer local coefficients over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a559f8f129ce2d481446c4325526aa277}{ddx\+\_\+core\+::tree\+\_\+m2l\+\_\+rotation}} (params, constants, node\+\_\+m, node\+\_\+l)
\begin{DoxyCompactList}\small\item\em Transfer multipole local coefficients into local over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a3d18e8fd9f3dbc808deefd71af3c6892}{ddx\+\_\+core\+::tree\+\_\+m2l\+\_\+bessel\+\_\+rotation}} (params, constants, node\+\_\+m, node\+\_\+l)
\begin{DoxyCompactList}\small\item\em Transfer multipole local coefficients into local over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a8190329d0b54f19cfd0323e20740cd1a}{ddx\+\_\+core\+::tree\+\_\+m2l\+\_\+bessel\+\_\+rotation\+\_\+adj}} (params, constants, node\+\_\+l, node\+\_\+m)
\begin{DoxyCompactList}\small\item\em Adjoint transfer multipole local coefficients into local over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_aa709ef144e4384d61d0ae50bfe7354dd}{ddx\+\_\+core\+::tree\+\_\+m2l\+\_\+bessel\+\_\+rotation\+\_\+adj\+\_\+work}} (params, constants, node\+\_\+l, node\+\_\+m)
\begin{DoxyCompactList}\small\item\em Adjoint transfer multipole local coefficients into local over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_aa9e82e22265265ab215bb831a2dbdf1a}{ddx\+\_\+core\+::tree\+\_\+m2l\+\_\+rotation\+\_\+adj}} (params, constants, node\+\_\+l, node\+\_\+m)
\begin{DoxyCompactList}\small\item\em Adjoint transfer multipole local coefficients into local over a tree. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a1d81120958f62351b12a9036ab6cbf6e}{ddx\+\_\+core\+::tree\+\_\+l2p}} (params, constants, alpha, node\+\_\+l, beta, grid\+\_\+v, sph\+\_\+l)
\begin{DoxyCompactList}\small\item\em TODO. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a0d41a631eb1ddf7d6c96b28919385514}{ddx\+\_\+core\+::tree\+\_\+l2p\+\_\+bessel}} (params, constants, alpha, node\+\_\+l, beta, grid\+\_\+v)
\begin{DoxyCompactList}\small\item\em TODO. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a2ee14de3640c3649fe523dfb4d083bc9}{ddx\+\_\+core\+::tree\+\_\+l2p\+\_\+adj}} (params, constants, alpha, grid\+\_\+v, beta, node\+\_\+l, sph\+\_\+l)
\begin{DoxyCompactList}\small\item\em TODO. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a1111c683b53bd2eb55ea0d130980bcd9}{ddx\+\_\+core\+::tree\+\_\+l2p\+\_\+bessel\+\_\+adj}} (params, constants, alpha, grid\+\_\+v, beta, node\+\_\+l)
\begin{DoxyCompactList}\small\item\em TODO. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a60a40706c306b954af9fccb186c305e0}{ddx\+\_\+core\+::tree\+\_\+m2p}} (params, constants, p, alpha, sph\+\_\+m, beta, grid\+\_\+v)
\begin{DoxyCompactList}\small\item\em TODO. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a62112cc7d3d77609e0e992504d8be125}{ddx\+\_\+core\+::tree\+\_\+m2p\+\_\+bessel}} (params, constants, p, alpha, sph\+\_\+p, sph\+\_\+m, beta, grid\+\_\+v)
\begin{DoxyCompactList}\small\item\em TODO. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a8866ff0507514c1a83f3348e2cc55401}{ddx\+\_\+core\+::tree\+\_\+m2p\+\_\+adj}} (params, constants, p, alpha, grid\+\_\+v, beta, sph\+\_\+m)
\begin{DoxyCompactList}\small\item\em TODO. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_aa34ea25c06052ba20613b35da813f54e}{ddx\+\_\+core\+::tree\+\_\+m2p\+\_\+bessel\+\_\+adj}} (params, constants, p, alpha, grid\+\_\+v, beta, sph\+\_\+p, sph\+\_\+m)
\begin{DoxyCompactList}\small\item\em TODO. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a7f61e8dc65fa676434374f7ea9a07743}{ddx\+\_\+core\+::tree\+\_\+m2p\+\_\+bessel\+\_\+nodiag\+\_\+adj}} (params, constants, p, alpha, grid\+\_\+v, beta, sph\+\_\+p, sph\+\_\+m)
\begin{DoxyCompactList}\small\item\em TODO. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a3c8789fc01ba244fdaa0d4fef8e9d725}{ddx\+\_\+core\+::efld}} (ncav, zeta, ccav, nsph, csph, force)
\begin{DoxyCompactList}\small\item\em TODO. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a86f701c3486a5b26c650d5b157b6e213}{ddx\+\_\+core\+::tree\+\_\+grad\+\_\+m2m}} (params, constants, sph\+\_\+m, sph\+\_\+m\+\_\+grad, work)
\begin{DoxyCompactList}\small\item\em TODO. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a0bbe738fff5a4d15f744dfa0b26938cf}{ddx\+\_\+core\+::tree\+\_\+grad\+\_\+l2l}} (params, constants, node\+\_\+l, sph\+\_\+l\+\_\+grad, work)
\begin{DoxyCompactList}\small\item\em TODO. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__core_a1c6e9bf18af65b25aa115da10bb2e749}{ddx\+\_\+core\+::print\+\_\+header}} (iprint, params)
\begin{DoxyCompactList}\small\item\em small routine to print a tidy header with various info on the calculation. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyCopyright}{Copyright}
(c) 2020-\/2021 RWTH Aachen. All rights reserved.
\end{DoxyCopyright}
ddX software

Core routines and parameters of the entire ddX software

\begin{DoxyVersion}{Version}
1.\+0.\+0 
\end{DoxyVersion}
\begin{DoxyAuthor}{Author}
Aleksandr Mikhalev 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2021-\/02-\/25 
\end{DoxyDate}


Definition in file \mbox{\hyperlink{ddx__core_8f90_source}{ddx\+\_\+core.\+f90}}.

