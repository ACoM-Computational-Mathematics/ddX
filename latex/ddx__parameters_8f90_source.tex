\hypertarget{ddx__parameters_8f90_source}{}\doxysection{ddx\+\_\+parameters.\+f90}
\label{ddx__parameters_8f90_source}\index{src/ddx\_parameters.f90@{src/ddx\_parameters.f90}}
\mbox{\hyperlink{ddx__parameters_8f90}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00001}00001 }
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00013}00013 }
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00015}\mbox{\hyperlink{namespaceddx__parameters}{00015}} \textcolor{keyword}{module} \mbox{\hyperlink{namespaceddx__parameters}{ddx\_parameters}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00016}00016 \textcolor{comment}{! Include compile-\/time definitions}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00017}00017 \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceddx__definitions}{ddx\_definitions}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00018}00018 \textcolor{comment}{! Enable OpenMP }}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00019}00019 \textcolor{keywordtype}{use }omp\_lib}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00020}00020 }
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00021}00021 \textcolor{comment}{! Disable implicit types}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00022}00022 \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00023}00023 }
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00024}00024 \textcolor{comment}{! Interface for the printing function}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00025}00025 \textcolor{keyword}{interface}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00026}\mbox{\hyperlink{interfaceddx__parameters_1_1print__func__interface}{00026}}     \textcolor{keyword}{subroutine }\mbox{\hyperlink{interfaceddx__parameters_1_1print__func__interface}{print\_func\_interface}}(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00027}00027         \textcolor{keywordtype}{character(len=255)}, \textcolor{keywordtype}{intent(in)} :: string}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00028}00028     \textcolor{keyword}{end subroutine}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00029}00029 \textcolor{keyword}{end interface}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00030}00030 }
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00032}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{00032}} \textcolor{keyword}{type} \mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\_params\_type}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00034}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a1c894bf3f401534f58322ee913f205f4}{00034}}     \textcolor{keywordtype}{integer} :: model}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00036}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a75c5b5e4ae578211113bdc7c7c0bde10}{00036}}     \textcolor{keywordtype}{integer} :: force}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00038}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_ac4ba0a49d9b5f61ec46e93272748cb17}{00038}} \textcolor{keywordtype}{    real}(\mbox{\hyperlink{namespaceddx__definitions_a6e62179e6ac303908858a873e4db49c2}{dp}}) :: eps}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00040}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a32dadee391df6c4b3d4e2b433b5c8b59}{00040}} \textcolor{keywordtype}{    real}(\mbox{\hyperlink{namespaceddx__definitions_a6e62179e6ac303908858a873e4db49c2}{dp}}) :: kappa}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00042}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_adafa9467289900fd0bb501da75e53642}{00042}} \textcolor{keywordtype}{    real}(\mbox{\hyperlink{namespaceddx__definitions_a6e62179e6ac303908858a873e4db49c2}{dp}}) :: eta}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00045}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a3d1b4ea5f5d59a994f9cdb1047f58dfb}{00045}} \textcolor{keywordtype}{    real}(\mbox{\hyperlink{namespaceddx__definitions_a6e62179e6ac303908858a873e4db49c2}{dp}}) :: se}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00047}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a8e2ce496c887282074254c263edd2bf1}{00047}}     \textcolor{keywordtype}{integer} :: lmax}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00049}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a162bbb6f6255777ec97ca6bc00b3b0a0}{00049}}     \textcolor{keywordtype}{integer} :: ngrid}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00053}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a4be7dd4db40f62137b3c79c875ed0582}{00053}}     \textcolor{keywordtype}{integer} :: itersolver}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00055}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a144db6ae7b0003dc11d822b59df51fbf}{00055}}     \textcolor{keywordtype}{integer} :: maxiter}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00058}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_ab5e2812004c30ce302f6c0cb4d9c6426}{00058}}     \textcolor{keywordtype}{integer} :: jacobi\_ndiis}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00061}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_afd7788e66709265e61de3f659fafdb24}{00061}}     \textcolor{keywordtype}{integer} :: gmresr\_j}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00065}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a1e55d2c520260179672519557151ffff}{00065}}     \textcolor{keywordtype}{integer} :: gmresr\_dim}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00067}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_ae371e5372cfe4451853cbca04e83813d}{00067}}     \textcolor{keywordtype}{integer} :: fmm}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00071}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a3345be5ea974b5e302e9cc3d83ce1940}{00071}}     \textcolor{keywordtype}{integer} :: pm}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00075}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a397e9091585fe27187a2cbc72a63e737}{00075}}     \textcolor{keywordtype}{integer} :: pl}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00078}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a43c24fc6c797bdb7c3bffbf3df3ba4e2}{00078}}     \textcolor{keywordtype}{integer} :: nproc}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00080}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a1e00f52a76433b2c0962cec9a1be9e3c}{00080}}     \textcolor{keywordtype}{integer} :: nsph}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00082}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a1a68508c403efd05374f725709d73caa}{00082}} \textcolor{keywordtype}{    real}(\mbox{\hyperlink{namespaceddx__definitions_a6e62179e6ac303908858a873e4db49c2}{dp}}), \textcolor{keywordtype}{allocatable} :: charge(:)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00084}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_ae8f332ff28e787d8bc0b30cd5f36bbb4}{00084}} \textcolor{keywordtype}{    real}(\mbox{\hyperlink{namespaceddx__definitions_a6e62179e6ac303908858a873e4db49c2}{dp}}), \textcolor{keywordtype}{allocatable} :: csph(:, :)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00086}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_abe71e052d5d12291443925042789b288}{00086}} \textcolor{keywordtype}{    real}(\mbox{\hyperlink{namespaceddx__definitions_a6e62179e6ac303908858a873e4db49c2}{dp}}), \textcolor{keywordtype}{allocatable} :: rsph(:)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00088}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a9372351d69cecd8013f7bf9f93590fef}{00088}} \textcolor{keywordtype}{    real}(\mbox{\hyperlink{namespaceddx__definitions_a6e62179e6ac303908858a873e4db49c2}{dp}}) :: epsp = 1.0\_dp}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00091}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a8f06c900e28484ed13ae3451e8649dfa}{00091}}     \textcolor{keywordtype}{integer} :: error\_flag = 2}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00093}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a3b61f56fc7c29be3f952c1cb1b98c49a}{00093}}     \textcolor{keywordtype}{character(len=255)} :: error\_message}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00095}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_a0d0bc766c6012c19888e22174fd06beb}{00095}}     \textcolor{keywordtype}{procedure}(\mbox{\hyperlink{interfaceddx__parameters_1_1print__func__interface}{print\_func\_interface}}), \textcolor{keywordtype}{pointer}, \textcolor{keywordtype}{nopass} :: print\_func}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00097}\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type_aff335b17a4bd5435a7d7ef8ea618e19a}{00097}}     \textcolor{keywordtype}{integer} :: matvecmem}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00098}00098 \textcolor{keyword}{end type }\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\_params\_type}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00099}00099 }
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00100}00100 \textcolor{keyword}{contains}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00101}00101 }
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00147}\mbox{\hyperlink{namespaceddx__parameters_a37d40289550bb6eb8e049fb4ca227c2c}{00147}} \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespaceddx__parameters_a37d40289550bb6eb8e049fb4ca227c2c}{params\_init}}(model, force, eps, kappa, eta, se, lmax, ngrid, \&}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00148}00148         \& matvecmem, itersolver, maxiter, jacobi\_ndiis, gmresr\_j, gmresr\_dim, \&}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00149}00149         \& fmm, pm, pl, nproc, nsph, charge, \&}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00150}00150         \& csph, rsph, print\_func, params, info)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00151}00151     \textcolor{comment}{!! Inputs}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00152}00152     \textcolor{comment}{! Model to use 1 for COSMO, 2 for PCM, 3 for LPB.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00153}00153     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: model}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00154}00154     \textcolor{comment}{! Whether computing analytical forces will be required (1) or not (0).}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00155}00155     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: force}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00156}00156     \textcolor{comment}{! Relative dielectric permittivity.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00157}00157 \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{intent(in)} :: eps}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00158}00158     \textcolor{comment}{! Debye-\/H\(\backslash\)"{}\{u\}ckel parameter. Referenced only in LPB model (model=3)}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00159}00159 \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{intent(in)} :: kappa}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00160}00160     \textcolor{comment}{! Regularization parameter.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00161}00161 \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{intent(in)} :: eta}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00162}00162     \textcolor{comment}{! Shift of the regularization. -\/1 for interior, 0 for centered and}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00163}00163     \textcolor{comment}{!      1 for outer regularization.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00164}00164 \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{intent(in)} :: se}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00165}00165     \textcolor{comment}{! Maximal degree of modeling spherical harmonics.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00166}00166     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: lmax}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00167}00167     \textcolor{comment}{! Number of Lebedev grid points on each sphere.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00168}00168     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: ngrid}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00169}00169     \textcolor{comment}{! handling of sparse matrix. 1 for precomputing them and keeping them in}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00170}00170     \textcolor{comment}{! memory, 0 for assembling the mvps on-\/the-\/fly.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00171}00171     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: matvecmem}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00172}00172     \textcolor{comment}{! Iterative solver to be used. 1 for Jacobi/DIIS, 2 for GMRES.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00173}00173     \textcolor{comment}{! Other solvers might be added later.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00174}00174     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: itersolver}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00175}00175     \textcolor{comment}{! Maximum number of iterations for the iterative solver.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00176}00176     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: maxiter}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00177}00177     \textcolor{comment}{! Number of extrapolation points for Jacobi/DIIS solver. Referenced only}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00178}00178     \textcolor{comment}{!      if Jacobi solver is used.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00179}00179     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: jacobi\_ndiis}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00180}00180     \textcolor{comment}{! Number of last vectors that GMRESR works with. Referenced only if GMRESR}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00181}00181     \textcolor{comment}{!      solver is used.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00182}00182     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: gmresr\_j}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00183}00183     \textcolor{comment}{! Dimension of the envoked GMRESR. In case of 0 GMRESR becomes the GCR}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00184}00184     \textcolor{comment}{!      solver, one of the simplest versions of GMRESR. Referenced only if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00185}00185     \textcolor{comment}{!      GMRESR solver is used.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00186}00186     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: gmresr\_dim}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00187}00187     \textcolor{comment}{! Enable (1) or disable (0) use of FMM techniques.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00188}00188     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: fmm}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00189}00189     \textcolor{comment}{! Maximal degree of spherical harmonics for a multipole expansion.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00190}00190     \textcolor{comment}{!}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00191}00191     \textcolor{comment}{! If this value is -\/1 then no far-\/field FMM interactions are performed.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00192}00192     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: pm}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00193}00193     \textcolor{comment}{! Maximal degree of spherical harmonics for a local expansion.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00194}00194     \textcolor{comment}{!}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00195}00195     \textcolor{comment}{! If this value is -\/1 then no far-\/field FMM interactions are performed.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00196}00196     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: pl}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00197}00197     \textcolor{comment}{! Number of OpenMP threads to be used. }}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00198}00198     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: nproc}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00199}00199     \textcolor{comment}{! Number of atoms in the molecule.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00200}00200     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: nsph}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00201}00201     \textcolor{comment}{! Charges of atoms of a dimension (nsph).}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00202}00202 \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{intent(in)} :: charge(nsph)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00203}00203     \textcolor{comment}{! Centers of atoms of a dimension (3, nsph).}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00204}00204 \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{intent(in)} :: csph(3, nsph)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00205}00205     \textcolor{comment}{! Array of radii of atoms of a dimension (nsph).}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00206}00206 \textcolor{keywordtype}{    real}(dp), \textcolor{keywordtype}{intent(in)} :: rsph(nsph)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00207}00207     \textcolor{comment}{! Error printing function}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00208}00208     \textcolor{keywordtype}{procedure}(\mbox{\hyperlink{interfaceddx__parameters_1_1print__func__interface}{print\_func\_interface}}) :: print\_func}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00209}00209     \textcolor{comment}{!! Outputs}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00210}00210     \textcolor{keywordtype}{type}(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\_params\_type}}), \textcolor{keywordtype}{intent(out)} :: params}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00211}00211     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(out)} :: info}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00212}00212     \textcolor{comment}{!! Local variables}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00213}00213     \textcolor{keywordtype}{integer} :: igrid, i}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00214}00214     \textcolor{keywordtype}{character(len=255)} :: string}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00215}00215     \textcolor{comment}{!! The code}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00216}00216     \textcolor{comment}{! Model, 1=COSMO, 2=PCM, 3=LPB}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00217}00217     \textcolor{keywordflow}{if} ((model .lt. 1) .or. (model .gt. 3)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00218}00218         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00219}00219         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `model`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00220}00220         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00221}00221         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00222}00222         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00223}00223 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00224}00224     params \% model = model}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00225}00225     \textcolor{comment}{! Check if forces are needed}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00226}00226     \textcolor{keywordflow}{if} ((force .lt. 0) .or. (force .gt. 1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00227}00227         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00228}00228         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `force`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00229}00229         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00230}00230         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00231}00231         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00232}00232 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00233}00233     params \% force = force}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00234}00234     \textcolor{comment}{! Relative dielectric permittivity}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00235}00235     \textcolor{keywordflow}{if} (eps .le. one) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00236}00236         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00237}00237         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `eps`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00238}00238         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00239}00239         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00240}00240         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00241}00241 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00242}00242     params \% eps = eps}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00243}00243     \textcolor{comment}{! Debye-\/H\(\backslash\)"{}\{u\}ckel parameter (only used in ddLPB)}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00244}00244     \textcolor{keywordflow}{if} ((model .eq. 3) .and. (kappa .le. zero)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00245}00245         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00246}00246         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `kappa`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00247}00247         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00248}00248         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00249}00249         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00250}00250 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00251}00251     params \% kappa = kappa}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00252}00252     \textcolor{comment}{! Regularization parameter}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00253}00253     \textcolor{keywordflow}{if} ((eta .lt. zero) .or. (eta .gt. one)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00254}00254         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00255}00255         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `eta`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00256}00256         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00257}00257         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00258}00258         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00259}00259 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00260}00260     params \% eta = eta}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00261}00261     \textcolor{comment}{! Shift of a regularization}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00262}00262     \textcolor{keywordflow}{if} ((se .lt. -\/one) .or. (se .gt. one)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00263}00263         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00264}00264         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `se`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00265}00265         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00266}00266         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00267}00267         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00268}00268 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00269}00269     params \% se = se}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00270}00270     \textcolor{comment}{! Degree of modeling spherical harmonics}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00271}00271     \textcolor{keywordflow}{if} (lmax .lt. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00272}00272         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00273}00273         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `lmax`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00274}00274         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00275}00275         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00276}00276         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00277}00277 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00278}00278     params \% lmax = lmax}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00279}00279     \textcolor{comment}{! Check number of Lebedev grid points}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00280}00280     igrid = 0}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00281}00281     \textcolor{keywordflow}{do} i = 1, \mbox{\hyperlink{namespaceddx__definitions_ae550955ff555b222abaed24c541cde67}{nllg}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00282}00282         \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespaceddx__definitions_a31904c9990cc087f2808a4c1c662800a}{ng0}}(i) .eq. ngrid) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00283}00283             igrid = i}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00284}00284             \textcolor{keywordflow}{exit}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00285}00285 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00286}00286 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00287}00287     \textcolor{keywordflow}{if} (igrid .eq. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00288}00288         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00289}00289         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: Unsupported value of `ngrid`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00290}00290         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00291}00291         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00292}00292         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00293}00293 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00294}00294     params \% ngrid = ngrid}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00295}00295     \textcolor{comment}{! Iterative solver: 1=Jacobi 2=GMRES}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00296}00296     \textcolor{keywordflow}{if} ((itersolver .lt. 1) .or. (itersolver .gt. 2)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00297}00297         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00298}00298         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `itersolver`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00299}00299         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00300}00300         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00301}00301         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00302}00302 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00303}00303     params \% itersolver = itersolver}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00304}00304     \textcolor{comment}{! Maximum number of iterations}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00305}00305     \textcolor{keywordflow}{if} (maxiter .le. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00306}00306         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00307}00307         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `maxiter`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00308}00308         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00309}00309         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00310}00310         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00311}00311 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00312}00312     params \% maxiter = maxiter}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00313}00313     \textcolor{comment}{! Number of Jacobi DIIS extrapolation points (ndiis=25 works)}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00314}00314     \textcolor{keywordflow}{if} (jacobi\_ndiis .lt. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00315}00315         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00316}00316         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `jacobi\_ndiis`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00317}00317         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00318}00318         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00319}00319         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00320}00320 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00321}00321     params \% jacobi\_ndiis = jacobi\_ndiis}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00322}00322     \textcolor{comment}{! Number of last vectors that GMRESR works with. Referenced only if GMRESR}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00323}00323     \textcolor{comment}{!      solver is used.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00324}00324     \textcolor{keywordflow}{if} (gmresr\_j .lt. 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00325}00325         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00326}00326         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `gmresr\_j`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00327}00327         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00328}00328         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00329}00329         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00330}00330 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00331}00331     params \% gmresr\_j = gmresr\_j}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00332}00332     \textcolor{comment}{! Dimension of the envoked GMRESR. In case of 0 GMRESR becomes the GCR}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00333}00333     \textcolor{comment}{!      solver, one of the simplest versions of GMRESR. Referenced only if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00334}00334     \textcolor{comment}{!      GMRESR solver is used.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00335}00335     \textcolor{keywordflow}{if} (gmresr\_dim .lt. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00336}00336         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00337}00337         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `gmresr\_j`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00338}00338         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00339}00339         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00340}00340         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00341}00341 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00342}00342     params \% gmresr\_dim = gmresr\_dim}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00343}00343     \textcolor{comment}{! Check if FMM-\/acceleration is needed}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00344}00344     \textcolor{keywordflow}{if} ((fmm .lt. 0) .or. (fmm .gt. 1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00345}00345         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00346}00346         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `fmm`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00347}00347         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00348}00348         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00349}00349         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00350}00350 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00351}00351     params \% fmm = fmm}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00352}00352     \textcolor{comment}{! Set FMM parameters if FMM is needed}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00353}00353     \textcolor{keywordflow}{if} (fmm .eq. 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00354}00354         \textcolor{comment}{! Maximal degree of multipole spherical harmonics. Value -\/1 means no }}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00355}00355         \textcolor{comment}{! far-\/field interactions are to be computed, only near-\/field}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00356}00356         \textcolor{comment}{! interactions are taken into account.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00357}00357         \textcolor{keywordflow}{if} (pm .lt. -\/1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00358}00358             params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00359}00359             params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `pm`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00360}00360             \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00361}00361             info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00362}00362             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00363}00363 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00364}00364         \textcolor{comment}{! Maximal degree of local spherical harmonics. Value -\/1 means no }}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00365}00365         \textcolor{comment}{! far-\/field interactions are to be computed, only near-\/field}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00366}00366         \textcolor{comment}{! interactions are taken into account.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00367}00367         \textcolor{keywordflow}{if} (pl .lt. -\/1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00368}00368             params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00369}00369             params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `pl`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00370}00370             \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00371}00371             info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00372}00372             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00373}00373 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00374}00374         \textcolor{comment}{! If far-\/field interactions are to be ignored}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00375}00375         \textcolor{keywordflow}{if} ((pl .eq. -\/1) .or. (pm .eq. -\/1)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00376}00376             params \% pm = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00377}00377             params \% pl = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00378}00378         \textcolor{comment}{! If far-\/field interactions are to be taken into account}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00379}00379         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00380}00380             params \% pm = pm}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00381}00381             params \% pl = pl}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00382}00382 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00383}00383     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00384}00384         \textcolor{comment}{! These values are ignored if fmm flag is 0}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00385}00385         params \% pm = -\/2}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00386}00386         params \% pl = -\/2}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00387}00387 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00388}00388     \textcolor{comment}{! Number of OpenMP threads to be used}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00389}00389     \textcolor{comment}{! available.}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00390}00390     \textcolor{keywordflow}{if} (nproc .lt. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00391}00391         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00392}00392         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `nproc`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00393}00393         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00394}00394         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00395}00395         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00396}00396     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (nproc .eq. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00397}00397         params \% nproc = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00398}00398     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00399}00399         params \% nproc = nproc}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00400}00400 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00401}00401     \textcolor{keyword}{call }omp\_set\_num\_threads(params \% nproc)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00402}00402     \textcolor{comment}{! Number of atoms}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00403}00403     \textcolor{keywordflow}{if} (nsph .le. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00404}00404         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00405}00405         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `nsph`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00406}00406         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00407}00407         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00408}00408         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00409}00409 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00410}00410     params \% nsph = nsph}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00411}00411     \textcolor{comment}{! Allocation of charge, csph and rsph}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00412}00412     \textcolor{keyword}{allocate}(params \% charge(nsph), params \% csph(3, nsph), \&}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00413}00413         \& params \% rsph(nsph), stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00414}00414     \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00415}00415         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00416}00416         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: `charge`, `csph` and `rsph` "{}} \&}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00417}00417             \& // \textcolor{stringliteral}{"{}allocations failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00418}00418         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00419}00419         info = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00420}00420         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00421}00421 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00422}00422     params \% charge = charge}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00423}00423     params \% csph = csph}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00424}00424     params \% rsph = rsph}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00425}00425     \textcolor{keywordflow}{if} (matvecmem.eq.0 .or. matvecmem.eq.1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00426}00426         params \% matvecmem = matvecmem}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00427}00427     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00428}00428         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00429}00429         params \% error\_message = \textcolor{stringliteral}{"{}params\_init: invalid value of `matvecmem`"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00430}00430         \textcolor{keyword}{call }print\_func(params \% error\_message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00431}00431         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00432}00432         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00433}00433 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00434}00434     \textcolor{comment}{! Set print function for errors}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00435}00435     params \% print\_func => print\_func}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00436}00436     \textcolor{comment}{! Clear error state}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00437}00437     info = 0}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00438}00438     params \% error\_flag = 0}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00439}00439     params \% error\_message = \textcolor{stringliteral}{"{}"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00440}00440 \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespaceddx__parameters_a37d40289550bb6eb8e049fb4ca227c2c}{params\_init}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00441}00441 }
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00443}\mbox{\hyperlink{namespaceddx__parameters_ab58f264af44239d745e1a571c1850576}{00443}} \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespaceddx__parameters_ab58f264af44239d745e1a571c1850576}{params\_print}}(params)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00444}00444     \textcolor{comment}{!! Input}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00445}00445     \textcolor{keywordtype}{type}(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\_params\_type}}), \textcolor{keywordtype}{intent(in)} :: params}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00446}00446     \textcolor{comment}{!! Local variables}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00447}00447     \textcolor{keywordtype}{character(len=255)} :: string}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00448}00448     \textcolor{comment}{!! The code}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00449}00449     \textcolor{keywordflow}{if} (params \% error\_flag .eq. 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00450}00450         string = \textcolor{stringliteral}{"{}params\_print: `params` is in error state"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00451}00451         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00452}00452     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (params \% error\_flag .eq. 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00453}00453         string = \textcolor{stringliteral}{"{}params\_print: `params` is not initialised"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00454}00454         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00455}00455     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00456}00456         \textcolor{keyword}{write}(string, \textcolor{stringliteral}{"{}(A)"{}}) \textcolor{stringliteral}{"{}DDX parameters object"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00457}00457         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00458}00458         \textcolor{keyword}{write}(string, \textcolor{stringliteral}{"{}(A,A)"{}}) \textcolor{stringliteral}{"{}Model: "{}}, trim(\mbox{\hyperlink{namespaceddx__definitions_a27faa3db3323ba2c6427084fcbf7b953}{model\_str}}(params \% model))}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00459}00459         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00460}00460         \textcolor{keyword}{write}(string, \textcolor{stringliteral}{"{}(A,L1)"{}}) \textcolor{stringliteral}{"{}Forces: "{}}, params \% force .eq. 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00461}00461         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00462}00462         \textcolor{keyword}{write}(string, \textcolor{stringliteral}{"{}(A,ES23.16E3)"{}}) \textcolor{stringliteral}{"{}Dielectric permittivity (eps): "{}}, \&}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00463}00463             \& params \% eps}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00464}00464         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00465}00465         \textcolor{keyword}{write}(string, \textcolor{stringliteral}{"{}(A,ES23.16E3)"{}}) \textcolor{stringliteral}{"{}Debye-\/Huckel parameter (kappa): "{}}, \&}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00466}00466             \& params \% kappa}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00467}00467         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00468}00468         \textcolor{keyword}{write}(string, \textcolor{stringliteral}{"{}(A,ES23.16E3)"{}}) \textcolor{stringliteral}{"{}Regularization (eta): "{}}, params \% eta}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00469}00469         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00470}00470         \textcolor{keyword}{write}(string, \textcolor{stringliteral}{"{}(A,ES23.16E3)"{}}) \textcolor{stringliteral}{"{}Shift of regularization (se): "{}}, \&}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00471}00471             \& params \% se}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00472}00472         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00473}00473         \textcolor{keyword}{write}(string, \textcolor{stringliteral}{"{}(A,I0)"{}}) \textcolor{stringliteral}{"{}Modeling harmonics degree (lmax): "{}}, \&}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00474}00474             \& params \% lmax}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00475}00475         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00476}00476         \textcolor{keyword}{write}(string, \textcolor{stringliteral}{"{}(A,I0)"{}}) \textcolor{stringliteral}{"{}Number of Lebedev grid points (ngrid): "{}}, \&}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00477}00477             \& params \% ngrid}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00478}00478         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00479}00479         \textcolor{keyword}{write}(string, \textcolor{stringliteral}{"{}(A,A)"{}}) \textcolor{stringliteral}{"{}Iterative solver: "{}}, \&}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00480}00480             \& trim(\mbox{\hyperlink{namespaceddx__definitions_af0a948616df64a208244211d500820c3}{itersolver\_str}}(params \% itersolver))}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00481}00481         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00482}00482         \textcolor{keyword}{write}(string, \textcolor{stringliteral}{"{}(A,I0)"{}}) \textcolor{stringliteral}{"{}maxiter: "{}}, params \% maxiter}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00483}00483         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00484}00484         \textcolor{keyword}{write}(string, \textcolor{stringliteral}{"{}(A,I0)"{}}) \textcolor{stringliteral}{"{}jacobi\_ndiis: "{}}, params \% jacobi\_ndiis}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00485}00485         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00486}00486         \textcolor{keyword}{write}(string, \textcolor{stringliteral}{"{}(A,I0)"{}}) \textcolor{stringliteral}{"{}fmm: "{}}, params \% fmm}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00487}00487         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00488}00488         \textcolor{keyword}{write}(string, \textcolor{stringliteral}{"{}(A,I0)"{}}) \textcolor{stringliteral}{"{}pm: "{}}, params \% pm}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00489}00489         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00490}00490         \textcolor{keyword}{write}(string, \textcolor{stringliteral}{"{}(A,I0)"{}}) \textcolor{stringliteral}{"{}pl: "{}}, params \% pl}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00491}00491         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00492}00492         \textcolor{keyword}{write}(string, \textcolor{stringliteral}{"{}(A,I0)"{}}) \textcolor{stringliteral}{"{}nproc: "{}}, params \% nproc}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00493}00493         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00494}00494         \textcolor{keyword}{write}(string, \textcolor{stringliteral}{"{}(A,I0)"{}}) \textcolor{stringliteral}{"{}nsph: "{}}, params \% nsph}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00495}00495         \textcolor{keyword}{call }params \% print\_func(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00496}00496 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00497}00497 \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespaceddx__parameters_ab58f264af44239d745e1a571c1850576}{params\_print}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00498}00498 }
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00505}\mbox{\hyperlink{namespaceddx__parameters_a41f19aa9b4b7798b5374fa3f6a03ea00}{00505}} \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespaceddx__parameters_a41f19aa9b4b7798b5374fa3f6a03ea00}{params\_deinit}}(params, info)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00506}00506     \textcolor{comment}{!! Input}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00507}00507     \textcolor{keywordtype}{type}(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\_params\_type}}), \textcolor{keywordtype}{intent(inout)} :: params}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00508}00508     \textcolor{comment}{!! Output}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00509}00509     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(out)} :: info}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00510}00510     \textcolor{comment}{!! Code}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00511}00511     \textcolor{comment}{! Check if input params is in proper state}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00512}00512     \textcolor{keywordflow}{if} (params \% error\_flag .eq. 1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00513}00513         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00514}00514         params \% error\_message = \textcolor{stringliteral}{"{}params\_deinit: `params` is in error state"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00515}00515         info = -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00516}00516         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00517}00517 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00518}00518     \textcolor{comment}{! Deallocate memory to avoid leaks}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00519}00519     \textcolor{keyword}{deallocate}(params \% charge, stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00520}00520     \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00521}00521         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00522}00522         params \% error\_message = \textcolor{stringliteral}{"{}params\_deinit: `charge` deallocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00523}00523         info = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00524}00524 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00525}00525     \textcolor{keyword}{deallocate}(params \% csph, stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00526}00526     \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00527}00527         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00528}00528         params \% error\_message = \textcolor{stringliteral}{"{}params\_deinit: `csph` deallocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00529}00529         info = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00530}00530 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00531}00531     \textcolor{keyword}{deallocate}(params \% rsph, stat=info)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00532}00532     \textcolor{keywordflow}{if} (info .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00533}00533         params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00534}00534         params \% error\_message = \textcolor{stringliteral}{"{}params\_deinit: `rsph` deallocation failed"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00535}00535         info = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00536}00536 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00537}00537     info = 0}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00538}00538     \textcolor{comment}{! Set params in error state to avoid its usage (due to deallocation)}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00539}00539     params \% error\_flag = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00540}00540     params \% error\_message = \textcolor{stringliteral}{"{}Not initialized"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00541}00541 \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespaceddx__parameters_a41f19aa9b4b7798b5374fa3f6a03ea00}{params\_deinit}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00542}00542 }
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00547}\mbox{\hyperlink{namespaceddx__parameters_a1b84e0732491759d44bb63d14f7c77a5}{00547}} \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespaceddx__parameters_a1b84e0732491759d44bb63d14f7c77a5}{closest\_supported\_lebedev\_grid}}(ngrid)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00548}00548     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(inout)} :: ngrid}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00549}00549     \textcolor{keywordtype}{integer} :: igrid, i, inear, jnear}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00550}00550     \textcolor{comment}{! Get nearest number of Lebedev grid points}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00551}00551     igrid = 0}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00552}00552     inear = 100000}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00553}00553     \textcolor{keywordflow}{do} i = 1, \mbox{\hyperlink{namespaceddx__definitions_ae550955ff555b222abaed24c541cde67}{nllg}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00554}00554         jnear = abs(\mbox{\hyperlink{namespaceddx__definitions_a31904c9990cc087f2808a4c1c662800a}{ng0}}(i) -\/ ngrid)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00555}00555         \textcolor{keywordflow}{if} (jnear .lt. inear) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00556}00556             inear = jnear}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00557}00557             igrid = i}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00558}00558 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00559}00559 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00560}00560     ngrid = \mbox{\hyperlink{namespaceddx__definitions_a31904c9990cc087f2808a4c1c662800a}{ng0}}(igrid)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00561}00561 \textcolor{keyword}{end subroutine}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00562}00562 }
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00564}\mbox{\hyperlink{namespaceddx__parameters_ab4ce0e49948cbfb16876f79a8e753bac}{00564}} \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespaceddx__parameters_ab4ce0e49948cbfb16876f79a8e753bac}{error}}(code, message)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00565}00565     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: code}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00566}00566     \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{intent(in)} :: message}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00567}00567     \textcolor{keyword}{write}(0, \textcolor{stringliteral}{"{}(A,A)"{}}) \textcolor{stringliteral}{"{}ERROR: "{}}, message}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00568}00568     \textcolor{keyword}{write}(0, \textcolor{stringliteral}{"{}(A,I2)"{}}) \textcolor{stringliteral}{"{}CODE:  "{}}, code}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00569}00569     stop -\/1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00570}00570 \textcolor{keyword}{end subroutine}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00571}00571 }
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00572}00572 }
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00574}\mbox{\hyperlink{namespaceddx__parameters_a63f973043b80c39c6f905fba9bd2aa09}{00574}} \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespaceddx__parameters_a63f973043b80c39c6f905fba9bd2aa09}{print\_func\_default}}(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00575}00575     \textcolor{keywordtype}{character(len=255)}, \textcolor{keywordtype}{intent(in)} :: string}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00576}00576 \textcolor{comment}{!   print "{}(A)"{}, string}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00577}00577     \textcolor{keyword}{write}(6,\textcolor{stringliteral}{"{}(A)"{}}) trim(string)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00578}00578 \textcolor{keyword}{end subroutine}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00579}00579 }
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00580}00580 \textcolor{keyword}{subroutine }params\_free(params, info)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00581}00581     \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00582}00582     \textcolor{keywordtype}{type}(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\_params\_type}}), \textcolor{keywordtype}{intent(out)} :: params}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00583}00583     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(out)} :: info}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00584}00584     \textcolor{keywordtype}{integer} :: istat}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00585}00585 }
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00586}00586     istat = 0}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00587}00587     info = 0}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00588}00588 }
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00589}00589     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(params \% charge)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00590}00590         \textcolor{keyword}{deallocate}(params \% charge, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00591}00591         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00592}00592             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00593}00593             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`charge` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00594}00594             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00595}00595 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00596}00596 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00597}00597     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(params \% csph)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00598}00598         \textcolor{keyword}{deallocate}(params \% csph, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00599}00599         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00600}00600             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00601}00601             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`csph` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00602}00602             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00603}00603 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00604}00604 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00605}00605     \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(params \% rsph)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00606}00606         \textcolor{keyword}{deallocate}(params \% rsph, stat=istat)}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00607}00607         \textcolor{keywordflow}{if} (istat .ne. 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00608}00608             info = 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00609}00609             \textcolor{keyword}{write}(6, *) \textcolor{stringliteral}{"{}`rsph` deallocation failed!"{}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00610}00610             stop 1}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00611}00611 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00612}00612 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00613}00613 \textcolor{keyword}{end subroutine }params\_free}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00614}00614 }
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00615}00615 \textcolor{keyword}{end module }\mbox{\hyperlink{namespaceddx__parameters}{ddx\_parameters}}}
\DoxyCodeLine{\Hypertarget{ddx__parameters_8f90_source_l00616}00616 }

\end{DoxyCode}
