\hypertarget{namespaceddx__harmonics}{}\doxysection{ddx\+\_\+harmonics Module Reference}
\label{namespaceddx__harmonics}\index{ddx\_harmonics@{ddx\_harmonics}}


Harmonics-\/related core routines.  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a00c5ff3e46e5eb64eba38eee2b5f0751}{ylmscale}} (p, vscales, v4pi2lp1, vscales\+\_\+rel)
\begin{DoxyCompactList}\small\item\em Compute scaling factors of real normalized spherical harmonics. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_ad9d821757cc745908129ffb88fe2678b}{fmm\+\_\+constants}} (dmax, pm, pl, vcnk, m2l\+\_\+ztranslate\+\_\+coef, m2l\+\_\+ztranslate\+\_\+adj\+\_\+coef)
\begin{DoxyCompactList}\small\item\em Compute FMM-\/related constants. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a6c3357a53655c62372199bab90444412}{carttosph}} (x, rho, ctheta, stheta, cphi, sphi)
\begin{DoxyCompactList}\small\item\em Convert input cartesian coordinate into spherical coordinate. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a74a0d8fb15d594b39e7f4872d79846e0}{ylmbas}} (x, rho, ctheta, stheta, cphi, sphi, p, vscales, vylm, vplm, vcos, vsin)
\begin{DoxyCompactList}\small\item\em Compute all spherical harmonics up to a given degree at a given point. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a66b4e8bee63238c5c1c3f7a4210c8dd4}{trgev}} (cphi, sphi, p, vcos, vsin)
\begin{DoxyCompactList}\small\item\em Compute arrays of $ \cos(m \phi) $ and $ \sin(m \phi) $. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a7fcf9715c6a0d3dd5c291cafffaa5d1f}{polleg}} (ctheta, stheta, p, vplm)
\begin{DoxyCompactList}\small\item\em Compute associated Legendre polynomials. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a43b882cf0333a0ee0bf062501a03ff01}{polleg\+\_\+work}} (ctheta, stheta, p, vplm, work)
\begin{DoxyCompactList}\small\item\em Compute associated Legendre polynomials. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_ae7991df8ed4f43aaeec35deb5188137f}{modified\+\_\+spherical\+\_\+bessel\+\_\+first\+\_\+kind}} (lmax, argument, SI, DI, work)
\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_aba0c8255393d72079731e92441751673}{modified\+\_\+spherical\+\_\+bessel\+\_\+second\+\_\+kind}} (lmax, argument, SK, DK, work)
\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a4c2f0791982b1533d68d0b245e33f28d}{fmm\+\_\+p2m}} (c, src\+\_\+q, dst\+\_\+r, p, vscales, beta, dst\+\_\+m)
\begin{DoxyCompactList}\small\item\em Accumulate a multipole expansion induced by a particle of a given charge. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_ae1cc4ca98a66bc491b377766715cdb59}{fmm\+\_\+p2m\+\_\+work}} (c, src\+\_\+q, dst\+\_\+r, p, vscales, beta, dst\+\_\+m, work)
\begin{DoxyCompactList}\small\item\em Accumulate a multipole expansion induced by a particle of a given charge. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_abd5b67dd330ca6cd8d978cbc917839fd}{fmm\+\_\+m2p}} (c, src\+\_\+r, p, vscales\+\_\+rel, alpha, src\+\_\+m, beta, dst\+\_\+v)
\begin{DoxyCompactList}\small\item\em Accumulate potential, induced by multipole spherical harmonics. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a84bf7c6ebd36d68822a3e81c9d01055f}{fmm\+\_\+m2p\+\_\+work}} (c, src\+\_\+r, p, vscales\+\_\+rel, alpha, src\+\_\+m, beta, dst\+\_\+v, work)
\begin{DoxyCompactList}\small\item\em Accumulate potential, induced by multipole spherical harmonics. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_ad316c4006889f94e0626566a4462db49}{fmm\+\_\+m2p\+\_\+bessel}} (c, src\+\_\+r, p, vscales, alpha, src\+\_\+m, beta, dst\+\_\+v)
\begin{DoxyCompactList}\small\item\em Accumulate potential, induced by multipole spherical harmonics. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_aeffc8a34f016545c454b733f3fd589c8}{fmm\+\_\+m2p\+\_\+bessel\+\_\+work}} (c, p, vscales, SK\+\_\+ri, alpha, src\+\_\+m, beta, dst\+\_\+v, work\+\_\+complex, work)
\begin{DoxyCompactList}\small\item\em Accumulate Bessel potential, induced by multipole spherical harmonics. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_ae8021b65b92bb9cd560d4288dc46e109}{fmm\+\_\+m2p\+\_\+bessel\+\_\+grad}} (c, src\+\_\+r, p, vscales, alpha, src\+\_\+m, beta, dst\+\_\+g)
\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a01fc177160fca45173657a5e7e7d5c67}{fmm\+\_\+m2p\+\_\+adj}} (c, src\+\_\+q, dst\+\_\+r, p, vscales\+\_\+rel, beta, dst\+\_\+m)
\begin{DoxyCompactList}\small\item\em Adjoint M2P operation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a6b5af8fca5bf86b5c643501a079798f2}{fmm\+\_\+m2p\+\_\+adj\+\_\+work}} (c, src\+\_\+q, dst\+\_\+r, p, vscales\+\_\+rel, beta, dst\+\_\+m, work)
\begin{DoxyCompactList}\small\item\em Adjoint M2P operation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a364a597df78940a0e747a853df495682}{fmm\+\_\+m2p\+\_\+bessel\+\_\+adj}} (c, src\+\_\+q, dst\+\_\+r, kappa, p, vscales, beta, dst\+\_\+m)
\begin{DoxyCompactList}\small\item\em Adjoint M2P operation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a6f93125bb26d1b6b77d351eb7057c216}{fmm\+\_\+m2p\+\_\+bessel\+\_\+adj\+\_\+work}} (c, src\+\_\+q, dst\+\_\+sk, p, vscales, beta, dst\+\_\+m, work\+\_\+complex, work)
\begin{DoxyCompactList}\small\item\em Adjoint M2P operation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a95f20c5bbb717d6615f9d9b46c40c567}{fmm\+\_\+m2p\+\_\+mat}} (c, r, p, vscales, mat)
\begin{DoxyCompactList}\small\item\em Accumulate potentials, induced by each multipole spherical harmonic. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a3e3bd6455b55865ee1829cd8addaad3c}{fmm\+\_\+l2p}} (c, src\+\_\+r, p, vscales, alpha, src\+\_\+l, beta, dst\+\_\+v)
\begin{DoxyCompactList}\small\item\em Accumulate potential, induced by local spherical harmonics. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_afcb1b1e24d6d54835de05360bedad809}{fmm\+\_\+l2p\+\_\+work}} (c, src\+\_\+r, p, vscales\+\_\+rel, alpha, src\+\_\+l, beta, dst\+\_\+v, work)
\begin{DoxyCompactList}\small\item\em Accumulate potential, induced by local spherical harmonics. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a91f16516ededaf0fc38fe7efc9013e44}{fmm\+\_\+l2p\+\_\+bessel}} (c, src\+\_\+r, p, vscales, alpha, src\+\_\+l, beta, dst\+\_\+v)
\begin{DoxyCompactList}\small\item\em Accumulate potential, induced by local spherical harmonics. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_ae9cf6b001f184f2f72b53e1c44adc631}{fmm\+\_\+l2p\+\_\+bessel\+\_\+work}} (c, p, vscales, SI\+\_\+ri, alpha, src\+\_\+l, beta, dst\+\_\+v, work\+\_\+complex, work)
\begin{DoxyCompactList}\small\item\em Accumulate Bessel potential, induced by local spherical harmonics. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_ad11d8e5937c029d3663550ac1cacb7ab}{fmm\+\_\+l2p\+\_\+bessel\+\_\+grad}} (c, src\+\_\+r, p, vscales, alpha, src\+\_\+l, beta, dst\+\_\+g)
\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a467ab49d671143bb6a90e2db8734408c}{fmm\+\_\+l2p\+\_\+adj}} (c, src\+\_\+q, dst\+\_\+r, p, vscales\+\_\+rel, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Adjoint of L2P. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a02d5736e15ad31da5e0a6b349fdacac1}{fmm\+\_\+l2p\+\_\+adj\+\_\+work}} (c, src\+\_\+q, dst\+\_\+r, p, vscales\+\_\+rel, beta, dst\+\_\+l, work)
\begin{DoxyCompactList}\small\item\em Adjoint L2P. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a8f2ebf0050f757ce65ffe0f5d8bbc654}{fmm\+\_\+sph\+\_\+transform}} (p, r1, alpha, src, beta, dst)
\begin{DoxyCompactList}\small\item\em Transform coefficients of spherical harmonics to a new cartesion system. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_ab643a611d5cbc4b1a035546a01eb9bf5}{fmm\+\_\+sph\+\_\+transform\+\_\+work}} (p, r1, alpha, src, beta, dst, work)
\begin{DoxyCompactList}\small\item\em Transform spherical harmonics to a new cartesion system of coordinates. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a8e16c11fcefb704bfa036827b574989c}{fmm\+\_\+sph\+\_\+rotate\+\_\+oz}} (p, vcos, vsin, alpha, src, beta, dst)
\begin{DoxyCompactList}\small\item\em Rotate spherical harmonics around OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_ae7164759454da6c012e9afdf7f0aa156}{fmm\+\_\+sph\+\_\+rotate\+\_\+oz\+\_\+work}} (p, vcos, vsin, alpha, src, beta, dst)
\begin{DoxyCompactList}\small\item\em Rotate spherical harmonics around OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a588c445e8bd85ccb3d81190be6b2901c}{fmm\+\_\+sph\+\_\+rotate\+\_\+oz\+\_\+adj}} (p, vcos, vsin, alpha, src, beta, dst)
\begin{DoxyCompactList}\small\item\em Rotate spherical harmonics around OZ axis in an opposite direction. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a6376d4d78d6bcbf83b5747c03f13065c}{fmm\+\_\+sph\+\_\+rotate\+\_\+oz\+\_\+adj\+\_\+work}} (p, vcos, vsin, alpha, src, beta, dst)
\begin{DoxyCompactList}\small\item\em Rotate spherical harmonics around OZ axis in an opposite direction. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a3a330c054807d19fa99aa1bcfec71f9e}{fmm\+\_\+sph\+\_\+rotate\+\_\+oxz}} (p, ctheta, stheta, alpha, src, beta, dst)
\begin{DoxyCompactList}\small\item\em Transform spherical harmonics in the OXZ plane. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a1acd3dc4a1f64b2d6639817b160f223d}{fmm\+\_\+sph\+\_\+rotate\+\_\+oxz\+\_\+work}} (p, ctheta, stheta, alpha, src, beta, dst, work)
\begin{DoxyCompactList}\small\item\em Transform spherical harmonics in the OXZ plane. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a04507f68eafd1a3757afb3958107c895}{fmm\+\_\+m2m\+\_\+ztranslate}} (z, src\+\_\+r, dst\+\_\+r, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+m)
\begin{DoxyCompactList}\small\item\em Direct M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a18f3f31756270f14e4bf398be1f40a4a}{fmm\+\_\+m2m\+\_\+ztranslate\+\_\+work}} (z, src\+\_\+r, dst\+\_\+r, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+m, work)
\begin{DoxyCompactList}\small\item\em Direct M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a9d80015d1ca2f96afaa655616d754a92}{fmm\+\_\+m2m\+\_\+bessel\+\_\+ztranslate}} (z, src\+\_\+sk, dst\+\_\+sk, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+m)
\begin{DoxyCompactList}\small\item\em Direct M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_aa92f3d719b3f99cf0cdd523e865c12ca}{fmm\+\_\+m2m\+\_\+bessel\+\_\+ztranslate\+\_\+work}} (z, src\+\_\+sk, dst\+\_\+sk, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+m, work, work\+\_\+complex)
\begin{DoxyCompactList}\small\item\em Direct M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_aed42c229d4ba1f6e8e08ab7c7d8f51bc}{fmm\+\_\+m2m\+\_\+bessel\+\_\+ztranslate\+\_\+adj}} (z, src\+\_\+sk, dst\+\_\+sk, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+m)
\begin{DoxyCompactList}\small\item\em Direct M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a25d206db906fd240782e0f328a320a6e}{fmm\+\_\+m2m\+\_\+bessel\+\_\+ztranslate\+\_\+adj\+\_\+work}} (z, src\+\_\+sk, dst\+\_\+sk, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+m, work, work\+\_\+complex)
\begin{DoxyCompactList}\small\item\em Direct M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_ab223429877e369e8bdc48d6bff4a7a32}{fmm\+\_\+m2m\+\_\+bessel\+\_\+derivative\+\_\+ztranslate\+\_\+work}} (src\+\_\+sk, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+m)
\begin{DoxyCompactList}\small\item\em Direct M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a1f3fe034c9643740bea4da7da792ef10}{fmm\+\_\+m2m\+\_\+ztranslate\+\_\+adj}} (z, src\+\_\+r, dst\+\_\+r, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+m)
\begin{DoxyCompactList}\small\item\em Adjoint M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_aa87d3ac883f6e9ec93a2cbb01f243be8}{fmm\+\_\+m2m\+\_\+ztranslate\+\_\+adj\+\_\+work}} (z, src\+\_\+r, dst\+\_\+r, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+m, work)
\begin{DoxyCompactList}\small\item\em Adjoint M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a51c01e8ba76374eff76e3854bdcfe949}{fmm\+\_\+m2m\+\_\+scale}} (src\+\_\+r, dst\+\_\+r, p, alpha, src\+\_\+m, beta, dst\+\_\+m)
\begin{DoxyCompactList}\small\item\em Scale M2M, when spherical harmonics are centered in the same point. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_ac97e4fe54c0763bb7a9bbb7bebaaefdc}{fmm\+\_\+m2m\+\_\+scale\+\_\+adj}} (src\+\_\+r, dst\+\_\+r, p, alpha, src\+\_\+m, beta, dst\+\_\+m)
\begin{DoxyCompactList}\small\item\em Adjoint scale M2M, when spherical harmonics are centered in the same point. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a36fcddfe6a8097317e37332f44ad6331}{fmm\+\_\+m2m\+\_\+rotation}} (c, src\+\_\+r, dst\+\_\+r, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+m)
\begin{DoxyCompactList}\small\item\em Direct M2M translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a8e2dbf3bd69874619c4490930b91b4cc}{fmm\+\_\+m2m\+\_\+rotation\+\_\+work}} (c, src\+\_\+r, dst\+\_\+r, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+m, work)
\begin{DoxyCompactList}\small\item\em Direct M2M translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a0f1934ed9e1bb6f70d2b07e0000337b9}{fmm\+\_\+m2m\+\_\+bessel\+\_\+rotation}} (c, src\+\_\+r, dst\+\_\+r, kappa, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+m)
\begin{DoxyCompactList}\small\item\em Direct M2M translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a9f062fa6ce8602b23ee7ad4dba325fc5}{fmm\+\_\+m2m\+\_\+bessel\+\_\+rotation\+\_\+work}} (c, src\+\_\+sk, dst\+\_\+sk, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+m, work, work\+\_\+complex)
\begin{DoxyCompactList}\small\item\em Direct M2M translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_aba7f517fdb4f2c6d19605d22e961bd8a}{fmm\+\_\+m2m\+\_\+bessel\+\_\+rotation\+\_\+adj}} (c, src\+\_\+r, dst\+\_\+r, kappa, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+m)
\begin{DoxyCompactList}\small\item\em Direct M2M translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a9ce78f5c64aa0138b672a8fc0d86a43f}{fmm\+\_\+m2m\+\_\+bessel\+\_\+rotation\+\_\+adj\+\_\+work}} (c, src\+\_\+sk, dst\+\_\+sk, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+m, work, work\+\_\+complex)
\begin{DoxyCompactList}\small\item\em Direct M2M translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_afd618bb64bfc86a7e3d6e30b846e8827}{fmm\+\_\+m2m\+\_\+rotation\+\_\+adj}} (c, src\+\_\+r, dst\+\_\+r, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+m)
\begin{DoxyCompactList}\small\item\em Adjoint M2M translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_aeb0fff99d95226ac55100e7bea5e54c3}{fmm\+\_\+m2m\+\_\+rotation\+\_\+adj\+\_\+work}} (c, src\+\_\+r, dst\+\_\+r, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+m, work)
\begin{DoxyCompactList}\small\item\em Adjoint M2M translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_ab1fae9f9bc5a93546b030c8d3cb6e440}{fmm\+\_\+m2m\+\_\+bessel\+\_\+grad}} (p, sph\+\_\+sk, vscales, vcnk, sph\+\_\+m, sph\+\_\+m\+\_\+grad)
\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_aad9703d05e792d36a570785d86462a54}{fmm\+\_\+l2l\+\_\+ztranslate}} (z, src\+\_\+r, dst\+\_\+r, p, vscales, vfact, alpha, src\+\_\+l, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Direct L2L translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a4570fcbdae57e94800ae108a5e7d0156}{fmm\+\_\+l2l\+\_\+ztranslate\+\_\+work}} (z, src\+\_\+r, dst\+\_\+r, p, vscales, vfact, alpha, src\+\_\+l, beta, dst\+\_\+l, work)
\begin{DoxyCompactList}\small\item\em Direct L2L translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_afc3069b525010879766feae650c66ad3}{fmm\+\_\+l2l\+\_\+bessel\+\_\+ztranslate}} (z, src\+\_\+si, dst\+\_\+si, p, vscales, vcnk, alpha, src\+\_\+l, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Direct M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_af70cd42161512b6731ecb44991fa436f}{fmm\+\_\+l2l\+\_\+bessel\+\_\+ztranslate\+\_\+work}} (z, src\+\_\+si, dst\+\_\+si, p, vscales, vcnk, alpha, src\+\_\+l, beta, dst\+\_\+l, work, work\+\_\+complex)
\begin{DoxyCompactList}\small\item\em Direct M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a1dac37da23b9a63fd737d7992c030196}{fmm\+\_\+l2l\+\_\+bessel\+\_\+ztranslate\+\_\+adj}} (z, src\+\_\+si, dst\+\_\+si, p, vscales, vcnk, alpha, src\+\_\+l, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Direct M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a3cec3838169439c25bdca5fc932eda11}{fmm\+\_\+l2l\+\_\+bessel\+\_\+ztranslate\+\_\+adj\+\_\+work}} (z, src\+\_\+si, dst\+\_\+si, p, vscales, vcnk, alpha, src\+\_\+l, beta, dst\+\_\+l, work, work\+\_\+complex)
\begin{DoxyCompactList}\small\item\em Direct M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_ab85718cf83cde425ec2829524a4e86f0}{fmm\+\_\+l2l\+\_\+bessel\+\_\+derivative\+\_\+ztranslate\+\_\+work}} (src\+\_\+si, p, vscales, vcnk, alpha, src\+\_\+l, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Direct M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a5c7d13c5cf136657b7444c1d837fab4b}{fmm\+\_\+l2l\+\_\+ztranslate\+\_\+adj}} (z, src\+\_\+r, dst\+\_\+r, p, vscales, vfact, alpha, src\+\_\+l, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Adjoint L2L translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a9c62cbb1ed23a853d4e7b41d6ddcdf02}{fmm\+\_\+l2l\+\_\+ztranslate\+\_\+adj\+\_\+work}} (z, src\+\_\+r, dst\+\_\+r, p, vscales, vfact, alpha, src\+\_\+l, beta, dst\+\_\+l, work)
\begin{DoxyCompactList}\small\item\em Adjoint L2L translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a37a718dad667bceccf0b7daac26a0e8c}{fmm\+\_\+l2l\+\_\+scale}} (src\+\_\+r, dst\+\_\+r, p, alpha, src\+\_\+l, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Scale L2L, when spherical harmonics are centered in the same point. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a085ce4ed5dc41ee929792e75d6c89c8a}{fmm\+\_\+l2l\+\_\+scale\+\_\+adj}} (src\+\_\+r, dst\+\_\+r, p, alpha, src\+\_\+l, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Adjoint scale L2L, when spherical harmonics are centered in the same point. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a8a048c26fd101b7f9bac1a0ff0a24905}{fmm\+\_\+l2l\+\_\+rotation}} (c, src\+\_\+r, dst\+\_\+r, p, vscales, vfact, alpha, src\+\_\+l, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Direct L2L translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a75cdc5b6aeb95fdfaa88ae0e0834092f}{fmm\+\_\+l2l\+\_\+rotation\+\_\+work}} (c, src\+\_\+r, dst\+\_\+r, p, vscales, vfact, alpha, src\+\_\+l, beta, dst\+\_\+l, work)
\begin{DoxyCompactList}\small\item\em Direct L2L translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a2470673bf995bdc825636dc134ccbb8a}{fmm\+\_\+l2l\+\_\+bessel\+\_\+rotation}} (c, src\+\_\+r, dst\+\_\+r, kappa, p, vscales, vcnk, alpha, src\+\_\+l, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Direct L2L translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a2284e6d544d983d0ac935f0ec642d3b1}{fmm\+\_\+l2l\+\_\+bessel\+\_\+rotation\+\_\+work}} (c, src\+\_\+si, dst\+\_\+si, p, vscales, vcnk, alpha, src\+\_\+l, beta, dst\+\_\+l, work, work\+\_\+complex)
\begin{DoxyCompactList}\small\item\em Direct L2L translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a43a12c1e6baf98f39499317b71978ea1}{fmm\+\_\+l2l\+\_\+bessel\+\_\+rotation\+\_\+adj}} (c, src\+\_\+r, dst\+\_\+r, kappa, p, vscales, vcnk, alpha, src\+\_\+l, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Direct L2L translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a5c75d37d1e2bcc0897cdac02b45c7bca}{fmm\+\_\+l2l\+\_\+bessel\+\_\+rotation\+\_\+adj\+\_\+work}} (c, src\+\_\+si, dst\+\_\+si, p, vscales, vcnk, alpha, src\+\_\+l, beta, dst\+\_\+l, work, work\+\_\+complex)
\begin{DoxyCompactList}\small\item\em Direct L2L translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a555d92f202b8c23bf09b53248b4ea6db}{fmm\+\_\+l2l\+\_\+bessel\+\_\+grad}} (p, sph\+\_\+si, vscales, vcnk, sph\+\_\+l, sph\+\_\+l\+\_\+grad)
\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a2e78bfce1b61689ffc4bbae65033273c}{fmm\+\_\+l2l\+\_\+rotation\+\_\+adj}} (c, src\+\_\+r, dst\+\_\+r, p, vscales, vfact, alpha, src\+\_\+l, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Adjoint L2L translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a9dc2a4fa345b7c780c54cecccb88d5a7}{fmm\+\_\+l2l\+\_\+rotation\+\_\+adj\+\_\+work}} (c, src\+\_\+r, dst\+\_\+r, p, vscales, vfact, alpha, src\+\_\+l, beta, dst\+\_\+l, work)
\begin{DoxyCompactList}\small\item\em Adjoint L2L translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a302db88f5061b12f7486d0b97cc3e097}{fmm\+\_\+m2l\+\_\+ztranslate}} (z, src\+\_\+r, dst\+\_\+r, pm, pl, vscales, m2l\+\_\+ztranslate\+\_\+coef, alpha, src\+\_\+m, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Direct M2L translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a77d42c058d06892d3b7fca4be94fe7aa}{fmm\+\_\+m2l\+\_\+ztranslate\+\_\+work}} (z, src\+\_\+r, dst\+\_\+r, pm, pl, vscales, m2l\+\_\+ztranslate\+\_\+coef, alpha, src\+\_\+m, beta, dst\+\_\+l, work)
\begin{DoxyCompactList}\small\item\em Direct M2L translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_aeae1744438b52f07e7a42f549c610d32}{fmm\+\_\+m2l\+\_\+ztranslate\+\_\+adj}} (z, src\+\_\+r, dst\+\_\+r, pl, pm, vscales, m2l\+\_\+ztranslate\+\_\+adj\+\_\+coef, alpha, src\+\_\+l, beta, dst\+\_\+m)
\begin{DoxyCompactList}\small\item\em Adjoint M2L translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a3cd0d97cf18e84aa23c13847a3977fb3}{fmm\+\_\+m2l\+\_\+ztranslate\+\_\+adj\+\_\+work}} (z, src\+\_\+r, dst\+\_\+r, pl, pm, vscales, m2l\+\_\+ztranslate\+\_\+adj\+\_\+coef, alpha, src\+\_\+l, beta, dst\+\_\+m, work)
\begin{DoxyCompactList}\small\item\em Adjoint M2L translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a0d2be15addfeb062073b61d5fd239912}{fmm\+\_\+m2l\+\_\+rotation}} (c, src\+\_\+r, dst\+\_\+r, pm, pl, vscales, m2l\+\_\+ztranslate\+\_\+coef, alpha, src\+\_\+m, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Direct M2L translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a9626682b922d5e507f037548eb3d2355}{fmm\+\_\+m2l\+\_\+rotation\+\_\+work}} (c, src\+\_\+r, dst\+\_\+r, pm, pl, vscales, m2l\+\_\+ztranslate\+\_\+coef, alpha, src\+\_\+m, beta, dst\+\_\+l, work)
\begin{DoxyCompactList}\small\item\em Direct M2L translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_af04110484cace6e9cefcad3acd7ece66}{fmm\+\_\+m2l\+\_\+bessel\+\_\+rotation}} (c, src\+\_\+r, dst\+\_\+r, kappa, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Direct M2M translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_aa3c333c44623a5c713b14239f77c21be}{fmm\+\_\+m2l\+\_\+bessel\+\_\+rotation\+\_\+work}} (c, src\+\_\+sk, dst\+\_\+si, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+l, work, work\+\_\+complex)
\begin{DoxyCompactList}\small\item\em Direct M2M translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a44beda4f2d48ac451449357076a3ff89}{fmm\+\_\+m2l\+\_\+bessel\+\_\+rotation\+\_\+adj}} (c, src\+\_\+r, dst\+\_\+r, kappa, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Direct M2M translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a77326a39f2e6eec60040792e7ab41466}{fmm\+\_\+m2l\+\_\+bessel\+\_\+rotation\+\_\+adj\+\_\+work}} (c, src\+\_\+sk, dst\+\_\+si, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+l, work, work\+\_\+complex)
\begin{DoxyCompactList}\small\item\em Direct M2M translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a1bae2fb9a4287cfa93178ec5ba4db9f5}{fmm\+\_\+m2l\+\_\+bessel\+\_\+ztranslate}} (z, src\+\_\+sk, dst\+\_\+si, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Direct M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_aca682ec8e6ddee561d69d864ad8bc14e}{fmm\+\_\+m2l\+\_\+bessel\+\_\+ztranslate\+\_\+work}} (z, src\+\_\+sk, dst\+\_\+si, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+l, work, work\+\_\+complex)
\begin{DoxyCompactList}\small\item\em Direct M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_af59ef6901ffb4383d0959de10fd8926f}{fmm\+\_\+m2l\+\_\+bessel\+\_\+ztranslate\+\_\+adj}} (z, src\+\_\+sk, dst\+\_\+si, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+l)
\begin{DoxyCompactList}\small\item\em Direct M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a933d14fb3c323d01a2706c25eed8869e}{fmm\+\_\+m2l\+\_\+bessel\+\_\+ztranslate\+\_\+adj\+\_\+work}} (z, src\+\_\+sk, dst\+\_\+si, p, vscales, vcnk, alpha, src\+\_\+m, beta, dst\+\_\+l, work, work\+\_\+complex)
\begin{DoxyCompactList}\small\item\em Direct M2M translation over OZ axis. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_a8cfe4104aac6bb08df2fa15d2df2ba1a}{fmm\+\_\+m2l\+\_\+rotation\+\_\+adj}} (c, src\+\_\+r, dst\+\_\+r, pl, pm, vscales, m2l\+\_\+ztranslate\+\_\+adj\+\_\+coef, alpha, src\+\_\+l, beta, dst\+\_\+m)
\begin{DoxyCompactList}\small\item\em Adjoint M2L translation by 4 rotations and 1 translation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__harmonics_abbb798594959e90b6d60588e88a7a12e}{fmm\+\_\+m2l\+\_\+rotation\+\_\+adj\+\_\+work}} (c, src\+\_\+r, dst\+\_\+r, pl, pm, vscales, m2l\+\_\+ztranslate\+\_\+adj\+\_\+coef, alpha, src\+\_\+l, beta, dst\+\_\+m, work)
\begin{DoxyCompactList}\small\item\em Adjoint M2L translation by 4 rotations and 1 translation. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Harmonics-\/related core routines. 

\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespaceddx__harmonics_a00c5ff3e46e5eb64eba38eee2b5f0751}\label{namespaceddx__harmonics_a00c5ff3e46e5eb64eba38eee2b5f0751}} 
\index{ddx\_harmonics@{ddx\_harmonics}!ylmscale@{ylmscale}}
\index{ylmscale@{ylmscale}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{ylmscale()}{ylmscale()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::ylmscale (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(out)}]{vscales,  }\item[{real(dp), dimension(p+1), intent(out)}]{v4pi2lp1,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(out)}]{vscales\+\_\+rel }\end{DoxyParamCaption})}



Compute scaling factors of real normalized spherical harmonics. 

Output values of scaling factors of $ Y_\ell^m $ harmonics are filled only for non-\/negative $ m $ since scaling factor of $ Y_\ell^{-m} $ is the same as scaling factor of $ Y_\ell^m $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics. {\ttfamily p} \texorpdfstring{$>$}{>}= 0 \\
\hline
\mbox{\texttt{ out}}  & {\em vscales} & Array of scaling factors. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ out}}  & {\em vscales} & Array of values 4pi/(2l+1). Dimension is {\ttfamily p+1} \\
\hline
\mbox{\texttt{ out}}  & {\em vscales\+\_\+rel} & Array of relative scaling factors. Dimension is {\ttfamily (p+1)$\ast$$\ast$2}. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l00037}{37}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_ad9d821757cc745908129ffb88fe2678b}\label{namespaceddx__harmonics_ad9d821757cc745908129ffb88fe2678b}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_constants@{fmm\_constants}}
\index{fmm\_constants@{fmm\_constants}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_constants()}{fmm\_constants()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+constants (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{dmax,  }\item[{integer, intent(in)}]{pm,  }\item[{integer, intent(in)}]{pl,  }\item[{real(dp), dimension((2$\ast$dmax+1)$\ast$(dmax+1)), intent(out)}]{vcnk,  }\item[{real(dp), dimension(pm+1, pl+1, pl+1), intent(out)}]{m2l\+\_\+ztranslate\+\_\+coef,  }\item[{real(dp), dimension(pl+1, pl+1, pm+1), intent(out)}]{m2l\+\_\+ztranslate\+\_\+adj\+\_\+coef }\end{DoxyParamCaption})}



Compute FMM-\/related constants. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em dmax} & Maximal degree of spherical harmonics to be evaluated. {\ttfamily dmax} \texorpdfstring{$>$}{>}= 0 \\
\hline
\mbox{\texttt{ in}}  & {\em pm} & Maximal degree of the multipole expansion. {\ttfamily pm} \texorpdfstring{$>$}{>}= 0. \\
\hline
\mbox{\texttt{ in}}  & {\em pl} & Maximal degree of the local expansion. {\ttfamily pl} \texorpdfstring{$>$}{>}= 0. \\
\hline
\mbox{\texttt{ out}}  & {\em vcnk} & Array of squre roots of combinatorial factors C\+\_\+n$^\wedge$k. Dimension is {\ttfamily (2$\ast$dmax+1)$\ast$(dmax+1)}. \\
\hline
\mbox{\texttt{ out}}  & {\em m2l\+\_\+ztranslate\+\_\+coef} & Constants for M2L translation over OZ axis. Dimension is {\ttfamily (pm+1, pl+1, pl+1)}. \\
\hline
\mbox{\texttt{ out}}  & {\em m2l\+\_\+ztranslate\+\_\+coef} & Constants for adjoint M2L translation over OZ axis. Dimension is {\ttfamily (pl+1, pl+1, pm+1)}. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l00080}{80}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a6c3357a53655c62372199bab90444412}\label{namespaceddx__harmonics_a6c3357a53655c62372199bab90444412}} 
\index{ddx\_harmonics@{ddx\_harmonics}!carttosph@{carttosph}}
\index{carttosph@{carttosph}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{carttosph()}{carttosph()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::carttosph (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{x,  }\item[{real(dp), intent(out)}]{rho,  }\item[{real(dp), intent(out)}]{ctheta,  }\item[{real(dp), intent(out)}]{stheta,  }\item[{real(dp), intent(out)}]{cphi,  }\item[{real(dp), intent(out)}]{sphi }\end{DoxyParamCaption})}



Convert input cartesian coordinate into spherical coordinate. 

Output coordinate $ (\rho, \theta, \phi) $ is presented by $ (\rho,
 \cos \theta, \sin \theta, \cos \phi, \sin\phi) $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em x} & Cartesian coordinate \\
\hline
\mbox{\texttt{ out}}  & {\em rho} & $ \rho $ \\
\hline
\mbox{\texttt{ out}}  & {\em ctheta} & $ \cos \theta $ \\
\hline
\mbox{\texttt{ out}}  & {\em stheta} & $ \sin \theta $ \\
\hline
\mbox{\texttt{ out}}  & {\em cphi} & $ \cos \phi $ \\
\hline
\mbox{\texttt{ out}}  & {\em sphi} & $ \sin \phi $ \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l00142}{142}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a74a0d8fb15d594b39e7f4872d79846e0}\label{namespaceddx__harmonics_a74a0d8fb15d594b39e7f4872d79846e0}} 
\index{ddx\_harmonics@{ddx\_harmonics}!ylmbas@{ylmbas}}
\index{ylmbas@{ylmbas}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{ylmbas()}{ylmbas()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::ylmbas (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{x,  }\item[{real(dp), intent(out)}]{rho,  }\item[{real(dp), intent(out)}]{ctheta,  }\item[{real(dp), intent(out)}]{stheta,  }\item[{real(dp), intent(out)}]{cphi,  }\item[{real(dp), intent(out)}]{sphi,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(in)}]{vscales,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(out)}]{vylm,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(out)}]{vplm,  }\item[{real(dp), dimension(p+1), intent(out)}]{vcos,  }\item[{real(dp), dimension(p+1), intent(out)}]{vsin }\end{DoxyParamCaption})}



Compute all spherical harmonics up to a given degree at a given point. 

Spherical harmonics are computed for a point $ x / \|x\| $. Cartesian coordinate of input {\ttfamily x} is translated into a spherical coordinate $ (\rho,
 \theta, \phi) $ that is represented by $ \rho, \cos \theta, \sin \theta,
 \cos \phi $ and $ \sin \phi $. If $ \rho=0 $ nothing is computed, only zero $ \rho $ is returned without doing anything else. If $
 \rho>0 $ values $ \cos \theta $ and $ \sin \theta $ are computed. If $ \sin \theta \ne 0 $ then $ \cos \phi $ and $ \sin \phi $ are computed. Auxiliary values of associated Legendre polynomials $ P_\ell^m(\theta) $ are computed along with $ \cos (m \phi) $ and $ \sin(m \phi) $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em x} & Target point \\
\hline
\mbox{\texttt{ out}}  & {\em rho} & Euclidian length of {\ttfamily x} \\
\hline
\mbox{\texttt{ out}}  & {\em ctheta} & $ -1 \leq \cos \theta \leq 1$ \\
\hline
\mbox{\texttt{ out}}  & {\em stheta} & $ 0 \leq \sin \theta \leq 1$ \\
\hline
\mbox{\texttt{ out}}  & {\em cphi} & $ -1 \leq \cos \phi \leq 1$ \\
\hline
\mbox{\texttt{ out}}  & {\em sphi} & $ -1 \leq \sin \phi \leq 1$ \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics. {\ttfamily p} \texorpdfstring{$>$}{>}= 0 \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Scaling factors of real normalized spherical harmonics. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ out}}  & {\em vylm} & Values of spherical harmonics $ Y_\ell^m(x) $. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ out}}  & {\em vplm} & Values of associated Legendre polynomials $ P_\ell^m(
      \theta) $. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ out}}  & {\em vcos} & Array of alues of $ \cos(m\phi) $ of a dimension {\ttfamily (p+1)} \\
\hline
\mbox{\texttt{ out}}  & {\em vsin} & array of values of $ \sin(m\phi) $ of a dimension {\ttfamily (p+1)} \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l00214}{214}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a66b4e8bee63238c5c1c3f7a4210c8dd4}\label{namespaceddx__harmonics_a66b4e8bee63238c5c1c3f7a4210c8dd4}} 
\index{ddx\_harmonics@{ddx\_harmonics}!trgev@{trgev}}
\index{trgev@{trgev}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{trgev()}{trgev()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::trgev (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{cphi,  }\item[{real(dp), intent(in)}]{sphi,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension(p+1), intent(out)}]{vcos,  }\item[{real(dp), dimension(p+1), intent(out)}]{vsin }\end{DoxyParamCaption})}



Compute arrays of $ \cos(m \phi) $ and $ \sin(m \phi) $. 

All values are computed recurrently from input $ \cos(\phi) $ and $
 \sin(\phi) $ without accessing arccos or arcsin functions.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em cphi} & $ \cos(\phi) $. -\/1 \texorpdfstring{$<$}{<}= {\ttfamily cphi} \texorpdfstring{$<$}{<}= 1 \\
\hline
\mbox{\texttt{ in}}  & {\em sphi} & $ \sin(\phi) $. -\/1 \texorpdfstring{$<$}{<}= {\ttfamily sphi} \texorpdfstring{$<$}{<}= 1 \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal value of $ m $, for which to compute $ \cos(m
      \phi) $ and $ \sin(m\phi) $. {\ttfamily p} \texorpdfstring{$>$}{>}= 0 \\
\hline
\mbox{\texttt{ out}}  & {\em vcos} & Array of $ \cos(m\phi) $ for $ m=0..p $. Dimension is {\ttfamily (p+1)} \\
\hline
\mbox{\texttt{ out}}  & {\em vsin} & Array of $ \sin(m\phi) $ for $ m=0..p $. Dimension is {\ttfamily (p+1)} \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l00348}{348}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a7fcf9715c6a0d3dd5c291cafffaa5d1f}\label{namespaceddx__harmonics_a7fcf9715c6a0d3dd5c291cafffaa5d1f}} 
\index{ddx\_harmonics@{ddx\_harmonics}!polleg@{polleg}}
\index{polleg@{polleg}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{polleg()}{polleg()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::polleg (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{ctheta,  }\item[{real(dp), intent(in)}]{stheta,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(out)}]{vplm }\end{DoxyParamCaption})}



Compute associated Legendre polynomials. 

Only polynomials $ P_\ell^m (\cos \theta) $ with non-\/negative parameter $ m $ are computed. Implemented via following recurrent formulas\+: \begin{align}
      &P_0^0(\cos \theta) = 1\\
      &P_{m+1}^{m+1}(\cos \theta) = -(2m+1) \sin \theta P_m^m(\cos \theta) \\
      &P_{m+1}^m(\cos \theta) = \cos \theta (2m+1) P_m^m(\cos \theta) \\
      &P_\ell^m(\cos \theta) = \frac{1}{\ell-m} \left( \cos \theta (2\ell-1)
      P_{\ell-1}^m(\cos \theta) - (\ell+m-1)P_{\ell-2}^m(\cos \theta)
      \right), \quad \forall \ell \geq m+2.
 \end{align}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ctheta} & $ \cos(\theta) $. -\/1 \texorpdfstring{$<$}{<}= {\ttfamily ctheta} \texorpdfstring{$<$}{<}= 1 \\
\hline
\mbox{\texttt{ in}}  & {\em stheta} & $ \sin(\theta) $. 0 \texorpdfstring{$<$}{<}= {\ttfamily stheta} \texorpdfstring{$<$}{<}= 1 \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of polynomials to compute. {\ttfamily p} \texorpdfstring{$>$}{>}= 0 \\
\hline
\mbox{\texttt{ out}}  & {\em vplm} & Values of associated Legendre polynomials. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l00452}{452}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a43b882cf0333a0ee0bf062501a03ff01}\label{namespaceddx__harmonics_a43b882cf0333a0ee0bf062501a03ff01}} 
\index{ddx\_harmonics@{ddx\_harmonics}!polleg\_work@{polleg\_work}}
\index{polleg\_work@{polleg\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{polleg\_work()}{polleg\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::polleg\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{ctheta,  }\item[{real(dp), intent(in)}]{stheta,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(out)}]{vplm,  }\item[{real(dp), dimension(p+1), intent(out)}]{work }\end{DoxyParamCaption})}



Compute associated Legendre polynomials. 

Only polynomials $ P_\ell^m (\cos \theta) $ with non-\/negative parameter $ m $ are computed. Implemented via following recurrent formulas\+: \begin{align}
      &P_0^0(\cos \theta) = 1\\
      &P_{m+1}^{m+1}(\cos \theta) = -(2m+1) \sin \theta P_m^m(\cos \theta) \\
      &P_{m+1}^m(\cos \theta) = \cos \theta (2m+1) P_m^m(\cos \theta) \\
      &P_\ell^m(\cos \theta) = \frac{1}{\ell-m} \left( \cos \theta (2\ell-1)
      P_{\ell-1}^m(\cos \theta) - (\ell+m-1)P_{\ell-2}^m(\cos \theta)
      \right), \quad \forall \ell \geq m+2.
 \end{align}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ctheta} & $ \cos(\theta) $. -\/1 \texorpdfstring{$<$}{<}= {\ttfamily ctheta} \texorpdfstring{$<$}{<}= 1 \\
\hline
\mbox{\texttt{ in}}  & {\em stheta} & $ \sin(\theta) $. 0 \texorpdfstring{$<$}{<}= {\ttfamily stheta} \texorpdfstring{$<$}{<}= 1 \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of polynomials to compute. {\ttfamily p} \texorpdfstring{$>$}{>}= 0 \\
\hline
\mbox{\texttt{ out}}  & {\em vplm} & Values of associated Legendre polynomials. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l00482}{482}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_ae7991df8ed4f43aaeec35deb5188137f}\label{namespaceddx__harmonics_ae7991df8ed4f43aaeec35deb5188137f}} 
\index{ddx\_harmonics@{ddx\_harmonics}!modified\_spherical\_bessel\_first\_kind@{modified\_spherical\_bessel\_first\_kind}}
\index{modified\_spherical\_bessel\_first\_kind@{modified\_spherical\_bessel\_first\_kind}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{modified\_spherical\_bessel\_first\_kind()}{modified\_spherical\_bessel\_first\_kind()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::modified\+\_\+spherical\+\_\+bessel\+\_\+first\+\_\+kind (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{lmax,  }\item[{real(dp), intent(in)}]{argument,  }\item[{real(dp), dimension(0\+:lmax), intent(out)}]{SI,  }\item[{real(dp), dimension(0\+:lmax), intent(out)}]{DI,  }\item[{complex(dp), dimension(0\+:max(1, lmax)), intent(out)}]{work }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l00571}{571}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_aba0c8255393d72079731e92441751673}\label{namespaceddx__harmonics_aba0c8255393d72079731e92441751673}} 
\index{ddx\_harmonics@{ddx\_harmonics}!modified\_spherical\_bessel\_second\_kind@{modified\_spherical\_bessel\_second\_kind}}
\index{modified\_spherical\_bessel\_second\_kind@{modified\_spherical\_bessel\_second\_kind}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{modified\_spherical\_bessel\_second\_kind()}{modified\_spherical\_bessel\_second\_kind()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::modified\+\_\+spherical\+\_\+bessel\+\_\+second\+\_\+kind (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{lmax,  }\item[{real(dp), intent(in)}]{argument,  }\item[{real(dp), dimension(0\+:lmax), intent(out)}]{SK,  }\item[{real(dp), dimension(0\+:lmax), intent(out)}]{DK,  }\item[{complex(dp), dimension(0\+:max(1, lmax)), intent(out)}]{work }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l00634}{634}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a4c2f0791982b1533d68d0b245e33f28d}\label{namespaceddx__harmonics_a4c2f0791982b1533d68d0b245e33f28d}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_p2m@{fmm\_p2m}}
\index{fmm\_p2m@{fmm\_p2m}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_p2m()}{fmm\_p2m()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+p2m (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+q,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(in)}]{vscales,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(inout)}]{dst\+\_\+m }\end{DoxyParamCaption})}



Accumulate a multipole expansion induced by a particle of a given charge. 

Computes the following sums\+: \[
      \forall \ell=0, \ldots, p, \quad \forall m=-\ell, \ldots, \ell : \quad
      M_\ell^m = \beta M_\ell^m + \frac{q \|c\|^\ell}{r^{\ell+1}}
      Y_\ell^m \left( \frac{c}{\|c\|} \right),
 \] where $ M $ is a vector of coefficients of output harmonics of a degree up to $ p $ inclusively with a convergence radius $ r $ located at the origin, $ \beta $ is a scaling factor, $ q $ and $
 c $ are a charge and coordinates of a particle.

Based on normalized real spherical harmonics $ Y_\ell^m $, scaled by $
 r^{\ell+1} $. It means corresponding coefficients are simply scaled by an additional factor $ r^{-\ell-1} $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from the particle to the center of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+q} & Charge of the source particle \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of output multipole spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of output multipole spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scaling factor for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Multipole coefficients\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{namespaceddx__harmonics_abd5b67dd330ca6cd8d978cbc917839fd}{fmm\+\_\+m2p}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l00709}{709}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_ae1cc4ca98a66bc491b377766715cdb59}\label{namespaceddx__harmonics_ae1cc4ca98a66bc491b377766715cdb59}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_p2m\_work@{fmm\_p2m\_work}}
\index{fmm\_p2m\_work@{fmm\_p2m\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_p2m\_work()}{fmm\_p2m\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+p2m\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+q,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(in)}]{vscales,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(inout)}]{dst\+\_\+m,  }\item[{real(dp), dimension(2$\ast$(p+1)$\ast$(p+2)), intent(out), target}]{work }\end{DoxyParamCaption})}



Accumulate a multipole expansion induced by a particle of a given charge. 

Computes the following sums\+: \[
      \forall \ell=0, \ldots, p, \quad \forall m=-\ell, \ldots, \ell : \quad
      M_\ell^m = \beta M_\ell^m + \frac{q \|c\|^\ell}{r^{\ell+1}}
      Y_\ell^m \left( \frac{c}{\|c\|} \right),
 \] where $ M $ is a vector of coefficients of output harmonics of a degree up to $ p $ inclusively with a convergence radius $ r $ located at the origin, $ \beta $ is a scaling factor, $ q $ and $
 c $ are a charge and coordinates of a particle.

Based on normalized real spherical harmonics $ Y_\ell^m $, scaled by $
 r^{\ell+1} $. It means corresponding coefficients are simply scaled by an additional factor $ r^{-\ell-1} $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from the particle to the center of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+q} & Charge of the source particle \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of output multipole spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of output multipole spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scaling factor for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Multipole coefficients \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (2$\ast$(p+1)$\ast$(p+2))\\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{namespaceddx__harmonics_abd5b67dd330ca6cd8d978cbc917839fd}{fmm\+\_\+m2p}} 
\end{DoxySeeAlso}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l00748}{748}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_abd5b67dd330ca6cd8d978cbc917839fd}\label{namespaceddx__harmonics_abd5b67dd330ca6cd8d978cbc917839fd}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2p@{fmm\_m2p}}
\index{fmm\_m2p@{fmm\_m2p}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2p()}{fmm\_m2p()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2p (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales\+\_\+rel,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), intent(inout)}]{dst\+\_\+v }\end{DoxyParamCaption})}



Accumulate potential, induced by multipole spherical harmonics. 

Computes the following sum\+: \[
      v = \beta v + \alpha \sum_{\ell=0}^p \frac{4\pi}{\sqrt{2\ell+1}}
      \left( \frac{r}{\|c\|} \right)^{\ell+1} \sum_{m=-\ell}^\ell
      M_\ell^m Y_\ell^m \left( \frac{c}{\|c\|} \right),
 \] where $ M $ is a vector of coefficients of input harmonics of a degree up to $ p $ inclusively with a convergence radius $ r $ located at the origin, $ \alpha $ and $ \beta $ are scaling factors and $ c $ is a location of a particle.

Based on normalized real spherical harmonics $ Y_\ell^m $, scaled by $
 r^{-\ell} $. It means corresponding coefficients are simply scaled by an additional factor $ r^\ell $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Coordinates of a particle (relative to center of harmonics) \\
\hline
\mbox{\texttt{ in}}  & {\em r} & Radius of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of multipole basis functions \\
\hline
\mbox{\texttt{ in}}  & {\em vscales\+\_\+rel} & Relative normalization constants for $ Y_\ell^m $. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Multipole coefficients. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily v} \\
\hline
\mbox{\texttt{ in,out}}  & {\em v} & Value of induced potential \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l00847}{847}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a84bf7c6ebd36d68822a3e81c9d01055f}\label{namespaceddx__harmonics_a84bf7c6ebd36d68822a3e81c9d01055f}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2p\_work@{fmm\_m2p\_work}}
\index{fmm\_m2p\_work@{fmm\_m2p\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2p\_work()}{fmm\_m2p\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2p\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales\+\_\+rel,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), intent(inout)}]{dst\+\_\+v,  }\item[{real(dp), dimension(p+1), intent(out), target}]{work }\end{DoxyParamCaption})}



Accumulate potential, induced by multipole spherical harmonics. 

This function relies on a user-\/provided temporary workspace

Computes the following sum\+: \[
      v = \beta v + \alpha \sum_{\ell=0}^p \frac{4\pi}{\sqrt{2\ell+1}}
      \left( \frac{r}{\|c\|} \right)^{\ell+1} \sum_{m=-\ell}^\ell
      M_\ell^m Y_\ell^m \left( \frac{c}{\|c\|} \right),
 \] where $ M $ is a vector of coefficients of input harmonics of a degree up to $ p $ inclusively with a convergence radius $ r $ located at the origin, $ \alpha $ and $ \beta $ are scaling factors and $ c $ is a location of a particle.

Based on normalized real spherical harmonics $ Y_\ell^m $, scaled by $
 r^{-\ell} $. It means corresponding coefficients are simply scaled by an additional factor $ r^\ell $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Coordinates of a particle (relative to center of harmonics) \\
\hline
\mbox{\texttt{ in}}  & {\em r} & Radius of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of multipole basis functions \\
\hline
\mbox{\texttt{ in}}  & {\em vscales\+\_\+rel} & Relative normalization constants for $ Y_\ell^m $. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Multipole coefficients. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily v} \\
\hline
\mbox{\texttt{ in,out}}  & {\em v} & Value of induced potential \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of size (p+1) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l00890}{890}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_ad316c4006889f94e0626566a4462db49}\label{namespaceddx__harmonics_ad316c4006889f94e0626566a4462db49}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2p\_bessel@{fmm\_m2p\_bessel}}
\index{fmm\_m2p\_bessel@{fmm\_m2p\_bessel}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2p\_bessel()}{fmm\_m2p\_bessel()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2p\+\_\+bessel (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), intent(inout)}]{dst\+\_\+v }\end{DoxyParamCaption})}



Accumulate potential, induced by multipole spherical harmonics. 

Computes the following sum\+: \[
      v = \beta v + \alpha \sum_{\ell=0}^p \frac{4\pi}{\sqrt{2\ell+1}}
      \left( \frac{r}{\|c\|} \right)^{\ell+1} \sum_{m=-\ell}^\ell
      M_\ell^m Y_\ell^m \left( \frac{c}{\|c\|} \right),
 \] where $ M $ is a vector of coefficients of input harmonics of a degree up to $ p $ inclusively with a convergence radius $ r $ located at the origin, $ \alpha $ and $ \beta $ are scaling factors and $ c $ is a location of a particle.

Based on normalized real spherical harmonics $ Y_\ell^m $, scaled by $
 r^{-\ell} $. It means corresponding coefficients are simply scaled by an additional factor $ r^\ell $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Coordinates of a particle (relative to center of harmonics) \\
\hline
\mbox{\texttt{ in}}  & {\em r} & Radius of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of multipole basis functions \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for $ Y_\ell^m $. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Multipole coefficients. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily v} \\
\hline
\mbox{\texttt{ in,out}}  & {\em v} & Value of induced potential \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l01085}{1085}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_aeffc8a34f016545c454b733f3fd589c8}\label{namespaceddx__harmonics_aeffc8a34f016545c454b733f3fd589c8}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2p\_bessel\_work@{fmm\_m2p\_bessel\_work}}
\index{fmm\_m2p\_bessel\_work@{fmm\_m2p\_bessel\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2p\_bessel\_work()}{fmm\_m2p\_bessel\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2p\+\_\+bessel\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension(p+1), intent(in)}]{SK\+\_\+ri,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), intent(inout)}]{dst\+\_\+v,  }\item[{complex(dp), dimension(p+1), intent(out)}]{work\+\_\+complex,  }\item[{real(dp), dimension(p+1), intent(out)}]{work }\end{DoxyParamCaption})}



Accumulate Bessel potential, induced by multipole spherical harmonics. 

This function relies on a user-\/provided temporary workspace

Computes the following sum\+: \[
 \] where $ M $ is a vector of coefficients of input harmonics of a degree up to $ p $ inclusively with a convergence radius $ r $ located at the origin, $ \alpha $ and $ \beta $ are scaling factors and $ c $ is a location of a particle.

Based on normalized real spherical harmonics $ Y_\ell^m $, scaled by $
 r^{-\ell} $. It means corresponding coefficients are simply scaled by an additional factor $ r^\ell $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Coordinates of a particle (relative to center of harmonics) \\
\hline
\mbox{\texttt{ in}}  & {\em r} & Radius of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of multipole basis functions \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for $ Y_\ell^m $. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Multipole coefficients. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily v} \\
\hline
\mbox{\texttt{ in,out}}  & {\em v} & Value of induced potential \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of size (p+1) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l01131}{1131}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_ae8021b65b92bb9cd560d4288dc46e109}\label{namespaceddx__harmonics_ae8021b65b92bb9cd560d4288dc46e109}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2p\_bessel\_grad@{fmm\_m2p\_bessel\_grad}}
\index{fmm\_m2p\_bessel\_grad@{fmm\_m2p\_bessel\_grad}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2p\_bessel\_grad()}{fmm\_m2p\_bessel\_grad()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2p\+\_\+bessel\+\_\+grad (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+2)$\ast$(p+2)), intent(in)}]{vscales,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension(3), intent(inout)}]{dst\+\_\+g }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l01317}{1317}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a01fc177160fca45173657a5e7e7d5c67}\label{namespaceddx__harmonics_a01fc177160fca45173657a5e7e7d5c67}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2p\_adj@{fmm\_m2p\_adj}}
\index{fmm\_m2p\_adj@{fmm\_m2p\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2p\_adj()}{fmm\_m2p\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2p\+\_\+adj (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+q,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales\+\_\+rel,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(inout)}]{dst\+\_\+m }\end{DoxyParamCaption})}



Adjoint M2P operation. 

Computes the following sum\+: \[
      v = \beta v + \alpha \sum_{\ell=0}^p \frac{4\pi}{\sqrt{2\ell+1}}
      \left( \frac{r}{\|c\|} \right)^{\ell+1} \sum_{m=-\ell}^\ell
      M_\ell^m Y_\ell^m \left( \frac{c}{\|c\|} \right),
 \] where $ M $ is a vector of coefficients of input harmonics of a degree up to $ p $ inclusively with a convergence radius $ r $ located at the origin, $ \alpha $ and $ \beta $ are scaling factors and $ c $ is a location of a particle.

Based on normalized real spherical harmonics $ Y_\ell^m $, scaled by $
 r^{-\ell} $. It means corresponding coefficients are simply scaled by an additional factor $ r^\ell $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Coordinates of a particle (relative to center of harmonics) \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+q} & Charge of the source particle \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of output multipole spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of multipole basis functions \\
\hline
\mbox{\texttt{ in}}  & {\em vscales\+\_\+rel} & Relative normalization constants for $ Y_\ell^m $. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Multipole coefficients. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l01365}{1365}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a6b5af8fca5bf86b5c643501a079798f2}\label{namespaceddx__harmonics_a6b5af8fca5bf86b5c643501a079798f2}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2p\_adj\_work@{fmm\_m2p\_adj\_work}}
\index{fmm\_m2p\_adj\_work@{fmm\_m2p\_adj\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2p\_adj\_work()}{fmm\_m2p\_adj\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2p\+\_\+adj\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+q,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales\+\_\+rel,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(inout)}]{dst\+\_\+m,  }\item[{real(dp), dimension(p+1), intent(out), target}]{work }\end{DoxyParamCaption})}



Adjoint M2P operation. 

Computes the following sum\+: \[
      v = \beta v + \alpha \sum_{\ell=0}^p \frac{4\pi}{\sqrt{2\ell+1}}
      \left( \frac{r}{\|c\|} \right)^{\ell+1} \sum_{m=-\ell}^\ell
      M_\ell^m Y_\ell^m \left( \frac{c}{\|c\|} \right),
 \] where $ M $ is a vector of coefficients of input harmonics of a degree up to $ p $ inclusively with a convergence radius $ r $ located at the origin, $ \alpha $ and $ \beta $ are scaling factors and $ c $ is a location of a particle.

Based on normalized real spherical harmonics $ Y_\ell^m $, scaled by $
 r^{-\ell} $. It means corresponding coefficients are simply scaled by an additional factor $ r^\ell $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Coordinates of a particle (relative to center of harmonics) \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+q} & Charge of the source particle \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of output multipole spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of multipole basis functions \\
\hline
\mbox{\texttt{ in}}  & {\em vscales\+\_\+rel} & Relative normalization constants for $ Y_\ell^m $. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Multipole coefficients. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size ((p+1)$\ast$(p+1)+3$\ast$p) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l01403}{1403}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a364a597df78940a0e747a853df495682}\label{namespaceddx__harmonics_a364a597df78940a0e747a853df495682}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2p\_bessel\_adj@{fmm\_m2p\_bessel\_adj}}
\index{fmm\_m2p\_bessel\_adj@{fmm\_m2p\_bessel\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2p\_bessel\_adj()}{fmm\_m2p\_bessel\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2p\+\_\+bessel\+\_\+adj (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+q,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{real(dp), intent(in)}]{kappa,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(inout)}]{dst\+\_\+m }\end{DoxyParamCaption})}



Adjoint M2P operation. 

Computes the following sum\+: \[
      v = \beta v + \alpha \sum_{\ell=0}^p \frac{4\pi}{\sqrt{2\ell+1}}
      \left( \frac{r}{\|c\|} \right)^{\ell+1} \sum_{m=-\ell}^\ell
      M_\ell^m Y_\ell^m \left( \frac{c}{\|c\|} \right),
 \] where $ M $ is a vector of coefficients of input harmonics of a degree up to $ p $ inclusively with a convergence radius $ r $ located at the origin, $ \alpha $ and $ \beta $ are scaling factors and $ c $ is a location of a particle.

Based on normalized real spherical harmonics $ Y_\ell^m $, scaled by $
 r^{-\ell} $. It means corresponding coefficients are simply scaled by an additional factor $ r^\ell $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Coordinates of a particle (relative to center of harmonics) \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+q} & Charge of the source particle \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of output multipole spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of multipole basis functions \\
\hline
\mbox{\texttt{ in}}  & {\em vscales\+\_\+rel} & Relative normalization constants for $ Y_\ell^m $. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Multipole coefficients. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l01702}{1702}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a6f93125bb26d1b6b77d351eb7057c216}\label{namespaceddx__harmonics_a6f93125bb26d1b6b77d351eb7057c216}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2p\_bessel\_adj\_work@{fmm\_m2p\_bessel\_adj\_work}}
\index{fmm\_m2p\_bessel\_adj\_work@{fmm\_m2p\_bessel\_adj\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2p\_bessel\_adj\_work()}{fmm\_m2p\_bessel\_adj\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2p\+\_\+bessel\+\_\+adj\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+q,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+sk,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(inout)}]{dst\+\_\+m,  }\item[{complex(dp), dimension(p+1), intent(out)}]{work\+\_\+complex,  }\item[{real(dp), dimension(p+1), intent(out)}]{work }\end{DoxyParamCaption})}



Adjoint M2P operation. 

Computes the following sum\+: \[
      v = \beta v + \alpha \sum_{\ell=0}^p \frac{4\pi}{\sqrt{2\ell+1}}
      \left( \frac{r}{\|c\|} \right)^{\ell+1} \sum_{m=-\ell}^\ell
      M_\ell^m Y_\ell^m \left( \frac{c}{\|c\|} \right),
 \] where $ M $ is a vector of coefficients of input harmonics of a degree up to $ p $ inclusively with a convergence radius $ r $ located at the origin, $ \alpha $ and $ \beta $ are scaling factors and $ c $ is a location of a particle.

Based on normalized real spherical harmonics $ Y_\ell^m $, scaled by $
 r^{-\ell} $. It means corresponding coefficients are simply scaled by an additional factor $ r^\ell $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Coordinates of a particle (relative to center of harmonics) \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+q} & Charge of the source particle \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of output multipole spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of multipole basis functions \\
\hline
\mbox{\texttt{ in}}  & {\em vscales\+\_\+rel} & Relative normalization constants for $ Y_\ell^m $. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Multipole coefficients. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size ((p+1)$\ast$(p+1)+3$\ast$p) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l01748}{1748}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a95f20c5bbb717d6615f9d9b46c40c567}\label{namespaceddx__harmonics_a95f20c5bbb717d6615f9d9b46c40c567}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2p\_mat@{fmm\_m2p\_mat}}
\index{fmm\_m2p\_mat@{fmm\_m2p\_mat}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2p\_mat()}{fmm\_m2p\_mat()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2p\+\_\+mat (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(in)}]{vscales,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(out)}]{mat }\end{DoxyParamCaption})}



Accumulate potentials, induced by each multipole spherical harmonic. 

Computes the following sum\+: \[
      v = \beta v + \alpha \sum_{\ell=0}^p \frac{4\pi}{\sqrt{2\ell+1}}
      \left( \frac{r}{\|c\|} \right)^{\ell+1} \sum_{m=-\ell}^\ell
      M_\ell^m Y_\ell^m \left( \frac{c}{\|c\|} \right),
 \] where $ M $ is a vector of coefficients of input harmonics of a degree up to $ p $ inclusively with a convergence radius $ r $ located at the origin, $ \alpha $ and $ \beta $ are scaling factors and $ c $ is a location of a particle.

Based on normalized real spherical harmonics $ Y_\ell^m $, scaled by $
 r^{-\ell} $. It means corresponding coefficients are simply scaled by an additional factor $ r^\ell $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Coordinates of a particle (relative to center of harmonics) \\
\hline
\mbox{\texttt{ in}}  & {\em r} & Radius of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of multipole basis functions \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for $ Y_\ell^m $. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in,out}}  & {\em mat} & Values of potentials induced by each spherical harmonic \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l02072}{2072}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a3e3bd6455b55865ee1829cd8addaad3c}\label{namespaceddx__harmonics_a3e3bd6455b55865ee1829cd8addaad3c}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2p@{fmm\_l2p}}
\index{fmm\_l2p@{fmm\_l2p}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2p()}{fmm\_l2p()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2p (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), intent(inout)}]{dst\+\_\+v }\end{DoxyParamCaption})}



Accumulate potential, induced by local spherical harmonics. 

Computes the following sum\+: \[
      v = \beta v + \alpha \sum_{\ell=0}^p \frac{4\pi}{\sqrt{2\ell+1}}
      \left( \frac{\|c\|}{r} \right)^\ell \sum_{m=-\ell}^\ell
      L_\ell^m Y_\ell^m \left( \frac{c}{\|c\|} \right),
 \] where $ L $ is a vector of coefficients of input harmonics of a degree up to $ p $ inclusively with a convergence radius $ r $ located at the origin, $ \alpha $ and $ \beta $ are scaling factors and $ c $ is a location of a particle. Based on normalized real spherical harmonics $ Y_\ell^m $, scaled by $
 r^{-\ell} $. It means corresponding coefficients are simply scaled by an additional factor $ r^\ell $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Coordinates of a particle (relative to center of harmonics) \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of local basis functions \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for $ Y_\ell^m $. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+l} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & Local coefficients. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+v} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+v} & Value of induced potential \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l02125}{2125}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_afcb1b1e24d6d54835de05360bedad809}\label{namespaceddx__harmonics_afcb1b1e24d6d54835de05360bedad809}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2p\_work@{fmm\_l2p\_work}}
\index{fmm\_l2p\_work@{fmm\_l2p\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2p\_work()}{fmm\_l2p\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2p\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales\+\_\+rel,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), intent(inout)}]{dst\+\_\+v,  }\item[{real(dp), dimension(p+1), intent(out), target}]{work }\end{DoxyParamCaption})}



Accumulate potential, induced by local spherical harmonics. 

Computes the following sum\+: \[
      v = \beta v + \alpha \sum_{\ell=0}^p \frac{4\pi}{\sqrt{2\ell+1}}
      \left( \frac{\|c\|}{r} \right)^\ell \sum_{m=-\ell}^\ell
      L_\ell^m Y_\ell^m \left( \frac{c}{\|c\|} \right),
 \] where $ L $ is a vector of coefficients of input harmonics of a degree up to $ p $ inclusively with a convergence radius $ r $ located at the origin, $ \alpha $ and $ \beta $ are scaling factors and $ c $ is a location of a particle. Based on normalized real spherical harmonics $ Y_\ell^m $, scaled by $
 r^{-\ell} $. It means corresponding coefficients are simply scaled by an additional factor $ r^\ell $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Coordinates of a particle (relative to center of harmonics) \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of local basis functions \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for $ Y_\ell^m $. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+l} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & Local coefficients. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+v} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+v} & Value of induced potential \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (p+1) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l02164}{2164}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a91f16516ededaf0fc38fe7efc9013e44}\label{namespaceddx__harmonics_a91f16516ededaf0fc38fe7efc9013e44}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2p\_bessel@{fmm\_l2p\_bessel}}
\index{fmm\_l2p\_bessel@{fmm\_l2p\_bessel}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2p\_bessel()}{fmm\_l2p\_bessel()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2p\+\_\+bessel (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), intent(inout)}]{dst\+\_\+v }\end{DoxyParamCaption})}



Accumulate potential, induced by local spherical harmonics. 

Computes the following sum\+: \[
      v = \beta v + \alpha \sum_{\ell=0}^p \frac{4\pi}{\sqrt{2\ell+1}}
      \left( \frac{\|c\|}{r} \right)^\ell \sum_{m=-\ell}^\ell
      L_\ell^m Y_\ell^m \left( \frac{c}{\|c\|} \right),
 \] where $ L $ is a vector of coefficients of input harmonics of a degree up to $ p $ inclusively with a convergence radius $ r $ located at the origin, $ \alpha $ and $ \beta $ are scaling factors and $ c $ is a location of a particle. Based on normalized real spherical harmonics $ Y_\ell^m $, scaled by $
 r^{-\ell} $. It means corresponding coefficients are simply scaled by an additional factor $ r^\ell $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Coordinates of a particle (relative to center of harmonics) \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of local basis functions \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for $ Y_\ell^m $. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+l} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & Local coefficients. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+v} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+v} & Value of induced potential \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l02355}{2355}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_ae9cf6b001f184f2f72b53e1c44adc631}\label{namespaceddx__harmonics_ae9cf6b001f184f2f72b53e1c44adc631}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2p\_bessel\_work@{fmm\_l2p\_bessel\_work}}
\index{fmm\_l2p\_bessel\_work@{fmm\_l2p\_bessel\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2p\_bessel\_work()}{fmm\_l2p\_bessel\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2p\+\_\+bessel\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension(p+1), intent(in)}]{SI\+\_\+ri,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), intent(inout)}]{dst\+\_\+v,  }\item[{complex(dp), dimension(p+1), intent(out)}]{work\+\_\+complex,  }\item[{real(dp), dimension(p+1), intent(out)}]{work }\end{DoxyParamCaption})}



Accumulate Bessel potential, induced by local spherical harmonics. 

This function relies on a user-\/provided temporary workspace

Computes the following sum\+: \[
 \] where $ M $ is a vector of coefficients of input harmonics of a degree up to $ p $ inclusively with a convergence radius $ r $ located at the origin, $ \alpha $ and $ \beta $ are scaling factors and $ c $ is a location of a particle.

Based on normalized real spherical harmonics $ Y_\ell^m $, scaled by $
 r^{-\ell} $. It means corresponding coefficients are simply scaled by an additional factor $ r^\ell $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Coordinates of a particle (relative to center of harmonics) \\
\hline
\mbox{\texttt{ in}}  & {\em r} & Radius of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of local basis functions \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for $ Y_\ell^m $. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+l} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & Local coefficients. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily v} \\
\hline
\mbox{\texttt{ in,out}}  & {\em v} & Value of induced potential \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of size (p+1) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l02400}{2400}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_ad11d8e5937c029d3663550ac1cacb7ab}\label{namespaceddx__harmonics_ad11d8e5937c029d3663550ac1cacb7ab}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2p\_bessel\_grad@{fmm\_l2p\_bessel\_grad}}
\index{fmm\_l2p\_bessel\_grad@{fmm\_l2p\_bessel\_grad}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2p\_bessel\_grad()}{fmm\_l2p\_bessel\_grad()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2p\+\_\+bessel\+\_\+grad (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+2)$\ast$(p+2)), intent(in)}]{vscales,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension(3), intent(inout)}]{dst\+\_\+g }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l02587}{2587}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a467ab49d671143bb6a90e2db8734408c}\label{namespaceddx__harmonics_a467ab49d671143bb6a90e2db8734408c}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2p\_adj@{fmm\_l2p\_adj}}
\index{fmm\_l2p\_adj@{fmm\_l2p\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2p\_adj()}{fmm\_l2p\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2p\+\_\+adj (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+q,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales\+\_\+rel,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Adjoint of L2P. 

Computes the following sum\+: \[
      v = \beta v + \alpha \sum_{\ell=0}^p \frac{4\pi}{\sqrt{2\ell+1}}
      \left( \frac{\|c\|}{r} \right)^\ell \sum_{m=-\ell}^\ell
      L_\ell^m Y_\ell^m \left( \frac{c}{\|c\|} \right),
 \] where $ L $ is a vector of coefficients of input harmonics of a degree up to $ p $ inclusively with a convergence radius $ r $ located at the origin, $ \alpha $ and $ \beta $ are scaling factors and $ c $ is a location of a particle. Based on normalized real spherical harmonics $ Y_\ell^m $, scaled by $
 r^{-\ell} $. It means corresponding coefficients are simply scaled by an additional factor $ r^\ell $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Coordinates of a particle (relative to center of harmonics) \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+q} & Charge of the source particle \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of output local spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of local basis functions \\
\hline
\mbox{\texttt{ in}}  & {\em vscales\+\_\+rel} & Relative normalization constants for $ Y_\ell^m $. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+l} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+l} & Local coefficients. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l02634}{2634}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a02d5736e15ad31da5e0a6b349fdacac1}\label{namespaceddx__harmonics_a02d5736e15ad31da5e0a6b349fdacac1}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2p\_adj\_work@{fmm\_l2p\_adj\_work}}
\index{fmm\_l2p\_adj\_work@{fmm\_l2p\_adj\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2p\_adj\_work()}{fmm\_l2p\_adj\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2p\+\_\+adj\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+q,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales\+\_\+rel,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(inout)}]{dst\+\_\+l,  }\item[{real(dp), dimension(p+1), intent(out), target}]{work }\end{DoxyParamCaption})}



Adjoint L2P. 

Computes the following sum\+: \[
      v = \beta v + \alpha \sum_{\ell=0}^p \frac{4\pi}{\sqrt{2\ell+1}}
      \left( \frac{\|c\|}{r} \right)^\ell \sum_{m=-\ell}^\ell
      L_\ell^m Y_\ell^m \left( \frac{c}{\|c\|} \right),
 \] where $ L $ is a vector of coefficients of input harmonics of a degree up to $ p $ inclusively with a convergence radius $ r $ located at the origin, $ \alpha $ and $ \beta $ are scaling factors and $ c $ is a location of a particle. Based on normalized real spherical harmonics $ Y_\ell^m $, scaled by $
 r^{-\ell} $. It means corresponding coefficients are simply scaled by an additional factor $ r^\ell $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Coordinates of a particle (relative to center of harmonics) \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+q} & Charge of the source particle \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of output local spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of local basis functions \\
\hline
\mbox{\texttt{ in}}  & {\em vscales\+\_\+rel} & Relative normalization constants for $ Y_\ell^m $. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+l} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+l} & Local coefficients. Dimension is {\ttfamily (p+1)$\ast$$\ast$2} \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (p+1) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l02671}{2671}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a8f2ebf0050f757ce65ffe0f5d8bbc654}\label{namespaceddx__harmonics_a8f2ebf0050f757ce65ffe0f5d8bbc654}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_sph\_transform@{fmm\_sph\_transform}}
\index{fmm\_sph\_transform@{fmm\_sph\_transform}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_sph\_transform()}{fmm\_sph\_transform()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+sph\+\_\+transform (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension(-\/1\+:1, -\/1\+:1), intent(in)}]{r1,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst }\end{DoxyParamCaption})}



Transform coefficients of spherical harmonics to a new cartesion system. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha R \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics corresponding to a new cartesion system of coordinates, $
 \mathrm{src} $ is a vector of coefficients of input spherical harmonics corresponding to the standard cartesian system of coordinates and $ R $ is a \textquotesingle{}(p+1)$\ast$$\ast$2\textquotesingle{}-\/by-\/\textquotesingle{}(p+1)$\ast$$\ast$2\textquotesingle{} matrix that transforms coefficients of the source spherical harmonics to the destination spherical harmonics while preserving values of any function on a unit sphere defined as a linear combination of the source spherical harmonics.

Input 3-\/by-\/3 matrix {\ttfamily r1} must be an orthogonal matrix $ R_1 $ of a transform of new cartesion coordinates $ (\widetilde{y}, \widetilde{z},
 \widetilde{x}) $ into initial cartesian coordinates $ (y, z, x) $. This is due to the following equalities\+: \begin{align}
      Y_1^{-1} (\theta, \phi) &= \sqrt{\frac{3}{4\pi}} \sin \theta \sin \phi
      = \sqrt{\frac{3}{4\pi}} y, \\ Y_1^0 (\theta, \phi) &=
      \sqrt{\frac{3}{4\pi}} \cos \theta = \sqrt{\frac{3}{4\pi}} z, \\
      Y_1^1 (\theta, \phi) &= \sqrt{\frac{3}{4\pi}} \sin \theta \cos \phi =
      \sqrt{\frac{3}{4\pi}} x.
 \end{align} So, to find a column-\/vector $ \widetilde{c} $ of coefficients of spherical harmonics $ Y_1^{-1}, Y_1^0 $ and $ Y_1^1 $ in a new system of coordinates $ (\widetilde{y}, \widetilde{z}, \widetilde{x}) $ the following system needs to be solved\+: \[
      \widetilde{c}^\top \cdot \begin{bmatrix} Y_1^{-1}
      (\widetilde{\theta}, \widetilde{\phi}) \\ Y_1^0 (\widetilde{\theta},
      \widetilde{\phi}) \\ Y_1^1 (\widetilde{\theta}, \widetilde{\phi})
      \end{bmatrix} = c ^\top \cdot \begin{bmatrix} Y_1^{-1} (\theta, \phi)
      \\ Y_1^0 (\theta, \phi) \\ Y_1^1 (\theta, \phi) \end{bmatrix}.
 \] The solution has the following obvious form\+: \[
      \widetilde{c} = R_1^\top c.
 \]

Translation of spherical harmonics of all other degrees is computed recursively as is described in the following source\+: {\bfseries [ir-\/realharms-\/1996]} {\bfseries [ir-\/realharms-\/1998]}


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em p} & Maximum degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em r1} & Transformation from new to old cartesian coordinates \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily src} \\
\hline
\mbox{\texttt{ in}}  & {\em src} & Coefficients of initial spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst} & Coefficients of transformed spherical harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l02997}{2997}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_ab643a611d5cbc4b1a035546a01eb9bf5}\label{namespaceddx__harmonics_ab643a611d5cbc4b1a035546a01eb9bf5}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_sph\_transform\_work@{fmm\_sph\_transform\_work}}
\index{fmm\_sph\_transform\_work@{fmm\_sph\_transform\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_sph\_transform\_work()}{fmm\_sph\_transform\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+sph\+\_\+transform\+\_\+work (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension(-\/1\+:1, -\/1\+:1), intent(in)}]{r1,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(out)}]{dst,  }\item[{real(dp), dimension(2$\ast$(2$\ast$p+1)$\ast$(2$\ast$p+3)), intent(out), target}]{work }\end{DoxyParamCaption})}



Transform spherical harmonics to a new cartesion system of coordinates. 

This function implements \mbox{\hyperlink{namespaceddx__harmonics_a8f2ebf0050f757ce65ffe0f5d8bbc654}{fmm\+\_\+sph\+\_\+transform}} with predefined values of parameters {\ttfamily alpha=one} and {\ttfamily beta=zero}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em p} & Maximum degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em r1} & Transformation from new to old cartesian coordinates \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily src} \\
\hline
\mbox{\texttt{ in}}  & {\em src} & Coefficients of initial spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst} & Coefficients of transformed spherical harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (2$\ast$(2$\ast$p+1)$\ast$(2$\ast$p+3)) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l03022}{3022}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a8e16c11fcefb704bfa036827b574989c}\label{namespaceddx__harmonics_a8e16c11fcefb704bfa036827b574989c}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_sph\_rotate\_oz@{fmm\_sph\_rotate\_oz}}
\index{fmm\_sph\_rotate\_oz@{fmm\_sph\_rotate\_oz}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_sph\_rotate\_oz()}{fmm\_sph\_rotate\_oz()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+sph\+\_\+rotate\+\_\+oz (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension(p+1), intent(in)}]{vcos,  }\item[{real(dp), dimension(p+1), intent(in)}]{vsin,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst }\end{DoxyParamCaption})}



Rotate spherical harmonics around OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha R \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics corresponding to a new cartesion system of coordinates, $
 \mathrm{src} $ is a vector of coefficients of input spherical harmonics corresponding to the standard cartesian system of coordinates and $
 R $ is a matrix of rotation of coordinates around OZ axis on angle $
 \phi $, presented by $ \cos(m \phi) $ and $ \sin(m \phi) $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em p} & Maximal order of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcos} & Vector $ \{ \cos(m \phi) \}_{m=0}^p $ \\
\hline
\mbox{\texttt{ in}}  & {\em vsin} & Vector $ \{ \sin(m \phi) \}_{m=0}^p $ \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src} \\
\hline
\mbox{\texttt{ in}}  & {\em src} & Coefficients of initial spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst} & Coefficients of rotated spherical harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l03666}{3666}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_ae7164759454da6c012e9afdf7f0aa156}\label{namespaceddx__harmonics_ae7164759454da6c012e9afdf7f0aa156}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_sph\_rotate\_oz\_work@{fmm\_sph\_rotate\_oz\_work}}
\index{fmm\_sph\_rotate\_oz\_work@{fmm\_sph\_rotate\_oz\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_sph\_rotate\_oz\_work()}{fmm\_sph\_rotate\_oz\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+sph\+\_\+rotate\+\_\+oz\+\_\+work (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension(p+1), intent(in)}]{vcos,  }\item[{real(dp), dimension(p+1), intent(in)}]{vsin,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst }\end{DoxyParamCaption})}



Rotate spherical harmonics around OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha R \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics corresponding to a new cartesion system of coordinates, $
 \mathrm{src} $ is a vector of coefficients of input spherical harmonics corresponding to the standard cartesian system of coordinates and $
 R $ is a matrix of rotation of coordinates around OZ axis on angle $
 \phi $, presented by $ \cos(m \phi) $ and $ \sin(m \phi) $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em p} & Maximal order of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcos} & Vector $ \{ \cos(m \phi) \}_{m=0}^p $ \\
\hline
\mbox{\texttt{ in}}  & {\em vsin} & Vector $ \{ \sin(m \phi) \}_{m=0}^p $ \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src} \\
\hline
\mbox{\texttt{ in}}  & {\em src} & Coefficients of initial spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst} & Coefficients of rotated spherical harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l03697}{3697}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a588c445e8bd85ccb3d81190be6b2901c}\label{namespaceddx__harmonics_a588c445e8bd85ccb3d81190be6b2901c}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_sph\_rotate\_oz\_adj@{fmm\_sph\_rotate\_oz\_adj}}
\index{fmm\_sph\_rotate\_oz\_adj@{fmm\_sph\_rotate\_oz\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_sph\_rotate\_oz\_adj()}{fmm\_sph\_rotate\_oz\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+sph\+\_\+rotate\+\_\+oz\+\_\+adj (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension(p+1), intent(in)}]{vcos,  }\item[{real(dp), dimension(p+1), intent(in)}]{vsin,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst }\end{DoxyParamCaption})}



Rotate spherical harmonics around OZ axis in an opposite direction. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha R \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics corresponding to a new cartesion system of coordinates, $
 \mathrm{src} $ is a vector of coefficients of input spherical harmonics corresponding to the standard cartesian system of coordinates and $
 R $ is a matrix of rotation of coordinates around OZ axis on angle $
 \phi $, presented by $ \cos(m \phi) $ and $ \sin(m \phi) $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em p} & Maximal order of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcos} & Vector $ \{ \cos(m \phi) \}_{m=0}^p $ \\
\hline
\mbox{\texttt{ in}}  & {\em vsin} & Vector $ \{ \sin(m \phi) \}_{m=0}^p $ \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src} \\
\hline
\mbox{\texttt{ in}}  & {\em src} & Coefficients of initial spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst} & Coefficients of rotated spherical harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l03787}{3787}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a6376d4d78d6bcbf83b5747c03f13065c}\label{namespaceddx__harmonics_a6376d4d78d6bcbf83b5747c03f13065c}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_sph\_rotate\_oz\_adj\_work@{fmm\_sph\_rotate\_oz\_adj\_work}}
\index{fmm\_sph\_rotate\_oz\_adj\_work@{fmm\_sph\_rotate\_oz\_adj\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_sph\_rotate\_oz\_adj\_work()}{fmm\_sph\_rotate\_oz\_adj\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+sph\+\_\+rotate\+\_\+oz\+\_\+adj\+\_\+work (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension(p+1), intent(in)}]{vcos,  }\item[{real(dp), dimension(p+1), intent(in)}]{vsin,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst }\end{DoxyParamCaption})}



Rotate spherical harmonics around OZ axis in an opposite direction. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha R \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics corresponding to a new cartesion system of coordinates, $
 \mathrm{src} $ is a vector of coefficients of input spherical harmonics corresponding to the standard cartesian system of coordinates and $
 R $ is a matrix of rotation of coordinates around OZ axis on angle $
 \phi $, presented by $ \cos(m \phi) $ and $ \sin(m \phi) $.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em p} & Maximal order of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcos} & Vector $ \{ \cos(m \phi) \}_{m=0}^p $ \\
\hline
\mbox{\texttt{ in}}  & {\em vsin} & Vector $ \{ \sin(m \phi) \}_{m=0}^p $ \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src} \\
\hline
\mbox{\texttt{ in}}  & {\em src} & Coefficients of initial spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst} & Coefficients of rotated spherical harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l03818}{3818}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a3a330c054807d19fa99aa1bcfec71f9e}\label{namespaceddx__harmonics_a3a330c054807d19fa99aa1bcfec71f9e}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_sph\_rotate\_oxz@{fmm\_sph\_rotate\_oxz}}
\index{fmm\_sph\_rotate\_oxz@{fmm\_sph\_rotate\_oxz}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_sph\_rotate\_oxz()}{fmm\_sph\_rotate\_oxz()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+sph\+\_\+rotate\+\_\+oxz (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{p,  }\item[{real(dp), intent(in)}]{ctheta,  }\item[{real(dp), intent(in)}]{stheta,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(in)}]{src,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(inout)}]{dst }\end{DoxyParamCaption})}



Transform spherical harmonics in the OXZ plane. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha R \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics corresponding to a new cartesion system of coordinates, $
 \mathrm{src} $ is a vector of coefficients of input spherical harmonics corresponding to the standard cartesian system of coordinates and $
 R $ is a matrix of transformation of coordinates in the OXZ plane (y coordinate remains the same) presented by 2-\/by-\/2 matrix {\ttfamily r1xz}.

Based on \mbox{\hyperlink{namespaceddx__harmonics_a8f2ebf0050f757ce65ffe0f5d8bbc654}{fmm\+\_\+sph\+\_\+transform}} by assuming {\ttfamily r1(-\/1, 0) = r1(-\/1, 1) = r1(0, -\/1) = r1(1, -\/1) = 0} and {\ttfamily r1(-\/1, -\/1) = 1}, which corresponds to the following transformation matrix\+: \[
      R_1 = \begin{bmatrix} 1 & 0 & 0 \\ 0 & a & b \\ 0 & c & d
      \end{bmatrix},
 \] where unkown elements represent input {\ttfamily r1xz} 2x2 array\+: \[
      R_1^{xz} = \begin{bmatrix} a & b \\ c & d \end{bmatrix}.
 \]


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em p} & Maximal order of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em r1xz} & Transformation from new to old coordinates in the OXZ plane \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src} \\
\hline
\mbox{\texttt{ in}}  & {\em src} & Coefficients of initial spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst} & Coefficients of transformed spherical harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l03915}{3915}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a1acd3dc4a1f64b2d6639817b160f223d}\label{namespaceddx__harmonics_a1acd3dc4a1f64b2d6639817b160f223d}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_sph\_rotate\_oxz\_work@{fmm\_sph\_rotate\_oxz\_work}}
\index{fmm\_sph\_rotate\_oxz\_work@{fmm\_sph\_rotate\_oxz\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_sph\_rotate\_oxz\_work()}{fmm\_sph\_rotate\_oxz\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+sph\+\_\+rotate\+\_\+oxz\+\_\+work (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{p,  }\item[{real(dp), intent(in)}]{ctheta,  }\item[{real(dp), intent(in)}]{stheta,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(in)}]{src,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(out)}]{dst,  }\item[{real(dp), dimension(4$\ast$p$\ast$p+13$\ast$p+4), intent(out), target}]{work }\end{DoxyParamCaption})}



Transform spherical harmonics in the OXZ plane. 

This function implements \mbox{\hyperlink{namespaceddx__harmonics_a3a330c054807d19fa99aa1bcfec71f9e}{fmm\+\_\+sph\+\_\+rotate\+\_\+oxz}} with predefined values of parameters {\ttfamily alpha=one} and {\ttfamily beta=zero}.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em p} & maximum order of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em r1xz} & 2D transformation matrix in the OXZ plane \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src} \\
\hline
\mbox{\texttt{ in}}  & {\em src} & Coefficients of initial spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst} \\
\hline
\mbox{\texttt{ out}}  & {\em dst} & coefficients of rotated spherical harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (2$\ast$(2$\ast$p+1)$\ast$(2$\ast$p+3)) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l03940}{3940}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a04507f68eafd1a3757afb3958107c895}\label{namespaceddx__harmonics_a04507f68eafd1a3757afb3958107c895}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_ztranslate@{fmm\_m2m\_ztranslate}}
\index{fmm\_m2m\_ztranslate@{fmm\_m2m\_ztranslate}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_ztranslate()}{fmm\_m2m\_ztranslate()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+ztranslate (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m }\end{DoxyParamCaption})}



Direct M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily alpha} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l04224}{4224}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a18f3f31756270f14e4bf398be1f40a4a}\label{namespaceddx__harmonics_a18f3f31756270f14e4bf398be1f40a4a}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_ztranslate\_work@{fmm\_m2m\_ztranslate\_work}}
\index{fmm\_m2m\_ztranslate\_work@{fmm\_m2m\_ztranslate\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_ztranslate\_work()}{fmm\_m2m\_ztranslate\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+ztranslate\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m,  }\item[{real(dp), dimension(2$\ast$(p+1)), intent(out), target}]{work }\end{DoxyParamCaption})}



Direct M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily alpha} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (2$\ast$(p+1)) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l04262}{4262}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a9d80015d1ca2f96afaa655616d754a92}\label{namespaceddx__harmonics_a9d80015d1ca2f96afaa655616d754a92}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_bessel\_ztranslate@{fmm\_m2m\_bessel\_ztranslate}}
\index{fmm\_m2m\_bessel\_ztranslate@{fmm\_m2m\_bessel\_ztranslate}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_bessel\_ztranslate()}{fmm\_m2m\_bessel\_ztranslate()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+bessel\+\_\+ztranslate (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+sk,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+sk,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m }\end{DoxyParamCaption})}



Direct M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily alpha} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l04435}{4435}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_aa92f3d719b3f99cf0cdd523e865c12ca}\label{namespaceddx__harmonics_aa92f3d719b3f99cf0cdd523e865c12ca}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_bessel\_ztranslate\_work@{fmm\_m2m\_bessel\_ztranslate\_work}}
\index{fmm\_m2m\_bessel\_ztranslate\_work@{fmm\_m2m\_bessel\_ztranslate\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_bessel\_ztranslate\_work()}{fmm\_m2m\_bessel\_ztranslate\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+bessel\+\_\+ztranslate\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+sk,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+sk,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m,  }\item[{real(dp), dimension(2$\ast$p+1), intent(out), target}]{work,  }\item[{complex(dp), dimension(2$\ast$p+1), intent(out)}]{work\+\_\+complex }\end{DoxyParamCaption})}



Direct M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from old to new centers of harmonics. Standard FMM M2M operation requires z to be OZ coordinate from new to old. \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily alpha} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (2$\ast$(p+1)) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l04475}{4475}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_aed42c229d4ba1f6e8e08ab7c7d8f51bc}\label{namespaceddx__harmonics_aed42c229d4ba1f6e8e08ab7c7d8f51bc}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_bessel\_ztranslate\_adj@{fmm\_m2m\_bessel\_ztranslate\_adj}}
\index{fmm\_m2m\_bessel\_ztranslate\_adj@{fmm\_m2m\_bessel\_ztranslate\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_bessel\_ztranslate\_adj()}{fmm\_m2m\_bessel\_ztranslate\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+bessel\+\_\+ztranslate\+\_\+adj (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+sk,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+sk,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m }\end{DoxyParamCaption})}



Direct M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily alpha} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l04627}{4627}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a25d206db906fd240782e0f328a320a6e}\label{namespaceddx__harmonics_a25d206db906fd240782e0f328a320a6e}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_bessel\_ztranslate\_adj\_work@{fmm\_m2m\_bessel\_ztranslate\_adj\_work}}
\index{fmm\_m2m\_bessel\_ztranslate\_adj\_work@{fmm\_m2m\_bessel\_ztranslate\_adj\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_bessel\_ztranslate\_adj\_work()}{fmm\_m2m\_bessel\_ztranslate\_adj\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+bessel\+\_\+ztranslate\+\_\+adj\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+sk,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+sk,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m,  }\item[{real(dp), dimension(2$\ast$p+1), intent(out), target}]{work,  }\item[{complex(dp), dimension(2$\ast$p+1), intent(out)}]{work\+\_\+complex }\end{DoxyParamCaption})}



Direct M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from old to new centers of harmonics. Standard FMM M2M operation requires z to be OZ coordinate from new to old. \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily alpha} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (2$\ast$(p+1)) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l04667}{4667}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_ab223429877e369e8bdc48d6bff4a7a32}\label{namespaceddx__harmonics_ab223429877e369e8bdc48d6bff4a7a32}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_bessel\_derivative\_ztranslate\_work@{fmm\_m2m\_bessel\_derivative\_ztranslate\_work}}
\index{fmm\_m2m\_bessel\_derivative\_ztranslate\_work@{fmm\_m2m\_bessel\_derivative\_ztranslate\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_bessel\_derivative\_ztranslate\_work()}{fmm\_m2m\_bessel\_derivative\_ztranslate\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+bessel\+\_\+derivative\+\_\+ztranslate\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(p+2), intent(in)}]{src\+\_\+sk,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+2)$\ast$(p+2)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+2)$\ast$(p+2)), intent(inout)}]{dst\+\_\+m }\end{DoxyParamCaption})}



Direct M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from old to new centers of harmonics. Standard FMM M2M operation requires z to be OZ coordinate from new to old. \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily alpha} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (2$\ast$(p+1)) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l04821}{4821}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a1f3fe034c9643740bea4da7da792ef10}\label{namespaceddx__harmonics_a1f3fe034c9643740bea4da7da792ef10}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_ztranslate\_adj@{fmm\_m2m\_ztranslate\_adj}}
\index{fmm\_m2m\_ztranslate\_adj@{fmm\_m2m\_ztranslate\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_ztranslate\_adj()}{fmm\_m2m\_ztranslate\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+ztranslate\+\_\+adj (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m }\end{DoxyParamCaption})}



Adjoint M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M^\top \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M^\top $ is an adjoint matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l05099}{5099}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_aa87d3ac883f6e9ec93a2cbb01f243be8}\label{namespaceddx__harmonics_aa87d3ac883f6e9ec93a2cbb01f243be8}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_ztranslate\_adj\_work@{fmm\_m2m\_ztranslate\_adj\_work}}
\index{fmm\_m2m\_ztranslate\_adj\_work@{fmm\_m2m\_ztranslate\_adj\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_ztranslate\_adj\_work()}{fmm\_m2m\_ztranslate\_adj\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+ztranslate\+\_\+adj\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m,  }\item[{real(dp), dimension(2$\ast$(p+1)), intent(out), target}]{work }\end{DoxyParamCaption})}



Adjoint M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M^\top \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M^\top $ is an adjoint matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (2$\ast$(p+1)) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l05137}{5137}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a51c01e8ba76374eff76e3854bdcfe949}\label{namespaceddx__harmonics_a51c01e8ba76374eff76e3854bdcfe949}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_scale@{fmm\_m2m\_scale}}
\index{fmm\_m2m\_scale@{fmm\_m2m\_scale}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_scale()}{fmm\_m2m\_scale()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+scale (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m }\end{DoxyParamCaption})}



Scale M2M, when spherical harmonics are centered in the same point. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of a multipole-\/to-\/multipole translation when harmonics are centered in the same point.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Multipole expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Multipole expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l05300}{5300}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_ac97e4fe54c0763bb7a9bbb7bebaaefdc}\label{namespaceddx__harmonics_ac97e4fe54c0763bb7a9bbb7bebaaefdc}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_scale\_adj@{fmm\_m2m\_scale\_adj}}
\index{fmm\_m2m\_scale\_adj@{fmm\_m2m\_scale\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_scale\_adj()}{fmm\_m2m\_scale\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+scale\+\_\+adj (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m }\end{DoxyParamCaption})}



Adjoint scale M2M, when spherical harmonics are centered in the same point. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M^\top \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M^\top $ is an adjoint matrix of a multipole-\/to-\/multipole translation when harmonics are centered in the same point.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Multipole expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Multipole expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l05346}{5346}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a36fcddfe6a8097317e37332f44ad6331}\label{namespaceddx__harmonics_a36fcddfe6a8097317e37332f44ad6331}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_rotation@{fmm\_m2m\_rotation}}
\index{fmm\_m2m\_rotation@{fmm\_m2m\_rotation}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_rotation()}{fmm\_m2m\_rotation()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+rotation (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m }\end{DoxyParamCaption})}



Direct M2M translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of a multipole-\/to-\/multipole translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l05397}{5397}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a8e2dbf3bd69874619c4490930b91b4cc}\label{namespaceddx__harmonics_a8e2dbf3bd69874619c4490930b91b4cc}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_rotation\_work@{fmm\_m2m\_rotation\_work}}
\index{fmm\_m2m\_rotation\_work@{fmm\_m2m\_rotation\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_rotation\_work()}{fmm\_m2m\_rotation\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+rotation\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m,  }\item[{real(dp), dimension(6$\ast$p$\ast$p + 19$\ast$p + 8), intent(out), target}]{work }\end{DoxyParamCaption})}



Direct M2M translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of a multipole-\/to-\/multipole translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size 6$\ast$p$\ast$p+19$\ast$p+8 \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l05438}{5438}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a0f1934ed9e1bb6f70d2b07e0000337b9}\label{namespaceddx__harmonics_a0f1934ed9e1bb6f70d2b07e0000337b9}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_bessel\_rotation@{fmm\_m2m\_bessel\_rotation}}
\index{fmm\_m2m\_bessel\_rotation@{fmm\_m2m\_bessel\_rotation}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_bessel\_rotation()}{fmm\_m2m\_bessel\_rotation()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+bessel\+\_\+rotation (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{real(dp), intent(in)}]{kappa,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m }\end{DoxyParamCaption})}



Direct M2M translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of a multipole-\/to-\/multipole translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l05515}{5515}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a9f062fa6ce8602b23ee7ad4dba325fc5}\label{namespaceddx__harmonics_a9f062fa6ce8602b23ee7ad4dba325fc5}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_bessel\_rotation\_work@{fmm\_m2m\_bessel\_rotation\_work}}
\index{fmm\_m2m\_bessel\_rotation\_work@{fmm\_m2m\_bessel\_rotation\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_bessel\_rotation\_work()}{fmm\_m2m\_bessel\_rotation\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+bessel\+\_\+rotation\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+sk,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+sk,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m,  }\item[{real(dp), dimension(6$\ast$p$\ast$p + 19$\ast$p + 8), intent(out), target}]{work,  }\item[{complex(dp), dimension(2$\ast$p+1), intent(out)}]{work\+\_\+complex }\end{DoxyParamCaption})}



Direct M2M translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of a multipole-\/to-\/multipole translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from old to new centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size 6$\ast$p$\ast$p+19$\ast$p+8 \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l05575}{5575}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_aba7f517fdb4f2c6d19605d22e961bd8a}\label{namespaceddx__harmonics_aba7f517fdb4f2c6d19605d22e961bd8a}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_bessel\_rotation\_adj@{fmm\_m2m\_bessel\_rotation\_adj}}
\index{fmm\_m2m\_bessel\_rotation\_adj@{fmm\_m2m\_bessel\_rotation\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_bessel\_rotation\_adj()}{fmm\_m2m\_bessel\_rotation\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+bessel\+\_\+rotation\+\_\+adj (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{real(dp), intent(in)}]{kappa,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m }\end{DoxyParamCaption})}



Direct M2M translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of a multipole-\/to-\/multipole translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l05653}{5653}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a9ce78f5c64aa0138b672a8fc0d86a43f}\label{namespaceddx__harmonics_a9ce78f5c64aa0138b672a8fc0d86a43f}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_bessel\_rotation\_adj\_work@{fmm\_m2m\_bessel\_rotation\_adj\_work}}
\index{fmm\_m2m\_bessel\_rotation\_adj\_work@{fmm\_m2m\_bessel\_rotation\_adj\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_bessel\_rotation\_adj\_work()}{fmm\_m2m\_bessel\_rotation\_adj\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+bessel\+\_\+rotation\+\_\+adj\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+sk,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+sk,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m,  }\item[{real(dp), dimension(6$\ast$p$\ast$p + 19$\ast$p + 8), intent(out), target}]{work,  }\item[{complex(dp), dimension(2$\ast$p+1), intent(out)}]{work\+\_\+complex }\end{DoxyParamCaption})}



Direct M2M translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of a multipole-\/to-\/multipole translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from old to new centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size 6$\ast$p$\ast$p+19$\ast$p+8 \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l05713}{5713}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_afd618bb64bfc86a7e3d6e30b846e8827}\label{namespaceddx__harmonics_afd618bb64bfc86a7e3d6e30b846e8827}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_rotation\_adj@{fmm\_m2m\_rotation\_adj}}
\index{fmm\_m2m\_rotation\_adj@{fmm\_m2m\_rotation\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_rotation\_adj()}{fmm\_m2m\_rotation\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+rotation\+\_\+adj (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m }\end{DoxyParamCaption})}



Adjoint M2M translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M^\top \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M^\top $ is aa adjoint matrix of a multipole-\/to-\/multipole translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & expansion in old harmonics \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l05789}{5789}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_aeb0fff99d95226ac55100e7bea5e54c3}\label{namespaceddx__harmonics_aeb0fff99d95226ac55100e7bea5e54c3}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_rotation\_adj\_work@{fmm\_m2m\_rotation\_adj\_work}}
\index{fmm\_m2m\_rotation\_adj\_work@{fmm\_m2m\_rotation\_adj\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_rotation\_adj\_work()}{fmm\_m2m\_rotation\_adj\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+rotation\+\_\+adj\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+m,  }\item[{real(dp), dimension(6$\ast$p$\ast$p + 19$\ast$p + 8), intent(out), target}]{work }\end{DoxyParamCaption})}



Adjoint M2M translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M^\top \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M^\top $ is aa adjoint matrix of a multipole-\/to-\/multipole translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & expansion in old harmonics \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size 6$\ast$p$\ast$p+19$\ast$p+8 \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l05828}{5828}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_ab1fae9f9bc5a93546b030c8d3cb6e440}\label{namespaceddx__harmonics_ab1fae9f9bc5a93546b030c8d3cb6e440}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2m\_bessel\_grad@{fmm\_m2m\_bessel\_grad}}
\index{fmm\_m2m\_bessel\_grad@{fmm\_m2m\_bessel\_grad}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2m\_bessel\_grad()}{fmm\_m2m\_bessel\_grad()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2m\+\_\+bessel\+\_\+grad (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension(p+2), intent(in)}]{sph\+\_\+sk,  }\item[{real(dp), dimension((p+2)$\ast$$\ast$2), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+3)$\ast$(p+2)), intent(in)}]{vcnk,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(in)}]{sph\+\_\+m,  }\item[{real(dp), dimension((p+2)$\ast$$\ast$2, 3), intent(out)}]{sph\+\_\+m\+\_\+grad }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l05880}{5880}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_aad9703d05e792d36a570785d86462a54}\label{namespaceddx__harmonics_aad9703d05e792d36a570785d86462a54}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_ztranslate@{fmm\_l2l\_ztranslate}}
\index{fmm\_l2l\_ztranslate@{fmm\_l2l\_ztranslate}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_ztranslate()}{fmm\_l2l\_ztranslate()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+ztranslate (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension(2$\ast$p+1), intent(in)}]{vfact,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Direct L2L translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_L \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_L $ is a matrix of local-\/to-\/local translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vfact} & Square roots of factorials \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily src\+\_\+l} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+l} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+l} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l05942}{5942}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a4570fcbdae57e94800ae108a5e7d0156}\label{namespaceddx__harmonics_a4570fcbdae57e94800ae108a5e7d0156}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_ztranslate\_work@{fmm\_l2l\_ztranslate\_work}}
\index{fmm\_l2l\_ztranslate\_work@{fmm\_l2l\_ztranslate\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_ztranslate\_work()}{fmm\_l2l\_ztranslate\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+ztranslate\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension(2$\ast$p+1), intent(in)}]{vfact,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l,  }\item[{real(dp), dimension(2$\ast$(p+1)), intent(out), target}]{work }\end{DoxyParamCaption})}



Direct L2L translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_L \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_L $ is a matrix of local-\/to-\/local translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vfact} & Square roots of factorials \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily src\+\_\+l} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+l} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+l} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (2$\ast$(p+1)) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l05980}{5980}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_afc3069b525010879766feae650c66ad3}\label{namespaceddx__harmonics_afc3069b525010879766feae650c66ad3}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_bessel\_ztranslate@{fmm\_l2l\_bessel\_ztranslate}}
\index{fmm\_l2l\_bessel\_ztranslate@{fmm\_l2l\_bessel\_ztranslate}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_bessel\_ztranslate()}{fmm\_l2l\_bessel\_ztranslate()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+bessel\+\_\+ztranslate (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+si,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+si,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Direct M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily alpha} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l06074}{6074}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_af70cd42161512b6731ecb44991fa436f}\label{namespaceddx__harmonics_af70cd42161512b6731ecb44991fa436f}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_bessel\_ztranslate\_work@{fmm\_l2l\_bessel\_ztranslate\_work}}
\index{fmm\_l2l\_bessel\_ztranslate\_work@{fmm\_l2l\_bessel\_ztranslate\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_bessel\_ztranslate\_work()}{fmm\_l2l\_bessel\_ztranslate\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+bessel\+\_\+ztranslate\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+si,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+si,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l,  }\item[{real(dp), dimension(2$\ast$p+1), intent(out), target}]{work,  }\item[{complex(dp), dimension(2$\ast$p+1), intent(out)}]{work\+\_\+complex }\end{DoxyParamCaption})}



Direct M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from old to new centers of harmonics. Standard FMM M2M operation requires z to be OZ coordinate from new to old. \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily alpha} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (2$\ast$(p+1)) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l06114}{6114}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a1dac37da23b9a63fd737d7992c030196}\label{namespaceddx__harmonics_a1dac37da23b9a63fd737d7992c030196}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_bessel\_ztranslate\_adj@{fmm\_l2l\_bessel\_ztranslate\_adj}}
\index{fmm\_l2l\_bessel\_ztranslate\_adj@{fmm\_l2l\_bessel\_ztranslate\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_bessel\_ztranslate\_adj()}{fmm\_l2l\_bessel\_ztranslate\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+bessel\+\_\+ztranslate\+\_\+adj (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+si,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+si,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Direct M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily alpha} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l06314}{6314}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a3cec3838169439c25bdca5fc932eda11}\label{namespaceddx__harmonics_a3cec3838169439c25bdca5fc932eda11}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_bessel\_ztranslate\_adj\_work@{fmm\_l2l\_bessel\_ztranslate\_adj\_work}}
\index{fmm\_l2l\_bessel\_ztranslate\_adj\_work@{fmm\_l2l\_bessel\_ztranslate\_adj\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_bessel\_ztranslate\_adj\_work()}{fmm\_l2l\_bessel\_ztranslate\_adj\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+bessel\+\_\+ztranslate\+\_\+adj\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+si,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+si,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l,  }\item[{real(dp), dimension(2$\ast$p+1), intent(out), target}]{work,  }\item[{complex(dp), dimension(2$\ast$p+1), intent(out)}]{work\+\_\+complex }\end{DoxyParamCaption})}



Direct M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from old to new centers of harmonics. Standard FMM M2M operation requires z to be OZ coordinate from new to old. \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily alpha} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (2$\ast$(p+1)) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l06354}{6354}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_ab85718cf83cde425ec2829524a4e86f0}\label{namespaceddx__harmonics_ab85718cf83cde425ec2829524a4e86f0}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_bessel\_derivative\_ztranslate\_work@{fmm\_l2l\_bessel\_derivative\_ztranslate\_work}}
\index{fmm\_l2l\_bessel\_derivative\_ztranslate\_work@{fmm\_l2l\_bessel\_derivative\_ztranslate\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_bessel\_derivative\_ztranslate\_work()}{fmm\_l2l\_bessel\_derivative\_ztranslate\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+bessel\+\_\+derivative\+\_\+ztranslate\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(p+2), intent(in)}]{src\+\_\+si,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+2)$\ast$(p+2)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+2)$\ast$(p+2)), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Direct M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from old to new centers of harmonics. Standard FMM M2M operation requires z to be OZ coordinate from new to old. \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily alpha} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (2$\ast$(p+1)) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l06557}{6557}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a5c7d13c5cf136657b7444c1d837fab4b}\label{namespaceddx__harmonics_a5c7d13c5cf136657b7444c1d837fab4b}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_ztranslate\_adj@{fmm\_l2l\_ztranslate\_adj}}
\index{fmm\_l2l\_ztranslate\_adj@{fmm\_l2l\_ztranslate\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_ztranslate\_adj()}{fmm\_l2l\_ztranslate\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+ztranslate\+\_\+adj (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension(2$\ast$p+1), intent(in)}]{vfact,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Adjoint L2L translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_L^\top \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_L^\top $ is an adjoint matrix of local-\/to-\/local translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vfact} & Square roots of factorials \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily src\+\_\+l} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+l} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+l} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l06600}{6600}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a9c62cbb1ed23a853d4e7b41d6ddcdf02}\label{namespaceddx__harmonics_a9c62cbb1ed23a853d4e7b41d6ddcdf02}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_ztranslate\_adj\_work@{fmm\_l2l\_ztranslate\_adj\_work}}
\index{fmm\_l2l\_ztranslate\_adj\_work@{fmm\_l2l\_ztranslate\_adj\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_ztranslate\_adj\_work()}{fmm\_l2l\_ztranslate\_adj\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+ztranslate\+\_\+adj\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension(2$\ast$p+1), intent(in)}]{vfact,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l,  }\item[{real(dp), dimension(2$\ast$(p+1)), intent(out), target}]{work }\end{DoxyParamCaption})}



Adjoint L2L translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_L^\top \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_L^\top $ is an adjoint matrix of local-\/to-\/local translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vfact} & Square roots of factorials \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily src\+\_\+l} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+l} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+l} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (2$\ast$(p+1)) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l06638}{6638}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a37a718dad667bceccf0b7daac26a0e8c}\label{namespaceddx__harmonics_a37a718dad667bceccf0b7daac26a0e8c}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_scale@{fmm\_l2l\_scale}}
\index{fmm\_l2l\_scale@{fmm\_l2l\_scale}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_scale()}{fmm\_l2l\_scale()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+scale (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Scale L2L, when spherical harmonics are centered in the same point. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_L \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_L $ is a matrix of a local-\/to-\/local translation when harmonics are centered in the same point.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & Multipole expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+l} & Multipole expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l06728}{6728}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a085ce4ed5dc41ee929792e75d6c89c8a}\label{namespaceddx__harmonics_a085ce4ed5dc41ee929792e75d6c89c8a}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_scale\_adj@{fmm\_l2l\_scale\_adj}}
\index{fmm\_l2l\_scale\_adj@{fmm\_l2l\_scale\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_scale\_adj()}{fmm\_l2l\_scale\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+scale\+\_\+adj (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Adjoint scale L2L, when spherical harmonics are centered in the same point. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_L^\top \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_L^\top $ is an adjoint matrix of a local-\/to-\/local translation when harmonics are centered in the same point.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & Multipole expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+l} & Multipole expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l06773}{6773}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a8a048c26fd101b7f9bac1a0ff0a24905}\label{namespaceddx__harmonics_a8a048c26fd101b7f9bac1a0ff0a24905}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_rotation@{fmm\_l2l\_rotation}}
\index{fmm\_l2l\_rotation@{fmm\_l2l\_rotation}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_rotation()}{fmm\_l2l\_rotation()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+rotation (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension(2$\ast$p+1), intent(in)}]{vfact,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Direct L2L translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_L \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_L $ is a matrix of a local-\/to-\/local translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vfact} & Square roots of factorials \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+l} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+l} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+l} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l06824}{6824}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a75cdc5b6aeb95fdfaa88ae0e0834092f}\label{namespaceddx__harmonics_a75cdc5b6aeb95fdfaa88ae0e0834092f}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_rotation\_work@{fmm\_l2l\_rotation\_work}}
\index{fmm\_l2l\_rotation\_work@{fmm\_l2l\_rotation\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_rotation\_work()}{fmm\_l2l\_rotation\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+rotation\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension(2$\ast$p+1), intent(in)}]{vfact,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l,  }\item[{real(dp), dimension(6$\ast$p$\ast$p + 19$\ast$p + 8), intent(out), target}]{work }\end{DoxyParamCaption})}



Direct L2L translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_L \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_L $ is a matrix of a local-\/to-\/local translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vfact} & Square roots of factorials \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+l} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+l} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+l} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size 6$\ast$p$\ast$p+19$\ast$p+8 \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l06865}{6865}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a2470673bf995bdc825636dc134ccbb8a}\label{namespaceddx__harmonics_a2470673bf995bdc825636dc134ccbb8a}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_bessel\_rotation@{fmm\_l2l\_bessel\_rotation}}
\index{fmm\_l2l\_bessel\_rotation@{fmm\_l2l\_bessel\_rotation}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_bessel\_rotation()}{fmm\_l2l\_bessel\_rotation()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+bessel\+\_\+rotation (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{real(dp), intent(in)}]{kappa,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Direct L2L translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of a multipole-\/to-\/multipole translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l06942}{6942}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a2284e6d544d983d0ac935f0ec642d3b1}\label{namespaceddx__harmonics_a2284e6d544d983d0ac935f0ec642d3b1}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_bessel\_rotation\_work@{fmm\_l2l\_bessel\_rotation\_work}}
\index{fmm\_l2l\_bessel\_rotation\_work@{fmm\_l2l\_bessel\_rotation\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_bessel\_rotation\_work()}{fmm\_l2l\_bessel\_rotation\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+bessel\+\_\+rotation\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+si,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+si,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l,  }\item[{real(dp), dimension(6$\ast$p$\ast$p + 19$\ast$p + 8), intent(out), target}]{work,  }\item[{complex(dp), dimension(2$\ast$p+1), intent(out)}]{work\+\_\+complex }\end{DoxyParamCaption})}



Direct L2L translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of a multipole-\/to-\/multipole translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from old to new centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size 6$\ast$p$\ast$p+19$\ast$p+8 \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l07001}{7001}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a43a12c1e6baf98f39499317b71978ea1}\label{namespaceddx__harmonics_a43a12c1e6baf98f39499317b71978ea1}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_bessel\_rotation\_adj@{fmm\_l2l\_bessel\_rotation\_adj}}
\index{fmm\_l2l\_bessel\_rotation\_adj@{fmm\_l2l\_bessel\_rotation\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_bessel\_rotation\_adj()}{fmm\_l2l\_bessel\_rotation\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+bessel\+\_\+rotation\+\_\+adj (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{real(dp), intent(in)}]{kappa,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Direct L2L translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of a multipole-\/to-\/multipole translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l07078}{7078}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a5c75d37d1e2bcc0897cdac02b45c7bca}\label{namespaceddx__harmonics_a5c75d37d1e2bcc0897cdac02b45c7bca}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_bessel\_rotation\_adj\_work@{fmm\_l2l\_bessel\_rotation\_adj\_work}}
\index{fmm\_l2l\_bessel\_rotation\_adj\_work@{fmm\_l2l\_bessel\_rotation\_adj\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_bessel\_rotation\_adj\_work()}{fmm\_l2l\_bessel\_rotation\_adj\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+bessel\+\_\+rotation\+\_\+adj\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+si,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+si,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l,  }\item[{real(dp), dimension(6$\ast$p$\ast$p + 19$\ast$p + 8), intent(out), target}]{work,  }\item[{complex(dp), dimension(2$\ast$p+1), intent(out)}]{work\+\_\+complex }\end{DoxyParamCaption})}



Direct L2L translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of a multipole-\/to-\/multipole translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from old to new centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size 6$\ast$p$\ast$p+19$\ast$p+8 \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l07137}{7137}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a555d92f202b8c23bf09b53248b4ea6db}\label{namespaceddx__harmonics_a555d92f202b8c23bf09b53248b4ea6db}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_bessel\_grad@{fmm\_l2l\_bessel\_grad}}
\index{fmm\_l2l\_bessel\_grad@{fmm\_l2l\_bessel\_grad}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_bessel\_grad()}{fmm\_l2l\_bessel\_grad()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+bessel\+\_\+grad (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension(p+2), intent(in)}]{sph\+\_\+si,  }\item[{real(dp), dimension((p+2)$\ast$$\ast$2), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+3)$\ast$(p+2)), intent(in)}]{vcnk,  }\item[{real(dp), dimension((p+1)$\ast$$\ast$2), intent(in)}]{sph\+\_\+l,  }\item[{real(dp), dimension((p+2)$\ast$$\ast$2, 3), intent(out)}]{sph\+\_\+l\+\_\+grad }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l07190}{7190}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a2e78bfce1b61689ffc4bbae65033273c}\label{namespaceddx__harmonics_a2e78bfce1b61689ffc4bbae65033273c}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_rotation\_adj@{fmm\_l2l\_rotation\_adj}}
\index{fmm\_l2l\_rotation\_adj@{fmm\_l2l\_rotation\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_rotation\_adj()}{fmm\_l2l\_rotation\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+rotation\+\_\+adj (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension(2$\ast$p+1), intent(in)}]{vfact,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Adjoint L2L translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_L^\top \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_L^\top $ is an adjoint matrix of a local-\/to-\/local translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vfact} & Square roots of factorials \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+l} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+l} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+l} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l07255}{7255}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a9dc2a4fa345b7c780c54cecccb88d5a7}\label{namespaceddx__harmonics_a9dc2a4fa345b7c780c54cecccb88d5a7}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_l2l\_rotation\_adj\_work@{fmm\_l2l\_rotation\_adj\_work}}
\index{fmm\_l2l\_rotation\_adj\_work@{fmm\_l2l\_rotation\_adj\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_l2l\_rotation\_adj\_work()}{fmm\_l2l\_rotation\_adj\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+l2l\+\_\+rotation\+\_\+adj\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension(2$\ast$p+1), intent(in)}]{vfact,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l,  }\item[{real(dp), dimension(6$\ast$p$\ast$p + 19$\ast$p + 8), intent(out), target}]{work }\end{DoxyParamCaption})}



Adjoint L2L translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_L^\top \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_L^\top $ is an adjoint matrix of a local-\/to-\/local translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vfact} & Square roots of factorials \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+l} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+l} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+l} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size 6$\ast$p$\ast$p+19$\ast$p+8 \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l07296}{7296}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a302db88f5061b12f7486d0b97cc3e097}\label{namespaceddx__harmonics_a302db88f5061b12f7486d0b97cc3e097}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2l\_ztranslate@{fmm\_m2l\_ztranslate}}
\index{fmm\_m2l\_ztranslate@{fmm\_m2l\_ztranslate}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2l\_ztranslate()}{fmm\_m2l\_ztranslate()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2l\+\_\+ztranslate (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{pm,  }\item[{integer, intent(in)}]{pl,  }\item[{real(dp), dimension((pm+pl+1)$\ast$(pm+pl+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension(pm+1, pl+1, pl+1), intent(in)}]{m2l\+\_\+ztranslate\+\_\+coef,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((pm+1)$\ast$(pm+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((pl+1)$\ast$(pl+1)), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Direct M2L translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_M $ is a matrix of multipole-\/to-\/local translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old (multipole) harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new (local) harmonics @parma\mbox{[}in\mbox{]} pm\+: Maximal degree of multipole spherical harmonics @parma\mbox{[}in\mbox{]} pl\+: Maximal degree of local spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em m2l\+\_\+ztranslate\+\_\+coef} & \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old (multipole) harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+l} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+l} & Expansion in new (local) harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l07371}{7371}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a77d42c058d06892d3b7fca4be94fe7aa}\label{namespaceddx__harmonics_a77d42c058d06892d3b7fca4be94fe7aa}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2l\_ztranslate\_work@{fmm\_m2l\_ztranslate\_work}}
\index{fmm\_m2l\_ztranslate\_work@{fmm\_m2l\_ztranslate\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2l\_ztranslate\_work()}{fmm\_m2l\_ztranslate\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2l\+\_\+ztranslate\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{pm,  }\item[{integer, intent(in)}]{pl,  }\item[{real(dp), dimension((pm+pl+1)$\ast$(pm+pl+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension(pm+1, pl+1, pl+1), intent(in)}]{m2l\+\_\+ztranslate\+\_\+coef,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((pm+1)$\ast$(pm+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((pl+1)$\ast$(pl+1)), intent(inout)}]{dst\+\_\+l,  }\item[{real(dp), dimension((pm+2)$\ast$(pm+1)), intent(out), target}]{work }\end{DoxyParamCaption})}



Direct M2L translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_M $ is a matrix of multipole-\/to-\/local translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old (multipole) harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new (local) harmonics @parma\mbox{[}in\mbox{]} pm\+: Maximal degree of multipole spherical harmonics @parma\mbox{[}in\mbox{]} pl\+: Maximal degree of local spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em m2l\+\_\+ztranslate\+\_\+coef} & \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old (multipole) harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+l} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+l} & Expansion in new (local) harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (pm+2)$\ast$(pm+1) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l07411}{7411}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_aeae1744438b52f07e7a42f549c610d32}\label{namespaceddx__harmonics_aeae1744438b52f07e7a42f549c610d32}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2l\_ztranslate\_adj@{fmm\_m2l\_ztranslate\_adj}}
\index{fmm\_m2l\_ztranslate\_adj@{fmm\_m2l\_ztranslate\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2l\_ztranslate\_adj()}{fmm\_m2l\_ztranslate\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2l\+\_\+ztranslate\+\_\+adj (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{pl,  }\item[{integer, intent(in)}]{pm,  }\item[{real(dp), dimension((pm+pl+1)$\ast$(pm+pl+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension(pl+1, pl+1, pm+1), intent(in)}]{m2l\+\_\+ztranslate\+\_\+adj\+\_\+coef,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((pl+1)$\ast$(pl+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((pm+1)$\ast$(pm+1)), intent(inout)}]{dst\+\_\+m }\end{DoxyParamCaption})}



Adjoint M2L translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_M^\top \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_M^\top $ is an adjoint matrix of multipole-\/to-\/local translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old (local) harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new (multipole) harmonics @parma\mbox{[}in\mbox{]} pl\+: Maximal degree of local spherical harmonics @parma\mbox{[}in\mbox{]} pm\+: Maximal degree of multipole spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em m2l\+\_\+ztranslate\+\_\+adj\+\_\+coef} & \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily src\+\_\+l} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & Expansion in old (local) harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new (multipole) harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l07570}{7570}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a3cd0d97cf18e84aa23c13847a3977fb3}\label{namespaceddx__harmonics_a3cd0d97cf18e84aa23c13847a3977fb3}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2l\_ztranslate\_adj\_work@{fmm\_m2l\_ztranslate\_adj\_work}}
\index{fmm\_m2l\_ztranslate\_adj\_work@{fmm\_m2l\_ztranslate\_adj\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2l\_ztranslate\_adj\_work()}{fmm\_m2l\_ztranslate\_adj\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2l\+\_\+ztranslate\+\_\+adj\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{pl,  }\item[{integer, intent(in)}]{pm,  }\item[{real(dp), dimension((pm+pl+1)$\ast$(pm+pl+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension(pl+1, pl+1, pm+1), intent(in)}]{m2l\+\_\+ztranslate\+\_\+adj\+\_\+coef,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((pl+1)$\ast$(pl+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((pm+1)$\ast$(pm+1)), intent(inout)}]{dst\+\_\+m,  }\item[{real(dp), dimension((pl+2)$\ast$(pl+1)), intent(out), target}]{work }\end{DoxyParamCaption})}



Adjoint M2L translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_M^\top \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_M^\top $ is an adjoint matrix of multipole-\/to-\/local translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old (local) harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new (multipole) harmonics @parma\mbox{[}in\mbox{]} pl\+: Maximal degree of local spherical harmonics @parma\mbox{[}in\mbox{]} pm\+: Maximal degree of multipole spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em m2l\+\_\+ztranslate\+\_\+adj\+\_\+coef} & \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily src\+\_\+l} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & Expansion in old (local) harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new (multipole) harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l07609}{7609}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a0d2be15addfeb062073b61d5fd239912}\label{namespaceddx__harmonics_a0d2be15addfeb062073b61d5fd239912}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2l\_rotation@{fmm\_m2l\_rotation}}
\index{fmm\_m2l\_rotation@{fmm\_m2l\_rotation}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2l\_rotation()}{fmm\_m2l\_rotation()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2l\+\_\+rotation (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{pm,  }\item[{integer, intent(in)}]{pl,  }\item[{real(dp), dimension((pm+pl+1)$\ast$$\ast$2), intent(in)}]{vscales,  }\item[{real(dp), dimension(pm+1, pl+1, pl+1), intent(in)}]{m2l\+\_\+ztranslate\+\_\+coef,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((pm+1)$\ast$(pm+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((pl+1)$\ast$(pl+1)), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Direct M2L translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_M $ is a matrix of a multipole-\/to-\/local translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em pm} & Maximal degree of multipole spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em pl} & Maximal degree of local spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em m2l\+\_\+ztranslate\+\_\+coef} & \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+l} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+l} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l07770}{7770}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a9626682b922d5e507f037548eb3d2355}\label{namespaceddx__harmonics_a9626682b922d5e507f037548eb3d2355}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2l\_rotation\_work@{fmm\_m2l\_rotation\_work}}
\index{fmm\_m2l\_rotation\_work@{fmm\_m2l\_rotation\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2l\_rotation\_work()}{fmm\_m2l\_rotation\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2l\+\_\+rotation\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{pm,  }\item[{integer, intent(in)}]{pl,  }\item[{real(dp), dimension((pm+pl+1)$\ast$$\ast$2), intent(in)}]{vscales,  }\item[{real(dp), dimension(pm+1, pl+1, pl+1), intent(in)}]{m2l\+\_\+ztranslate\+\_\+coef,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((pm+1)$\ast$(pm+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((pl+1)$\ast$(pl+1)), intent(inout)}]{dst\+\_\+l,  }\item[{real(dp), dimension(6$\ast$max(pm, pl)$\ast$$\ast$2 + 19$\ast$max(pm, pl) + 8), intent(out), target}]{work }\end{DoxyParamCaption})}



Direct M2L translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_M $ is a matrix of a multipole-\/to-\/local translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em pm} & Maximal degree of multipole spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em pl} & Maximal degree of local spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em m2l\+\_\+ztranslate\+\_\+coef} & \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+l} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+l} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size 6$\ast$p$\ast$p+19$\ast$p+8 where p is a maximum of pm and pl \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l07814}{7814}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_af04110484cace6e9cefcad3acd7ece66}\label{namespaceddx__harmonics_af04110484cace6e9cefcad3acd7ece66}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2l\_bessel\_rotation@{fmm\_m2l\_bessel\_rotation}}
\index{fmm\_m2l\_bessel\_rotation@{fmm\_m2l\_bessel\_rotation}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2l\_bessel\_rotation()}{fmm\_m2l\_bessel\_rotation()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2l\+\_\+bessel\+\_\+rotation (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{real(dp), intent(in)}]{kappa,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Direct M2M translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of a multipole-\/to-\/multipole translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l07894}{7894}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_aa3c333c44623a5c713b14239f77c21be}\label{namespaceddx__harmonics_aa3c333c44623a5c713b14239f77c21be}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2l\_bessel\_rotation\_work@{fmm\_m2l\_bessel\_rotation\_work}}
\index{fmm\_m2l\_bessel\_rotation\_work@{fmm\_m2l\_bessel\_rotation\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2l\_bessel\_rotation\_work()}{fmm\_m2l\_bessel\_rotation\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2l\+\_\+bessel\+\_\+rotation\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+sk,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+si,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l,  }\item[{real(dp), dimension(6$\ast$p$\ast$p + 19$\ast$p + 8), intent(out), target}]{work,  }\item[{complex(dp), dimension(2$\ast$p+1), intent(out)}]{work\+\_\+complex }\end{DoxyParamCaption})}



Direct M2M translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of a multipole-\/to-\/multipole translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from old to new centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size 6$\ast$p$\ast$p+19$\ast$p+8 \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l07953}{7953}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a44beda4f2d48ac451449357076a3ff89}\label{namespaceddx__harmonics_a44beda4f2d48ac451449357076a3ff89}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2l\_bessel\_rotation\_adj@{fmm\_m2l\_bessel\_rotation\_adj}}
\index{fmm\_m2l\_bessel\_rotation\_adj@{fmm\_m2l\_bessel\_rotation\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2l\_bessel\_rotation\_adj()}{fmm\_m2l\_bessel\_rotation\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2l\+\_\+bessel\+\_\+rotation\+\_\+adj (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{real(dp), intent(in)}]{kappa,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Direct M2M translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of a multipole-\/to-\/multipole translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l08031}{8031}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a77326a39f2e6eec60040792e7ab41466}\label{namespaceddx__harmonics_a77326a39f2e6eec60040792e7ab41466}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2l\_bessel\_rotation\_adj\_work@{fmm\_m2l\_bessel\_rotation\_adj\_work}}
\index{fmm\_m2l\_bessel\_rotation\_adj\_work@{fmm\_m2l\_bessel\_rotation\_adj\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2l\_bessel\_rotation\_adj\_work()}{fmm\_m2l\_bessel\_rotation\_adj\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2l\+\_\+bessel\+\_\+rotation\+\_\+adj\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+sk,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+si,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l,  }\item[{real(dp), dimension(6$\ast$p$\ast$p + 19$\ast$p + 8), intent(out), target}]{work,  }\item[{complex(dp), dimension(2$\ast$p+1), intent(out)}]{work\+\_\+complex }\end{DoxyParamCaption})}



Direct M2M translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of a multipole-\/to-\/multipole translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from old to new centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em p} & Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+m} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size 6$\ast$p$\ast$p+19$\ast$p+8 \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l08091}{8091}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a1bae2fb9a4287cfa93178ec5ba4db9f5}\label{namespaceddx__harmonics_a1bae2fb9a4287cfa93178ec5ba4db9f5}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2l\_bessel\_ztranslate@{fmm\_m2l\_bessel\_ztranslate}}
\index{fmm\_m2l\_bessel\_ztranslate@{fmm\_m2l\_bessel\_ztranslate}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2l\_bessel\_ztranslate()}{fmm\_m2l\_bessel\_ztranslate()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2l\+\_\+bessel\+\_\+ztranslate (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+sk,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+si,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Direct M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily alpha} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l08166}{8166}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_aca682ec8e6ddee561d69d864ad8bc14e}\label{namespaceddx__harmonics_aca682ec8e6ddee561d69d864ad8bc14e}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2l\_bessel\_ztranslate\_work@{fmm\_m2l\_bessel\_ztranslate\_work}}
\index{fmm\_m2l\_bessel\_ztranslate\_work@{fmm\_m2l\_bessel\_ztranslate\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2l\_bessel\_ztranslate\_work()}{fmm\_m2l\_bessel\_ztranslate\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2l\+\_\+bessel\+\_\+ztranslate\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+sk,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+si,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l,  }\item[{real(dp), dimension(2$\ast$p+1), intent(out), target}]{work,  }\item[{complex(dp), dimension(2$\ast$p+1), intent(out)}]{work\+\_\+complex }\end{DoxyParamCaption})}



Direct M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from old to new centers of harmonics. Standard FMM M2M operation requires z to be OZ coordinate from new to old. \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily alpha} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (2$\ast$(p+1)) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l08206}{8206}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_af59ef6901ffb4383d0959de10fd8926f}\label{namespaceddx__harmonics_af59ef6901ffb4383d0959de10fd8926f}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2l\_bessel\_ztranslate\_adj@{fmm\_m2l\_bessel\_ztranslate\_adj}}
\index{fmm\_m2l\_bessel\_ztranslate\_adj@{fmm\_m2l\_bessel\_ztranslate\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2l\_bessel\_ztranslate\_adj()}{fmm\_m2l\_bessel\_ztranslate\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2l\+\_\+bessel\+\_\+ztranslate\+\_\+adj (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+sk,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+si,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l }\end{DoxyParamCaption})}



Direct M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily alpha} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l08358}{8358}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a933d14fb3c323d01a2706c25eed8869e}\label{namespaceddx__harmonics_a933d14fb3c323d01a2706c25eed8869e}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2l\_bessel\_ztranslate\_adj\_work@{fmm\_m2l\_bessel\_ztranslate\_adj\_work}}
\index{fmm\_m2l\_bessel\_ztranslate\_adj\_work@{fmm\_m2l\_bessel\_ztranslate\_adj\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2l\_bessel\_ztranslate\_adj\_work()}{fmm\_m2l\_bessel\_ztranslate\_adj\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2l\+\_\+bessel\+\_\+ztranslate\+\_\+adj\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), intent(in)}]{z,  }\item[{real(dp), dimension(p+1), intent(in)}]{src\+\_\+sk,  }\item[{real(dp), dimension(p+1), intent(in)}]{dst\+\_\+si,  }\item[{integer, intent(in)}]{p,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{vscales,  }\item[{real(dp), dimension((2$\ast$p+1)$\ast$(p+1)), intent(in)}]{vcnk,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(in)}]{src\+\_\+m,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((p+1)$\ast$(p+1)), intent(inout)}]{dst\+\_\+l,  }\item[{real(dp), dimension(2$\ast$p+1), intent(out), target}]{work,  }\item[{complex(dp), dimension(2$\ast$p+1), intent(out)}]{work\+\_\+complex }\end{DoxyParamCaption})}



Direct M2M translation over OZ axis. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha M_M \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ M_M $ is a matrix of multipole-\/to-\/multipole translation over OZ axis.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em z} & OZ coordinate from old to new centers of harmonics. Standard FMM M2M operation requires z to be OZ coordinate from new to old. \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics @parma\mbox{[}in\mbox{]} p\+: Maximal degree of spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & Normalization constants for harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vcnk} & Square roots of combinatorial numbers C\+\_\+n$^\wedge$k \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multipler for {\ttfamily alpha} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+m} & Expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multipler for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & Expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size (2$\ast$(p+1)) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l08398}{8398}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_a8cfe4104aac6bb08df2fa15d2df2ba1a}\label{namespaceddx__harmonics_a8cfe4104aac6bb08df2fa15d2df2ba1a}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2l\_rotation\_adj@{fmm\_m2l\_rotation\_adj}}
\index{fmm\_m2l\_rotation\_adj@{fmm\_m2l\_rotation\_adj}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2l\_rotation\_adj()}{fmm\_m2l\_rotation\_adj()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2l\+\_\+rotation\+\_\+adj (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{pl,  }\item[{integer, intent(in)}]{pm,  }\item[{real(dp), dimension((pm+pl+1)$\ast$$\ast$2), intent(in)}]{vscales,  }\item[{real(dp), dimension(pl+1, pl+1, pm+1), intent(in)}]{m2l\+\_\+ztranslate\+\_\+adj\+\_\+coef,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((pl+1)$\ast$(pl+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((pm+1)$\ast$(pm+1)), intent(inout)}]{dst\+\_\+m }\end{DoxyParamCaption})}



Adjoint M2L translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_M^\top \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_M^\top $ is an adjoint matrix of a multipole-\/to-\/local translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em pl} & Maximal degree of local spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em pm} & Maximal degree of multipole spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em m2l\+\_\+ztranslate\+\_\+adj\+\_\+oef} & \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+l} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & expansion in new harmonics \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l08554}{8554}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

\mbox{\Hypertarget{namespaceddx__harmonics_abbb798594959e90b6d60588e88a7a12e}\label{namespaceddx__harmonics_abbb798594959e90b6d60588e88a7a12e}} 
\index{ddx\_harmonics@{ddx\_harmonics}!fmm\_m2l\_rotation\_adj\_work@{fmm\_m2l\_rotation\_adj\_work}}
\index{fmm\_m2l\_rotation\_adj\_work@{fmm\_m2l\_rotation\_adj\_work}!ddx\_harmonics@{ddx\_harmonics}}
\doxysubsubsection{\texorpdfstring{fmm\_m2l\_rotation\_adj\_work()}{fmm\_m2l\_rotation\_adj\_work()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+harmonics\+::fmm\+\_\+m2l\+\_\+rotation\+\_\+adj\+\_\+work (\begin{DoxyParamCaption}\item[{real(dp), dimension(3), intent(in)}]{c,  }\item[{real(dp), intent(in)}]{src\+\_\+r,  }\item[{real(dp), intent(in)}]{dst\+\_\+r,  }\item[{integer, intent(in)}]{pl,  }\item[{integer, intent(in)}]{pm,  }\item[{real(dp), dimension((pm+pl+1)$\ast$$\ast$2), intent(in)}]{vscales,  }\item[{real(dp), dimension(pl+1, pl+1, pm+1), intent(in)}]{m2l\+\_\+ztranslate\+\_\+adj\+\_\+coef,  }\item[{real(dp), intent(in)}]{alpha,  }\item[{real(dp), dimension((pl+1)$\ast$(pl+1)), intent(in)}]{src\+\_\+l,  }\item[{real(dp), intent(in)}]{beta,  }\item[{real(dp), dimension((pm+1)$\ast$(pm+1)), intent(inout)}]{dst\+\_\+m,  }\item[{real(dp), dimension(6$\ast$max(pm, pl)$\ast$$\ast$2 + 19$\ast$max(pm, pl) + 8), intent(out), target}]{work }\end{DoxyParamCaption})}



Adjoint M2L translation by 4 rotations and 1 translation. 

Compute the following matrix-\/vector product\+: \[
      \mathrm{dst} = \beta \mathrm{dst} + \alpha L_M^\top \mathrm{src},
 \] where $ \mathrm{dst} $ is a vector of coefficients of output spherical harmonics, $ \mathrm{src} $ is a vector of coefficients of input spherical harmonics and $ L_M^\top $ is an adjoint matrix of a multipole-\/to-\/local translation.

Rotates around OZ and OY axes, translates over OZ and then rotates back around OY and OZ axes.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em c} & Radius-\/vector from new to old centers of harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+r} & Radius of old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em dst\+\_\+r} & Radius of new harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em pl} & Maximal degree of local spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em pm} & Maximal degree of multipole spherical harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em vscales} & normalization constants for Y\+\_\+lm \\
\hline
\mbox{\texttt{ in}}  & {\em m2l\+\_\+ztranslate\+\_\+adj\+\_\+coef} & \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & Scalar multiplier for {\ttfamily src\+\_\+l} \\
\hline
\mbox{\texttt{ in}}  & {\em src\+\_\+l} & expansion in old harmonics \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & Scalar multiplier for {\ttfamily dst\+\_\+m} \\
\hline
\mbox{\texttt{ in,out}}  & {\em dst\+\_\+m} & expansion in new harmonics \\
\hline
\mbox{\texttt{ out}}  & {\em work} & Temporary workspace of a size 6$\ast$p$\ast$p+19$\ast$p+8 where p is a maximum of pm and pl \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__harmonics_8f90_source_l08598}{8598}} of file \mbox{\hyperlink{ddx__harmonics_8f90_source}{ddx\+\_\+harmonics.\+f90}}.

