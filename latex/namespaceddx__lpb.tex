\hypertarget{namespaceddx__lpb}{}\doxysection{ddx\+\_\+lpb Module Reference}
\label{namespaceddx__lpb}\index{ddx\_lpb@{ddx\_lpb}}


High-\/level subroutines for ddlpb.  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespaceddx__lpb_a13892ac674290cc45ad9b10de75cd3b4}{ddlpb\+\_\+solve}} (params, constants, workspace, state, phi\+\_\+cav, gradphi\+\_\+cav, tol)
\begin{DoxyCompactList}\small\item\em dd\+LPB solver \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__lpb_a1906e7ae3780af8ec216f3f078129bd0}{ddlpb\+\_\+adjoint}} (params, constants, workspace, state, psi, tol)
\item 
subroutine \mbox{\hyperlink{namespaceddx__lpb_a712455dd9c9e04156fcfd482db62a831}{ddlpb\+\_\+force}} (params, constants, workspace, state, phi\+\_\+cav, gradphi\+\_\+cav, hessianphi\+\_\+cav, psi, force)
\item 
subroutine \mbox{\hyperlink{namespaceddx__lpb_ac267907f835f42a6b87d64954cc9276b}{ddlpb\+\_\+guess}} (params, constants, state)
\item 
subroutine \mbox{\hyperlink{namespaceddx__lpb_ac7bb64b6631ee97ee4077d711349cb85}{ddlpb}} (params, constants, workspace, state, phi\+\_\+cav, gradphi\+\_\+cav, hessianphi\+\_\+cav, psi, tol, esolv, force, info)
\item 
subroutine \mbox{\hyperlink{namespaceddx__lpb_abd1c32f7ef61ae0f5653c8a651f8a0e5}{ddlpb\+\_\+solve\+\_\+worker}} (params, constants, workspace, phi\+\_\+cav, gradphi\+\_\+cav, g\+\_\+lpb, f\+\_\+lpb, phi\+\_\+grid, x\+\_\+lpb, x\+\_\+lpb\+\_\+niter, x\+\_\+lpb\+\_\+time, x\+\_\+lpb\+\_\+rel\+\_\+diff, tol)
\item 
subroutine \mbox{\hyperlink{namespaceddx__lpb_ac060c5a84b80af1d44e392ba24966368}{ddlpb\+\_\+adjoint\+\_\+worker}} (params, constants, workspace, psi, tol, x\+\_\+adj\+\_\+lpb, x\+\_\+adj\+\_\+lpb\+\_\+niter, x\+\_\+adj\+\_\+lpb\+\_\+time, x\+\_\+adj\+\_\+lpb\+\_\+rel\+\_\+diff)
\item 
subroutine \mbox{\hyperlink{namespaceddx__lpb_a3677bc2ef7f1c6d1d6f94e2a859bcd84}{ddlpb\+\_\+force\+\_\+worker}} (params, constants, workspace, hessian, phi\+\_\+grid, gradphi, x, x\+\_\+adj, zeta, force)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
High-\/level subroutines for ddlpb. 

\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespaceddx__lpb_a13892ac674290cc45ad9b10de75cd3b4}\label{namespaceddx__lpb_a13892ac674290cc45ad9b10de75cd3b4}} 
\index{ddx\_lpb@{ddx\_lpb}!ddlpb\_solve@{ddlpb\_solve}}
\index{ddlpb\_solve@{ddlpb\_solve}!ddx\_lpb@{ddx\_lpb}}
\doxysubsubsection{\texorpdfstring{ddlpb\_solve()}{ddlpb\_solve()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+lpb\+::ddlpb\+\_\+solve (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(inout)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{type(\mbox{\hyperlink{structddx__core_1_1ddx__state__type}{ddx\+\_\+state\+\_\+type}}), intent(inout)}]{state,  }\item[{real(dp), dimension(constants \% ncav), intent(in)}]{phi\+\_\+cav,  }\item[{real(dp), dimension(3, constants \% ncav), intent(in)}]{gradphi\+\_\+cav,  }\item[{real(dp), intent(in)}]{tol }\end{DoxyParamCaption})}



dd\+LPB solver 

Wrapper routine for the solution of the direct dd\+LPB linear system. It makes the interface easier to implement. If a fine control is needed, the worker routine should be directly called.


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em params} & \+: General options \\
\hline
\mbox{\texttt{ in}}  & {\em constants} & \+: Precomputed constants \\
\hline
\mbox{\texttt{ in,out}}  & {\em workspace} & \+: Preallocated workspaces \\
\hline
\mbox{\texttt{ in,out}}  & {\em state} & \+: Solutions, guesses and relevant quantities \\
\hline
\mbox{\texttt{ in}}  & {\em phi\+\_\+cav} & \+: Electric potential at the grid points \\
\hline
\mbox{\texttt{ in}}  & {\em gradphi\+\_\+cav} & \+: Electric field at the grid points \\
\hline
\mbox{\texttt{ in}}  & {\em tol} & \+: Tolerance for the iterative solvers \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__lpb_8f90_source_l00065}{65}} of file \mbox{\hyperlink{ddx__lpb_8f90_source}{ddx\+\_\+lpb.\+f90}}.

\mbox{\Hypertarget{namespaceddx__lpb_a1906e7ae3780af8ec216f3f078129bd0}\label{namespaceddx__lpb_a1906e7ae3780af8ec216f3f078129bd0}} 
\index{ddx\_lpb@{ddx\_lpb}!ddlpb\_adjoint@{ddlpb\_adjoint}}
\index{ddlpb\_adjoint@{ddlpb\_adjoint}!ddx\_lpb@{ddx\_lpb}}
\doxysubsubsection{\texorpdfstring{ddlpb\_adjoint()}{ddlpb\_adjoint()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+lpb\+::ddlpb\+\_\+adjoint (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(inout)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{type(\mbox{\hyperlink{structddx__core_1_1ddx__state__type}{ddx\+\_\+state\+\_\+type}}), intent(inout)}]{state,  }\item[{real(dp), dimension(constants \% nbasis, params \% nsph), intent(in)}]{psi,  }\item[{real(dp), intent(in)}]{tol }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__lpb_8f90_source_l00095}{95}} of file \mbox{\hyperlink{ddx__lpb_8f90_source}{ddx\+\_\+lpb.\+f90}}.

\mbox{\Hypertarget{namespaceddx__lpb_a712455dd9c9e04156fcfd482db62a831}\label{namespaceddx__lpb_a712455dd9c9e04156fcfd482db62a831}} 
\index{ddx\_lpb@{ddx\_lpb}!ddlpb\_force@{ddlpb\_force}}
\index{ddlpb\_force@{ddlpb\_force}!ddx\_lpb@{ddx\_lpb}}
\doxysubsubsection{\texorpdfstring{ddlpb\_force()}{ddlpb\_force()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+lpb\+::ddlpb\+\_\+force (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(in)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{type(\mbox{\hyperlink{structddx__core_1_1ddx__state__type}{ddx\+\_\+state\+\_\+type}}), intent(inout)}]{state,  }\item[{real(dp), dimension(constants \% ncav), intent(in)}]{phi\+\_\+cav,  }\item[{real(dp), dimension(3, constants \% ncav), intent(in)}]{gradphi\+\_\+cav,  }\item[{real(dp), dimension(3, 3, constants \% ncav), intent(in)}]{hessianphi\+\_\+cav,  }\item[{real(dp), dimension(constants \% nbasis, params \% nsph), intent(in)}]{psi,  }\item[{real(dp), dimension(3, params \% nsph), intent(out)}]{force }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__lpb_8f90_source_l00125}{125}} of file \mbox{\hyperlink{ddx__lpb_8f90_source}{ddx\+\_\+lpb.\+f90}}.

\mbox{\Hypertarget{namespaceddx__lpb_ac267907f835f42a6b87d64954cc9276b}\label{namespaceddx__lpb_ac267907f835f42a6b87d64954cc9276b}} 
\index{ddx\_lpb@{ddx\_lpb}!ddlpb\_guess@{ddlpb\_guess}}
\index{ddlpb\_guess@{ddlpb\_guess}!ddx\_lpb@{ddx\_lpb}}
\doxysubsubsection{\texorpdfstring{ddlpb\_guess()}{ddlpb\_guess()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+lpb\+::ddlpb\+\_\+guess (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(in)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__core_1_1ddx__state__type}{ddx\+\_\+state\+\_\+type}}), intent(inout)}]{state }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__lpb_8f90_source_l00143}{143}} of file \mbox{\hyperlink{ddx__lpb_8f90_source}{ddx\+\_\+lpb.\+f90}}.

\mbox{\Hypertarget{namespaceddx__lpb_ac7bb64b6631ee97ee4077d711349cb85}\label{namespaceddx__lpb_ac7bb64b6631ee97ee4077d711349cb85}} 
\index{ddx\_lpb@{ddx\_lpb}!ddlpb@{ddlpb}}
\index{ddlpb@{ddlpb}!ddx\_lpb@{ddx\_lpb}}
\doxysubsubsection{\texorpdfstring{ddlpb()}{ddlpb()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+lpb\+::ddlpb (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(inout)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{type(\mbox{\hyperlink{structddx__core_1_1ddx__state__type}{ddx\+\_\+state\+\_\+type}}), intent(inout)}]{state,  }\item[{real(dp), dimension(constants \% ncav), intent(in)}]{phi\+\_\+cav,  }\item[{real(dp), dimension(3, constants \% ncav), intent(in)}]{gradphi\+\_\+cav,  }\item[{real(dp), dimension(3, 3, constants \% ncav), intent(in)}]{hessianphi\+\_\+cav,  }\item[{real(dp), dimension( constants \% nbasis,  params \% nsph), intent(in)}]{psi,  }\item[{real(dp), intent(in)}]{tol,  }\item[{real(dp), intent(out)}]{esolv,  }\item[{real(dp), dimension(3, params \% nsph), intent(out)}]{force,  }\item[{integer, intent(inout)}]{info }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__lpb_8f90_source_l00160}{160}} of file \mbox{\hyperlink{ddx__lpb_8f90_source}{ddx\+\_\+lpb.\+f90}}.

\mbox{\Hypertarget{namespaceddx__lpb_abd1c32f7ef61ae0f5653c8a651f8a0e5}\label{namespaceddx__lpb_abd1c32f7ef61ae0f5653c8a651f8a0e5}} 
\index{ddx\_lpb@{ddx\_lpb}!ddlpb\_solve\_worker@{ddlpb\_solve\_worker}}
\index{ddlpb\_solve\_worker@{ddlpb\_solve\_worker}!ddx\_lpb@{ddx\_lpb}}
\doxysubsubsection{\texorpdfstring{ddlpb\_solve\_worker()}{ddlpb\_solve\_worker()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+lpb\+::ddlpb\+\_\+solve\+\_\+worker (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(inout)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{real(dp), dimension(constants \% ncav), intent(in)}]{phi\+\_\+cav,  }\item[{real(dp), dimension(3, constants \% ncav), intent(in)}]{gradphi\+\_\+cav,  }\item[{real(dp), dimension(params \% ngrid, params \% nsph), intent(out)}]{g\+\_\+lpb,  }\item[{real(dp), dimension(params \% ngrid, params \% nsph), intent(out)}]{f\+\_\+lpb,  }\item[{real(dp), dimension(params \% ngrid, params \% nsph), intent(out)}]{phi\+\_\+grid,  }\item[{real(dp), dimension(constants \% nbasis, params \% nsph, 2), intent(inout)}]{x\+\_\+lpb,  }\item[{integer, intent(inout)}]{x\+\_\+lpb\+\_\+niter,  }\item[{real(dp), intent(out)}]{x\+\_\+lpb\+\_\+time,  }\item[{real(dp), dimension(x\+\_\+lpb\+\_\+niter), intent(out)}]{x\+\_\+lpb\+\_\+rel\+\_\+diff,  }\item[{real(dp), intent(in)}]{tol }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__lpb_8f90_source_l00194}{194}} of file \mbox{\hyperlink{ddx__lpb_8f90_source}{ddx\+\_\+lpb.\+f90}}.

\mbox{\Hypertarget{namespaceddx__lpb_ac060c5a84b80af1d44e392ba24966368}\label{namespaceddx__lpb_ac060c5a84b80af1d44e392ba24966368}} 
\index{ddx\_lpb@{ddx\_lpb}!ddlpb\_adjoint\_worker@{ddlpb\_adjoint\_worker}}
\index{ddlpb\_adjoint\_worker@{ddlpb\_adjoint\_worker}!ddx\_lpb@{ddx\_lpb}}
\doxysubsubsection{\texorpdfstring{ddlpb\_adjoint\_worker()}{ddlpb\_adjoint\_worker()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+lpb\+::ddlpb\+\_\+adjoint\+\_\+worker (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(inout)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{real(dp), dimension(constants \% nbasis, params \% nsph), intent(in)}]{psi,  }\item[{real(dp), intent(in)}]{tol,  }\item[{real(dp), dimension(constants \% nbasis, params \% nsph, 2), intent(out)}]{x\+\_\+adj\+\_\+lpb,  }\item[{integer, intent(inout)}]{x\+\_\+adj\+\_\+lpb\+\_\+niter,  }\item[{real(dp), intent(out)}]{x\+\_\+adj\+\_\+lpb\+\_\+time,  }\item[{real(dp), dimension(x\+\_\+adj\+\_\+lpb\+\_\+niter), intent(out)}]{x\+\_\+adj\+\_\+lpb\+\_\+rel\+\_\+diff }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__lpb_8f90_source_l00271}{271}} of file \mbox{\hyperlink{ddx__lpb_8f90_source}{ddx\+\_\+lpb.\+f90}}.

\mbox{\Hypertarget{namespaceddx__lpb_a3677bc2ef7f1c6d1d6f94e2a859bcd84}\label{namespaceddx__lpb_a3677bc2ef7f1c6d1d6f94e2a859bcd84}} 
\index{ddx\_lpb@{ddx\_lpb}!ddlpb\_force\_worker@{ddlpb\_force\_worker}}
\index{ddlpb\_force\_worker@{ddlpb\_force\_worker}!ddx\_lpb@{ddx\_lpb}}
\doxysubsubsection{\texorpdfstring{ddlpb\_force\_worker()}{ddlpb\_force\_worker()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+lpb\+::ddlpb\+\_\+force\+\_\+worker (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(in)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{real(dp), dimension(3, 3, constants \% ncav), intent(in)}]{hessian,  }\item[{real(dp), dimension(params \% ngrid, params \% nsph), intent(in)}]{phi\+\_\+grid,  }\item[{real(dp), dimension(3, constants \% ncav), intent(in)}]{gradphi,  }\item[{real(dp), dimension(constants \% nbasis, params \% nsph, 2), intent(in)}]{x,  }\item[{real(dp), dimension(constants \% nbasis, params \% nsph, 2), intent(in)}]{x\+\_\+adj,  }\item[{real(dp), dimension(constants \% ncav), intent(out)}]{zeta,  }\item[{real(dp), dimension(3, params \% nsph), intent(out)}]{force }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__lpb_8f90_source_l00317}{317}} of file \mbox{\hyperlink{ddx__lpb_8f90_source}{ddx\+\_\+lpb.\+f90}}.

