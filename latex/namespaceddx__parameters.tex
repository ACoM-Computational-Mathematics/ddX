\hypertarget{namespaceddx__parameters}{}\doxysection{ddx\+\_\+parameters Module Reference}
\label{namespaceddx__parameters}\index{ddx\_parameters@{ddx\_parameters}}


Module to treat properly user input parameters.  


\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}
\begin{DoxyCompactList}\small\item\em Type to check and store user input parameters. \end{DoxyCompactList}\item 
interface \mbox{\hyperlink{interfaceddx__parameters_1_1print__func__interface}{print\+\_\+func\+\_\+interface}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespaceddx__parameters_a37d40289550bb6eb8e049fb4ca227c2c}{params\+\_\+init}} (model, force, eps, kappa, eta, se, lmax, ngrid, matvecmem, itersolver, maxiter, jacobi\+\_\+ndiis, gmresr\+\_\+j, gmresr\+\_\+dim, fmm, pm, pl, nproc, nsph, charge, csph, rsph, print\+\_\+func, params, info)
\begin{DoxyCompactList}\small\item\em Initialize and check input parameters. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__parameters_ab58f264af44239d745e1a571c1850576}{params\+\_\+print}} (params)
\begin{DoxyCompactList}\small\item\em Print header with parameters. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__parameters_a41f19aa9b4b7798b5374fa3f6a03ea00}{params\+\_\+deinit}} (params, info)
\begin{DoxyCompactList}\small\item\em Free memory used by parameters. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__parameters_a1b84e0732491759d44bb63d14f7c77a5}{closest\+\_\+supported\+\_\+lebedev\+\_\+grid}} (ngrid)
\begin{DoxyCompactList}\small\item\em Adjust a guess for the number of Lebedev grid points. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__parameters_ab4ce0e49948cbfb16876f79a8e753bac}{error}} (code, message)
\begin{DoxyCompactList}\small\item\em Print error message and exit with provided error code. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__parameters_a63f973043b80c39c6f905fba9bd2aa09}{print\+\_\+func\+\_\+default}} (string)
\begin{DoxyCompactList}\small\item\em Default printing function. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__parameters_a614dba0082e404515273ec7a251e4902}{params\+\_\+free}} (params, info)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Module to treat properly user input parameters. 

\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespaceddx__parameters_a37d40289550bb6eb8e049fb4ca227c2c}\label{namespaceddx__parameters_a37d40289550bb6eb8e049fb4ca227c2c}} 
\index{ddx\_parameters@{ddx\_parameters}!params\_init@{params\_init}}
\index{params\_init@{params\_init}!ddx\_parameters@{ddx\_parameters}}
\doxysubsubsection{\texorpdfstring{params\_init()}{params\_init()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+parameters\+::params\+\_\+init (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{model,  }\item[{integer, intent(in)}]{force,  }\item[{real(dp), intent(in)}]{eps,  }\item[{real(dp), intent(in)}]{kappa,  }\item[{real(dp), intent(in)}]{eta,  }\item[{real(dp), intent(in)}]{se,  }\item[{integer, intent(in)}]{lmax,  }\item[{integer, intent(in)}]{ngrid,  }\item[{integer, intent(in)}]{matvecmem,  }\item[{integer, intent(in)}]{itersolver,  }\item[{integer, intent(in)}]{maxiter,  }\item[{integer, intent(in)}]{jacobi\+\_\+ndiis,  }\item[{integer, intent(in)}]{gmresr\+\_\+j,  }\item[{integer, intent(in)}]{gmresr\+\_\+dim,  }\item[{integer, intent(in)}]{fmm,  }\item[{integer, intent(in)}]{pm,  }\item[{integer, intent(in)}]{pl,  }\item[{integer, intent(in)}]{nproc,  }\item[{integer, intent(in)}]{nsph,  }\item[{real(dp), dimension(nsph), intent(in)}]{charge,  }\item[{real(dp), dimension(3, nsph), intent(in)}]{csph,  }\item[{real(dp), dimension(nsph), intent(in)}]{rsph,  }\item[{procedure(\mbox{\hyperlink{interfaceddx__parameters_1_1print__func__interface}{print\+\_\+func\+\_\+interface}})}]{print\+\_\+func,  }\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(out)}]{params,  }\item[{integer, intent(out)}]{info }\end{DoxyParamCaption})}



Initialize and check input parameters. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em model} & Choose model\+: 1 for COSMO, 2 for PCM and 3 for LPB. \\
\hline
\mbox{\texttt{ in}}  & {\em force} & 1 if forces will probably be required and 0 otherwise. \\
\hline
\mbox{\texttt{ in}}  & {\em eps} & Relative dielectric permittivity. eps \texorpdfstring{$>$}{>} 1. \\
\hline
\mbox{\texttt{ in}}  & {\em kappa} & Debye-\/H"{}\{u\}ckel parameter. kappa \texorpdfstring{$>$}{>} 0. Referenced only if the model is LPB. \\
\hline
\mbox{\texttt{ in}}  & {\em eta} & Regularization parameter. 0 \texorpdfstring{$<$}{<} eta \texorpdfstring{$<$}{<}= 1. \\
\hline
\mbox{\texttt{ in}}  & {\em se} & Shift of the regularization. -\/1 for interior, 0 for centered and 1 for outer regularization. \\
\hline
\mbox{\texttt{ in}}  & {\em lmax} & Maximal degree of modeling spherical harmonics. {\ttfamily lmax} \texorpdfstring{$>$}{>}= 0. \\
\hline
\mbox{\texttt{ in}}  & {\em ngrid} & Number of Lebedev grid points {\ttfamily ngrid} \texorpdfstring{$>$}{>}= 0. \\
\hline
\mbox{\texttt{ in}}  & {\em matvecmem} & handling of sparse matrices. 1 for precomputing them and keeping them in memory, 0 for direct matrix-\/vector products. \\
\hline
\mbox{\texttt{ in}}  & {\em itersolver} & Iterative solver to be used. 1 for Jacobi iterative solver. Other solvers might be added later. \\
\hline
\mbox{\texttt{ in}}  & {\em maxiter} & Maximum number of iterations for an iterative solver. maxiter \texorpdfstring{$>$}{>} 0. \\
\hline
\mbox{\texttt{ in}}  & {\em jacobi\+\_\+ndiis} & Number of extrapolation points for Jacobi/\+DIIS solver. ndiis \texorpdfstring{$>$}{>}= 1. \\
\hline
\mbox{\texttt{ in}}  & {\em fmm} & 1 to use FMM acceleration and 0 otherwise. \\
\hline
\mbox{\texttt{ in}}  & {\em pm} & Maximal degree of multipole spherical harmonics. Ignored in the case {\ttfamily fmm=0}. Value -\/1 means no far-\/field FMM interactions are computed. {\ttfamily pm} \texorpdfstring{$>$}{>}= -\/1. \\
\hline
\mbox{\texttt{ in}}  & {\em pl} & Maximal degree of local spherical harmonics. Ignored in the case {\ttfamily fmm=0}. Value -\/1 means no far-\/field FMM interactions are computed. {\ttfamily pl} \texorpdfstring{$>$}{>}= -\/1. \\
\hline
\mbox{\texttt{ in}}  & {\em nproc} & Number of Open\+MP threads to be used where applicable. nproc \texorpdfstring{$>$}{>}= 0. If input nproc=0 then a default number of threads, controlled by the environment variable {\ttfamily OMP\+\_\+\+NUM\+\_\+\+THREADS} during runtime, will be used. If Open\+MP support in ddX is disabled, only possible input values are 0 or 1 and both inputs lead to the same output nproc=1 since the library is not parallel. \\
\hline
\mbox{\texttt{ in}}  & {\em nsph} & Number of atoms. nsph \texorpdfstring{$>$}{>} 0. \\
\hline
\mbox{\texttt{ in}}  & {\em charge} & Charges of atoms. Dimension is {\ttfamily (nsph)}. \\
\hline
\mbox{\texttt{ in}}  & {\em csph} & Coordinates of atoms. Dimension is {\ttfamily (3, nsph)}. \\
\hline
\mbox{\texttt{ in}}  & {\em rsph} & Van-\/der-\/\+Waals radii of atoms. Dimension is {\ttfamily (nsph)}. \\
\hline
\mbox{\texttt{ in}}  & {\em print\+\_\+func} & Function to print errors. \\
\hline
\mbox{\texttt{ out}}  & {\em params} & Object containing all inputs. \\
\hline
\mbox{\texttt{ out}}  & {\em info} & flag of succesfull exit = 0\+: Succesfull exit = -\/1\+: One of the arguments had an illegal value, check params \% error\+\_\+message = 1\+: Allocation of memory to copy geometry data failed. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__parameters_8f90_source_l00147}{147}} of file \mbox{\hyperlink{ddx__parameters_8f90_source}{ddx\+\_\+parameters.\+f90}}.

\mbox{\Hypertarget{namespaceddx__parameters_ab58f264af44239d745e1a571c1850576}\label{namespaceddx__parameters_ab58f264af44239d745e1a571c1850576}} 
\index{ddx\_parameters@{ddx\_parameters}!params\_print@{params\_print}}
\index{params\_print@{params\_print}!ddx\_parameters@{ddx\_parameters}}
\doxysubsubsection{\texorpdfstring{params\_print()}{params\_print()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+parameters\+::params\+\_\+print (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params }\end{DoxyParamCaption})}



Print header with parameters. 



Definition at line \mbox{\hyperlink{ddx__parameters_8f90_source_l00443}{443}} of file \mbox{\hyperlink{ddx__parameters_8f90_source}{ddx\+\_\+parameters.\+f90}}.

\mbox{\Hypertarget{namespaceddx__parameters_a41f19aa9b4b7798b5374fa3f6a03ea00}\label{namespaceddx__parameters_a41f19aa9b4b7798b5374fa3f6a03ea00}} 
\index{ddx\_parameters@{ddx\_parameters}!params\_deinit@{params\_deinit}}
\index{params\_deinit@{params\_deinit}!ddx\_parameters@{ddx\_parameters}}
\doxysubsubsection{\texorpdfstring{params\_deinit()}{params\_deinit()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+parameters\+::params\+\_\+deinit (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(inout)}]{params,  }\item[{integer, intent(out)}]{info }\end{DoxyParamCaption})}



Free memory used by parameters. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in,out}}  & {\em params} & Object containing all inputs \\
\hline
\mbox{\texttt{ out}}  & {\em info} & flag of succesfull exit = 0\+: Succesfull exit = -\/1\+: params is in error state = 1\+: Deallocation of memory failed. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__parameters_8f90_source_l00505}{505}} of file \mbox{\hyperlink{ddx__parameters_8f90_source}{ddx\+\_\+parameters.\+f90}}.

\mbox{\Hypertarget{namespaceddx__parameters_a1b84e0732491759d44bb63d14f7c77a5}\label{namespaceddx__parameters_a1b84e0732491759d44bb63d14f7c77a5}} 
\index{ddx\_parameters@{ddx\_parameters}!closest\_supported\_lebedev\_grid@{closest\_supported\_lebedev\_grid}}
\index{closest\_supported\_lebedev\_grid@{closest\_supported\_lebedev\_grid}!ddx\_parameters@{ddx\_parameters}}
\doxysubsubsection{\texorpdfstring{closest\_supported\_lebedev\_grid()}{closest\_supported\_lebedev\_grid()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+parameters\+::closest\+\_\+supported\+\_\+lebedev\+\_\+grid (\begin{DoxyParamCaption}\item[{integer, intent(inout)}]{ngrid }\end{DoxyParamCaption})}



Adjust a guess for the number of Lebedev grid points. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in,out}}  & {\em ngrid} & Approximate number of Lebedev grid points on input and actual number of grid points on exit. {\ttfamily ngrid} \texorpdfstring{$>$}{>}= 0 \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__parameters_8f90_source_l00547}{547}} of file \mbox{\hyperlink{ddx__parameters_8f90_source}{ddx\+\_\+parameters.\+f90}}.

\mbox{\Hypertarget{namespaceddx__parameters_ab4ce0e49948cbfb16876f79a8e753bac}\label{namespaceddx__parameters_ab4ce0e49948cbfb16876f79a8e753bac}} 
\index{ddx\_parameters@{ddx\_parameters}!error@{error}}
\index{error@{error}!ddx\_parameters@{ddx\_parameters}}
\doxysubsubsection{\texorpdfstring{error()}{error()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+parameters\+::error (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{code,  }\item[{character(len=$\ast$), intent(in)}]{message }\end{DoxyParamCaption})}



Print error message and exit with provided error code. 



Definition at line \mbox{\hyperlink{ddx__parameters_8f90_source_l00564}{564}} of file \mbox{\hyperlink{ddx__parameters_8f90_source}{ddx\+\_\+parameters.\+f90}}.

\mbox{\Hypertarget{namespaceddx__parameters_a63f973043b80c39c6f905fba9bd2aa09}\label{namespaceddx__parameters_a63f973043b80c39c6f905fba9bd2aa09}} 
\index{ddx\_parameters@{ddx\_parameters}!print\_func\_default@{print\_func\_default}}
\index{print\_func\_default@{print\_func\_default}!ddx\_parameters@{ddx\_parameters}}
\doxysubsubsection{\texorpdfstring{print\_func\_default()}{print\_func\_default()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+parameters\+::print\+\_\+func\+\_\+default (\begin{DoxyParamCaption}\item[{character(len=255), intent(in)}]{string }\end{DoxyParamCaption})}



Default printing function. 



Definition at line \mbox{\hyperlink{ddx__parameters_8f90_source_l00574}{574}} of file \mbox{\hyperlink{ddx__parameters_8f90_source}{ddx\+\_\+parameters.\+f90}}.

\mbox{\Hypertarget{namespaceddx__parameters_a614dba0082e404515273ec7a251e4902}\label{namespaceddx__parameters_a614dba0082e404515273ec7a251e4902}} 
\index{ddx\_parameters@{ddx\_parameters}!params\_free@{params\_free}}
\index{params\_free@{params\_free}!ddx\_parameters@{ddx\_parameters}}
\doxysubsubsection{\texorpdfstring{params\_free()}{params\_free()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+parameters\+::params\+\_\+free (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(out)}]{params,  }\item[{integer, intent(out)}]{info }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{ddx__parameters_8f90_source_l00580}{580}} of file \mbox{\hyperlink{ddx__parameters_8f90_source}{ddx\+\_\+parameters.\+f90}}.

