\hypertarget{namespaceddx__multipolar__solutes}{}\doxysection{ddx\+\_\+multipolar\+\_\+solutes Module Reference}
\label{namespaceddx__multipolar__solutes}\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}


Routines to build rhs (phi and psi)  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{namespaceddx__multipolar__solutes_abec05c36e4683b034461ddea3f93c3a0}{build\+\_\+g}} (params, constants, workspace, multipoles, mmax, phi\+\_\+cav, e\+\_\+cav, g\+\_\+cav)
\begin{DoxyCompactList}\small\item\em Given a multipolar distribution, compute the potential, its gradient and its hessian at the target points this is done with or without FMMs depending on the relevant flag The multipoles must be centered on the ddx spheres. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__multipolar__solutes_a21901e893cf9a0e6b74c213e77e2e6bb}{build\+\_\+g\+\_\+dense}} (multipoles, cm, mmax, nm, phi\+\_\+cav, ccav, ncav, e\+\_\+cav, g\+\_\+cav)
\begin{DoxyCompactList}\small\item\em Given a multipolar distribution, compute the potential, its gradient and its hessian at the target points using a N$^\wedge$2 code. As this routine does not use the FMM machinery it is more flexible and accepts arbitrary sources and targets. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__multipolar__solutes_aee11a592e3b3b9b12a28554e220ba202}{build\+\_\+e}} (params, constants, workspace, multipoles, mmax, phi\+\_\+cav, e\+\_\+cav)
\begin{DoxyCompactList}\small\item\em Given a multipolar distribution, compute the potential and its gradient at the target points this is done with or without FMMs depending on the relevant flag The multipoles must be centered on the ddx spheres. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__multipolar__solutes_a2fa1001009a00125a7578e2fd7b56352}{build\+\_\+e\+\_\+dense}} (multipoles, cm, mmax, nm, phi\+\_\+cav, ccav, ncav, e\+\_\+cav)
\begin{DoxyCompactList}\small\item\em Given a multipolar distribution, compute the potential and its gradient at the target points using a N$^\wedge$2 code. As this routine does not use the FMM machinery it is more flexible and accepts arbitrary sources and targets. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__multipolar__solutes_a6611268f56ee74f9f64df0915594f8c7}{build\+\_\+phi}} (params, constants, workspace, multipoles, mmax, phi\+\_\+cav)
\begin{DoxyCompactList}\small\item\em Given a multipolar distribution, compute the potential at the target points this is done with or without FMMs depending on the relevant flag The multipoles must be centered on the ddx spheres. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__multipolar__solutes_a90fbfc445edad120a60b87d5360d557f}{build\+\_\+phi\+\_\+dense}} (multipoles, cm, mmax, nm, phi\+\_\+cav, ccav, ncav)
\begin{DoxyCompactList}\small\item\em Given a multipolar distribution, compute the potential at the target points using a N$^\wedge$2 code. As this routine does not use the FMM machinery it is more flexible and accepts arbitrary sources and targets. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__multipolar__solutes_adb70b786db1e8751f7c5b7faed714f41}{build\+\_\+e\+\_\+fmm}} (params, constants, workspace, multipoles, mmax, phi\+\_\+cav, e\+\_\+cav)
\begin{DoxyCompactList}\small\item\em Given a multipolar distribution, compute the potential and its gradient at the target points using FMMs. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__multipolar__solutes_a1b49c60c09fb229e96a9ce69d0808c8d}{build\+\_\+phi\+\_\+fmm}} (params, constants, workspace, multipoles, mmax, phi\+\_\+cav)
\begin{DoxyCompactList}\small\item\em Given a multipolar distribution, compute the potential at the target points using FMMs. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__multipolar__solutes_a5c89baf7330431c44d60f075ab516c5f}{build\+\_\+psi}} (params, constants, workspace, multipoles, mmax, psi)
\begin{DoxyCompactList}\small\item\em Given a multipolar distribution, assemble the RHS psi. The multipoles must be centered on the ddx spheres. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__multipolar__solutes_a61c22d6edf664b23153d1d41a1036db8}{load\+\_\+m}} (params, constants, workspace, multipoles, mmax)
\begin{DoxyCompactList}\small\item\em Given a multipolar distribution, load it into workspace \% tmp\+\_\+sph and workspace \% tmp\+\_\+node\+\_\+m to be used by the FMM. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__multipolar__solutes_a854e543bad7f9523b75ce5037fed9bc9}{do\+\_\+fmm}} (params, constants, workspace)
\begin{DoxyCompactList}\small\item\em Given a multipolar distribution loaded in the workspace perform the M2M, M2L, L2L and L2P steps. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__multipolar__solutes_a215cf69da966942d80f48639e5cd97d2}{grad\+\_\+m2m}} (multipoles, mmax, nm, tmp\+\_\+m\+\_\+grad)
\begin{DoxyCompactList}\small\item\em Given a multipolar distribution compute the action of dP on it, this is required in the computation of the forces. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__multipolar__solutes_aa56314068d15524fdb496363a8bd621f}{grad\+\_\+phi\+\_\+for\+\_\+charges}} (params, constants, workspace, state, mmax, multipoles, forces, e\+\_\+cav)
\begin{DoxyCompactList}\small\item\em Given a charge distribution centered on the spheres, compute the contributions to the forces stemming from its electrostatic interactions. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__multipolar__solutes_a29181299be03f0bb493cfd4cfb928a0b}{grad\+\_\+phi}} (params, constants, workspace, state, mmax, multipoles, forces, e\+\_\+cav)
\begin{DoxyCompactList}\small\item\em Given a multipolar distribution in real spherical harmonics and centered on the spheres, compute the contributions to the forces stemming from its electrostatic interactions. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__multipolar__solutes_a9a9fa5a29ff449db9444710b285bcd80}{build\+\_\+adj\+\_\+phi}} (params, constants, workspace, charges, mmax, adj\+\_\+phi)
\begin{DoxyCompactList}\small\item\em Given a distribution of point charges at the cavity points, compute the potential and its higher order derivatives up to pmax at the center of the spheres. This is done with or without the FMMs depending on the given flag. This is used in the computation of the forces. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__multipolar__solutes_ac565e05e02661402639fae28bdacc577}{build\+\_\+adj\+\_\+phi\+\_\+dense}} (qcav, ccav, ncav, cm, mmax, nm, adj\+\_\+phi)
\begin{DoxyCompactList}\small\item\em Given a distribution of point charges at the cavity points, compute the potential and its higher order derivatives up to pmax at the center of the spheres. This is done using two loops and required in the computation of the forces. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceddx__multipolar__solutes_a3a1c0765efbf39c7ef1a0cc2b6c1b826}{build\+\_\+adj\+\_\+phi\+\_\+fmm}} (params, constants, workspace, charges, mmax, adj\+\_\+phi)
\begin{DoxyCompactList}\small\item\em Given a distribution of point charges at the cavity points, compute the potential and its higher order derivatives up to pmax at the center of the spheres. This is done with FMMs and required in the computation of the forces. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Routines to build rhs (phi and psi) 

\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespaceddx__multipolar__solutes_abec05c36e4683b034461ddea3f93c3a0}\label{namespaceddx__multipolar__solutes_abec05c36e4683b034461ddea3f93c3a0}} 
\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}!build\_g@{build\_g}}
\index{build\_g@{build\_g}!ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}
\doxysubsubsection{\texorpdfstring{build\_g()}{build\_g()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+multipolar\+\_\+solutes\+::build\+\_\+g (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(in)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{real(dp), dimension((mmax + 1)$\ast$$\ast$2, params \% nsph), intent(in)}]{multipoles,  }\item[{integer, intent(in)}]{mmax,  }\item[{real(dp), dimension(constants \% ncav), intent(out)}]{phi\+\_\+cav,  }\item[{real(dp), dimension(3, constants \% ncav), intent(out)}]{e\+\_\+cav,  }\item[{real(dp), dimension(3, 3, constants \% ncav), intent(out)}]{g\+\_\+cav }\end{DoxyParamCaption})}



Given a multipolar distribution, compute the potential, its gradient and its hessian at the target points this is done with or without FMMs depending on the relevant flag The multipoles must be centered on the ddx spheres. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em params} & ddx parameters \\
\hline
\mbox{\texttt{ in}}  & {\em constants} & ddx constants \\
\hline
\mbox{\texttt{ in,out}}  & {\em workspace} & ddx workspace \\
\hline
\mbox{\texttt{ in}}  & {\em multipoles} & multipoles as real spherical harmonics, size ((mmax+1)$\ast$$\ast$2, nsph) \\
\hline
\mbox{\texttt{ in}}  & {\em mmax} & maximum angular momentum of the multipoles \\
\hline
\mbox{\texttt{ out}}  & {\em phi\+\_\+cav} & electric potential at the target points, size (ncav) \\
\hline
\mbox{\texttt{ out}}  & {\em e\+\_\+cav} & electric field at the target points, size (3, ncav) \\
\hline
\mbox{\texttt{ out}}  & {\em g\+\_\+cav} & electric field gradient at the target points, size (3, 3, ncav) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source_l00027}{27}} of file \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source}{ddx\+\_\+multipolar\+\_\+solutes.\+f90}}.

\mbox{\Hypertarget{namespaceddx__multipolar__solutes_a21901e893cf9a0e6b74c213e77e2e6bb}\label{namespaceddx__multipolar__solutes_a21901e893cf9a0e6b74c213e77e2e6bb}} 
\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}!build\_g\_dense@{build\_g\_dense}}
\index{build\_g\_dense@{build\_g\_dense}!ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}
\doxysubsubsection{\texorpdfstring{build\_g\_dense()}{build\_g\_dense()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+multipolar\+\_\+solutes\+::build\+\_\+g\+\_\+dense (\begin{DoxyParamCaption}\item[{real(dp), dimension((mmax + 1)$\ast$$\ast$2, nm), intent(in)}]{multipoles,  }\item[{real(dp), dimension(3, nm), intent(in)}]{cm,  }\item[{integer, intent(in)}]{mmax,  }\item[{integer, intent(in)}]{nm,  }\item[{real(dp), dimension(ncav), intent(out)}]{phi\+\_\+cav,  }\item[{real(dp), dimension(3, ncav), intent(in)}]{ccav,  }\item[{integer, intent(in)}]{ncav,  }\item[{real(dp), dimension(3, ncav), intent(out)}]{e\+\_\+cav,  }\item[{real(dp), dimension(3, 3, ncav), intent(out)}]{g\+\_\+cav }\end{DoxyParamCaption})}



Given a multipolar distribution, compute the potential, its gradient and its hessian at the target points using a N$^\wedge$2 code. As this routine does not use the FMM machinery it is more flexible and accepts arbitrary sources and targets. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em multipoles} & multipoles as real spherical harmonics, size ((mmax+1)$\ast$$\ast$2,nm) \\
\hline
\mbox{\texttt{ in}}  & {\em cm} & centers of the multipolar distributions, size (3,nm) \\
\hline
\mbox{\texttt{ in}}  & {\em mmax} & maximum angular momentum of the multipoles \\
\hline
\mbox{\texttt{ in}}  & {\em nm} & number of multipoles \\
\hline
\mbox{\texttt{ out}}  & {\em phi\+\_\+cav} & electric potential at the target points, size (ncav) \\
\hline
\mbox{\texttt{ out}}  & {\em e\+\_\+cav} & electric field at the target points, size (3, ncav) \\
\hline
\mbox{\texttt{ out}}  & {\em g\+\_\+cav} & electric field at the target points, size (3, 3, ncav) \\
\hline
\mbox{\texttt{ in}}  & {\em ccav} & coordinates of the target points, size (3,ncav) \\
\hline
\mbox{\texttt{ in}}  & {\em ncav} & number of target points \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source_l00063}{63}} of file \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source}{ddx\+\_\+multipolar\+\_\+solutes.\+f90}}.

\mbox{\Hypertarget{namespaceddx__multipolar__solutes_aee11a592e3b3b9b12a28554e220ba202}\label{namespaceddx__multipolar__solutes_aee11a592e3b3b9b12a28554e220ba202}} 
\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}!build\_e@{build\_e}}
\index{build\_e@{build\_e}!ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}
\doxysubsubsection{\texorpdfstring{build\_e()}{build\_e()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+multipolar\+\_\+solutes\+::build\+\_\+e (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(in)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{real(dp), dimension((mmax + 1)$\ast$$\ast$2, params \% nsph), intent(in)}]{multipoles,  }\item[{integer, intent(in)}]{mmax,  }\item[{real(dp), dimension(constants \% ncav), intent(out)}]{phi\+\_\+cav,  }\item[{real(dp), dimension(3, constants \% ncav), intent(out)}]{e\+\_\+cav }\end{DoxyParamCaption})}



Given a multipolar distribution, compute the potential and its gradient at the target points this is done with or without FMMs depending on the relevant flag The multipoles must be centered on the ddx spheres. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em params} & ddx parameters \\
\hline
\mbox{\texttt{ in}}  & {\em constants} & ddx constants \\
\hline
\mbox{\texttt{ in,out}}  & {\em workspace} & ddx workspace \\
\hline
\mbox{\texttt{ in}}  & {\em multipoles} & multipoles as real spherical harmonics, size ((mmax+1)$\ast$$\ast$2, nsph) \\
\hline
\mbox{\texttt{ in}}  & {\em mmax} & maximum angular momentum of the multipoles \\
\hline
\mbox{\texttt{ out}}  & {\em phi\+\_\+cav} & electric potential at the target points, size (ncav) \\
\hline
\mbox{\texttt{ out}}  & {\em e\+\_\+cav} & electric field at the target points, size (3, ncav) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source_l00171}{171}} of file \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source}{ddx\+\_\+multipolar\+\_\+solutes.\+f90}}.

\mbox{\Hypertarget{namespaceddx__multipolar__solutes_a2fa1001009a00125a7578e2fd7b56352}\label{namespaceddx__multipolar__solutes_a2fa1001009a00125a7578e2fd7b56352}} 
\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}!build\_e\_dense@{build\_e\_dense}}
\index{build\_e\_dense@{build\_e\_dense}!ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}
\doxysubsubsection{\texorpdfstring{build\_e\_dense()}{build\_e\_dense()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+multipolar\+\_\+solutes\+::build\+\_\+e\+\_\+dense (\begin{DoxyParamCaption}\item[{real(dp), dimension((mmax + 1)$\ast$$\ast$2, nm), intent(in)}]{multipoles,  }\item[{real(dp), dimension(3, nm), intent(in)}]{cm,  }\item[{integer, intent(in)}]{mmax,  }\item[{integer, intent(in)}]{nm,  }\item[{real(dp), dimension(ncav), intent(out)}]{phi\+\_\+cav,  }\item[{real(dp), dimension(3, ncav), intent(in)}]{ccav,  }\item[{integer, intent(in)}]{ncav,  }\item[{real(dp), dimension(3, ncav), intent(out)}]{e\+\_\+cav }\end{DoxyParamCaption})}



Given a multipolar distribution, compute the potential and its gradient at the target points using a N$^\wedge$2 code. As this routine does not use the FMM machinery it is more flexible and accepts arbitrary sources and targets. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em multipoles} & multipoles as real spherical harmonics, size ((mmax+1)$\ast$$\ast$2,nm) \\
\hline
\mbox{\texttt{ in}}  & {\em cm} & centers of the multipolar distributions, size (3,nm) \\
\hline
\mbox{\texttt{ in}}  & {\em mmax} & maximum angular momentum of the multipoles \\
\hline
\mbox{\texttt{ in}}  & {\em nm} & number of multipoles \\
\hline
\mbox{\texttt{ out}}  & {\em phi\+\_\+cav} & electric potential at the target points, size (ncav) \\
\hline
\mbox{\texttt{ out}}  & {\em e\+\_\+cav} & electric field at the target points, size (3, ncav) \\
\hline
\mbox{\texttt{ in}}  & {\em ccav} & coordinates of the target points, size (3,ncav) \\
\hline
\mbox{\texttt{ in}}  & {\em ncav} & number of target points \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source_l00204}{204}} of file \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source}{ddx\+\_\+multipolar\+\_\+solutes.\+f90}}.

\mbox{\Hypertarget{namespaceddx__multipolar__solutes_a6611268f56ee74f9f64df0915594f8c7}\label{namespaceddx__multipolar__solutes_a6611268f56ee74f9f64df0915594f8c7}} 
\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}!build\_phi@{build\_phi}}
\index{build\_phi@{build\_phi}!ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}
\doxysubsubsection{\texorpdfstring{build\_phi()}{build\_phi()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+multipolar\+\_\+solutes\+::build\+\_\+phi (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(in)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{real(dp), dimension((mmax + 1)$\ast$$\ast$2, params \% nsph), intent(in)}]{multipoles,  }\item[{integer, intent(in)}]{mmax,  }\item[{real(dp), dimension(constants \% ncav), intent(out)}]{phi\+\_\+cav }\end{DoxyParamCaption})}



Given a multipolar distribution, compute the potential at the target points this is done with or without FMMs depending on the relevant flag The multipoles must be centered on the ddx spheres. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em params} & ddx parameters \\
\hline
\mbox{\texttt{ in}}  & {\em constants} & ddx constants \\
\hline
\mbox{\texttt{ in,out}}  & {\em workspace} & ddx workspace \\
\hline
\mbox{\texttt{ in}}  & {\em multipoles} & multipoles as real spherical harmonics, size ((mmax+1)$\ast$$\ast$2, nsph) \\
\hline
\mbox{\texttt{ in}}  & {\em mmax} & maximum angular momentum of the multipoles \\
\hline
\mbox{\texttt{ out}}  & {\em phi\+\_\+cav} & electric potential at the target points, size (ncav) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source_l00270}{270}} of file \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source}{ddx\+\_\+multipolar\+\_\+solutes.\+f90}}.

\mbox{\Hypertarget{namespaceddx__multipolar__solutes_a90fbfc445edad120a60b87d5360d557f}\label{namespaceddx__multipolar__solutes_a90fbfc445edad120a60b87d5360d557f}} 
\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}!build\_phi\_dense@{build\_phi\_dense}}
\index{build\_phi\_dense@{build\_phi\_dense}!ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}
\doxysubsubsection{\texorpdfstring{build\_phi\_dense()}{build\_phi\_dense()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+multipolar\+\_\+solutes\+::build\+\_\+phi\+\_\+dense (\begin{DoxyParamCaption}\item[{real(dp), dimension((mmax + 1)$\ast$$\ast$2, nm), intent(in)}]{multipoles,  }\item[{real(dp), dimension(3, nm), intent(in)}]{cm,  }\item[{integer, intent(in)}]{mmax,  }\item[{integer, intent(in)}]{nm,  }\item[{real(dp), dimension(ncav), intent(out)}]{phi\+\_\+cav,  }\item[{real(dp), dimension(3, ncav), intent(in)}]{ccav,  }\item[{integer, intent(in)}]{ncav }\end{DoxyParamCaption})}



Given a multipolar distribution, compute the potential at the target points using a N$^\wedge$2 code. As this routine does not use the FMM machinery it is more flexible and accepts arbitrary sources and targets. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em multipoles} & multipoles as real spherical harmonics, size ((mmax+1)$\ast$$\ast$2,nm) \\
\hline
\mbox{\texttt{ in}}  & {\em cm} & centers of the multipolar distributions, size (3,nm) \\
\hline
\mbox{\texttt{ in}}  & {\em mmax} & maximum angular momentum of the multipoles \\
\hline
\mbox{\texttt{ in}}  & {\em nm} & number of multipoles \\
\hline
\mbox{\texttt{ out}}  & {\em phi\+\_\+cav} & electric potential at the target points, size (ncav) \\
\hline
\mbox{\texttt{ in}}  & {\em ccav} & coordinates of the target points, size (3,ncav) \\
\hline
\mbox{\texttt{ in}}  & {\em ncav} & number of target points \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source_l00301}{301}} of file \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source}{ddx\+\_\+multipolar\+\_\+solutes.\+f90}}.

\mbox{\Hypertarget{namespaceddx__multipolar__solutes_adb70b786db1e8751f7c5b7faed714f41}\label{namespaceddx__multipolar__solutes_adb70b786db1e8751f7c5b7faed714f41}} 
\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}!build\_e\_fmm@{build\_e\_fmm}}
\index{build\_e\_fmm@{build\_e\_fmm}!ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}
\doxysubsubsection{\texorpdfstring{build\_e\_fmm()}{build\_e\_fmm()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+multipolar\+\_\+solutes\+::build\+\_\+e\+\_\+fmm (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(in)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{real(dp), dimension((mmax + 1)$\ast$$\ast$2, params \% nsph), intent(in)}]{multipoles,  }\item[{integer, intent(in)}]{mmax,  }\item[{real(dp), dimension(constants \% ncav), intent(out)}]{phi\+\_\+cav,  }\item[{real(dp), dimension(3, constants \% ncav), intent(out)}]{e\+\_\+cav }\end{DoxyParamCaption})}



Given a multipolar distribution, compute the potential and its gradient at the target points using FMMs. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em params} & ddx parameters \\
\hline
\mbox{\texttt{ in}}  & {\em constants} & ddx constants \\
\hline
\mbox{\texttt{ in,out}}  & {\em workspace} & ddx workspace \\
\hline
\mbox{\texttt{ in}}  & {\em multipoles} & multipoles as real spherical harmonics, size ((mmax+1)$\ast$$\ast$2,nsph) \\
\hline
\mbox{\texttt{ in}}  & {\em mmax} & maximum angular momentum of the multipoles \\
\hline
\mbox{\texttt{ out}}  & {\em phi\+\_\+cav} & electric potential at the target points, size (ncav) \\
\hline
\mbox{\texttt{ out}}  & {\em e\+\_\+cav} & electric field at the target points, size(3, ncav) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source_l00349}{349}} of file \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source}{ddx\+\_\+multipolar\+\_\+solutes.\+f90}}.

\mbox{\Hypertarget{namespaceddx__multipolar__solutes_a1b49c60c09fb229e96a9ce69d0808c8d}\label{namespaceddx__multipolar__solutes_a1b49c60c09fb229e96a9ce69d0808c8d}} 
\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}!build\_phi\_fmm@{build\_phi\_fmm}}
\index{build\_phi\_fmm@{build\_phi\_fmm}!ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}
\doxysubsubsection{\texorpdfstring{build\_phi\_fmm()}{build\_phi\_fmm()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+multipolar\+\_\+solutes\+::build\+\_\+phi\+\_\+fmm (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(in)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{real(dp), dimension((mmax + 1)$\ast$$\ast$2, params \% nsph), intent(in)}]{multipoles,  }\item[{integer, intent(in)}]{mmax,  }\item[{real(dp), dimension(constants \% ncav), intent(out)}]{phi\+\_\+cav }\end{DoxyParamCaption})}



Given a multipolar distribution, compute the potential at the target points using FMMs. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em params} & ddx parameters \\
\hline
\mbox{\texttt{ in}}  & {\em constants} & ddx constants \\
\hline
\mbox{\texttt{ in,out}}  & {\em workspace} & ddx workspace \\
\hline
\mbox{\texttt{ in}}  & {\em multipoles} & multipoles as real spherical harmonics, size ((mmax+1)$\ast$$\ast$2,nsph) \\
\hline
\mbox{\texttt{ in}}  & {\em mmax} & maximum angular momentum of the multipoles \\
\hline
\mbox{\texttt{ out}}  & {\em phi\+\_\+cav} & electric potential at the target points, size (ncav) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source_l00456}{456}} of file \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source}{ddx\+\_\+multipolar\+\_\+solutes.\+f90}}.

\mbox{\Hypertarget{namespaceddx__multipolar__solutes_a5c89baf7330431c44d60f075ab516c5f}\label{namespaceddx__multipolar__solutes_a5c89baf7330431c44d60f075ab516c5f}} 
\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}!build\_psi@{build\_psi}}
\index{build\_psi@{build\_psi}!ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}
\doxysubsubsection{\texorpdfstring{build\_psi()}{build\_psi()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+multipolar\+\_\+solutes\+::build\+\_\+psi (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(in)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{real(dp), dimension((mmax+1)$\ast$$\ast$2, params \% nsph), intent(in)}]{multipoles,  }\item[{integer, intent(in)}]{mmax,  }\item[{real(dp), dimension((params \% lmax+1)$\ast$$\ast$2, params \% nsph), intent(out)}]{psi }\end{DoxyParamCaption})}



Given a multipolar distribution, assemble the RHS psi. The multipoles must be centered on the ddx spheres. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em params} & ddx parameters \\
\hline
\mbox{\texttt{ in}}  & {\em constants} & ddx constants \\
\hline
\mbox{\texttt{ in,out}}  & {\em workspace} & ddx workspace \\
\hline
\mbox{\texttt{ in}}  & {\em multipoles} & multipoles as real spherical harmonics, size ((mmax+1)$\ast$$\ast$2,nsph) \\
\hline
\mbox{\texttt{ in}}  & {\em mmax} & maximum angular momentum of the multipoles \\
\hline
\mbox{\texttt{ out}}  & {\em psi} & RHS for adjoint linear systems, size ((lmax+1)$\ast$$\ast$2,nsph), the internal lmax should be \texorpdfstring{$>$}{>}= mmax \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source_l00508}{508}} of file \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source}{ddx\+\_\+multipolar\+\_\+solutes.\+f90}}.

\mbox{\Hypertarget{namespaceddx__multipolar__solutes_a61c22d6edf664b23153d1d41a1036db8}\label{namespaceddx__multipolar__solutes_a61c22d6edf664b23153d1d41a1036db8}} 
\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}!load\_m@{load\_m}}
\index{load\_m@{load\_m}!ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}
\doxysubsubsection{\texorpdfstring{load\_m()}{load\_m()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+multipolar\+\_\+solutes\+::load\+\_\+m (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(in)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{real(dp), dimension((mmax + 1)$\ast$$\ast$2, params \% nsph), intent(in)}]{multipoles,  }\item[{integer, intent(in)}]{mmax }\end{DoxyParamCaption})}



Given a multipolar distribution, load it into workspace \% tmp\+\_\+sph and workspace \% tmp\+\_\+node\+\_\+m to be used by the FMM. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em params} & ddx parameters \\
\hline
\mbox{\texttt{ in}}  & {\em constants} & ddx constants \\
\hline
\mbox{\texttt{ in,out}}  & {\em workspace} & ddx workspace \\
\hline
\mbox{\texttt{ in}}  & {\em multipoles} & multipoles as real spherical harmonics, size ((mmax+1)$\ast$$\ast$2,nsph) \\
\hline
\mbox{\texttt{ in}}  & {\em mmax} & maximum angular momentum of the multipoles \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source_l00540}{540}} of file \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source}{ddx\+\_\+multipolar\+\_\+solutes.\+f90}}.

\mbox{\Hypertarget{namespaceddx__multipolar__solutes_a854e543bad7f9523b75ce5037fed9bc9}\label{namespaceddx__multipolar__solutes_a854e543bad7f9523b75ce5037fed9bc9}} 
\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}!do\_fmm@{do\_fmm}}
\index{do\_fmm@{do\_fmm}!ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}
\doxysubsubsection{\texorpdfstring{do\_fmm()}{do\_fmm()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+multipolar\+\_\+solutes\+::do\+\_\+fmm (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(in)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace }\end{DoxyParamCaption})}



Given a multipolar distribution loaded in the workspace perform the M2M, M2L, L2L and L2P steps. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em params} & ddx parameters \\
\hline
\mbox{\texttt{ in}}  & {\em constants} & ddx constants \\
\hline
\mbox{\texttt{ in,out}}  & {\em workspace} & ddx workspace \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source_l00576}{576}} of file \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source}{ddx\+\_\+multipolar\+\_\+solutes.\+f90}}.

\mbox{\Hypertarget{namespaceddx__multipolar__solutes_a215cf69da966942d80f48639e5cd97d2}\label{namespaceddx__multipolar__solutes_a215cf69da966942d80f48639e5cd97d2}} 
\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}!grad\_m2m@{grad\_m2m}}
\index{grad\_m2m@{grad\_m2m}!ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}
\doxysubsubsection{\texorpdfstring{grad\_m2m()}{grad\_m2m()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+multipolar\+\_\+solutes\+::grad\+\_\+m2m (\begin{DoxyParamCaption}\item[{real(dp), dimension((mmax + 1)$\ast$$\ast$2, nm), intent(in)}]{multipoles,  }\item[{integer, intent(in)}]{mmax,  }\item[{integer, intent(in)}]{nm,  }\item[{real(dp), dimension((mmax + 2)$\ast$$\ast$2, 3, nm), intent(out)}]{tmp\+\_\+m\+\_\+grad }\end{DoxyParamCaption})}



Given a multipolar distribution compute the action of dP on it, this is required in the computation of the forces. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em multipoles} & multipoles as real spherical harmonics, size ((mmax+1)$\ast$$\ast$2, nsph) \\
\hline
\mbox{\texttt{ in}}  & {\em mmax} & maximum angular momentum of the multipolar distribution \\
\hline
\mbox{\texttt{ in}}  & {\em nm} & number of multipoles \\
\hline
\mbox{\texttt{ out}}  & {\em tmp\+\_\+m\+\_\+grad} & gradient of the M2M operator, size ((mmax + 1)$\ast$$\ast$2, 3, nm) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source_l00598}{598}} of file \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source}{ddx\+\_\+multipolar\+\_\+solutes.\+f90}}.

\mbox{\Hypertarget{namespaceddx__multipolar__solutes_aa56314068d15524fdb496363a8bd621f}\label{namespaceddx__multipolar__solutes_aa56314068d15524fdb496363a8bd621f}} 
\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}!grad\_phi\_for\_charges@{grad\_phi\_for\_charges}}
\index{grad\_phi\_for\_charges@{grad\_phi\_for\_charges}!ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}
\doxysubsubsection{\texorpdfstring{grad\_phi\_for\_charges()}{grad\_phi\_for\_charges()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+multipolar\+\_\+solutes\+::grad\+\_\+phi\+\_\+for\+\_\+charges (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(in)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{type(\mbox{\hyperlink{structddx__core_1_1ddx__state__type}{ddx\+\_\+state\+\_\+type}}), intent(inout)}]{state,  }\item[{integer, intent(in)}]{mmax,  }\item[{real(dp), dimension((mmax + 1)$\ast$$\ast$2, params \% nsph), intent(in)}]{multipoles,  }\item[{real(dp), dimension(3, params \% nsph), intent(inout)}]{forces,  }\item[{real(dp), dimension(3, constants \% ncav), intent(in)}]{e\+\_\+cav }\end{DoxyParamCaption})}



Given a charge distribution centered on the spheres, compute the contributions to the forces stemming from its electrostatic interactions. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em params} & ddx parameters \\
\hline
\mbox{\texttt{ in}}  & {\em constants} & ddx constants \\
\hline
\mbox{\texttt{ in,out}}  & {\em workspace} & ddx workspace \\
\hline
\mbox{\texttt{ in}}  & {\em mmax} & maximum angular momentum of the multipolar distribution \\
\hline
\mbox{\texttt{ in}}  & {\em multipoles} & multipoles as real spherical harmonics, size ((mmax+1)$\ast$$\ast$2, nsph) \\
\hline
\mbox{\texttt{ in,out}}  & {\em forces} & forces array, size (3, nsph) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source_l00671}{671}} of file \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source}{ddx\+\_\+multipolar\+\_\+solutes.\+f90}}.

\mbox{\Hypertarget{namespaceddx__multipolar__solutes_a29181299be03f0bb493cfd4cfb928a0b}\label{namespaceddx__multipolar__solutes_a29181299be03f0bb493cfd4cfb928a0b}} 
\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}!grad\_phi@{grad\_phi}}
\index{grad\_phi@{grad\_phi}!ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}
\doxysubsubsection{\texorpdfstring{grad\_phi()}{grad\_phi()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+multipolar\+\_\+solutes\+::grad\+\_\+phi (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(in)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{type(\mbox{\hyperlink{structddx__core_1_1ddx__state__type}{ddx\+\_\+state\+\_\+type}}), intent(inout)}]{state,  }\item[{integer, intent(in)}]{mmax,  }\item[{real(dp), dimension((mmax + 1)$\ast$$\ast$2, params \% nsph), intent(in)}]{multipoles,  }\item[{real(dp), dimension(3, params \% nsph), intent(inout)}]{forces,  }\item[{real(dp), dimension(3, constants \% ncav), intent(in)}]{e\+\_\+cav }\end{DoxyParamCaption})}



Given a multipolar distribution in real spherical harmonics and centered on the spheres, compute the contributions to the forces stemming from its electrostatic interactions. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em params} & ddx parameters \\
\hline
\mbox{\texttt{ in}}  & {\em constants} & ddx constants \\
\hline
\mbox{\texttt{ in,out}}  & {\em workspace} & ddx workspace \\
\hline
\mbox{\texttt{ in}}  & {\em mmax} & maximum angular momentum of the multipolar distribution \\
\hline
\mbox{\texttt{ in}}  & {\em multipoles} & multipoles as real spherical harmonics, size ((mmax+1)$\ast$$\ast$2, nsph) \\
\hline
\mbox{\texttt{ in,out}}  & {\em forces} & forces array, size (3, nsph) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source_l00738}{738}} of file \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source}{ddx\+\_\+multipolar\+\_\+solutes.\+f90}}.

\mbox{\Hypertarget{namespaceddx__multipolar__solutes_a9a9fa5a29ff449db9444710b285bcd80}\label{namespaceddx__multipolar__solutes_a9a9fa5a29ff449db9444710b285bcd80}} 
\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}!build\_adj\_phi@{build\_adj\_phi}}
\index{build\_adj\_phi@{build\_adj\_phi}!ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}
\doxysubsubsection{\texorpdfstring{build\_adj\_phi()}{build\_adj\_phi()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+multipolar\+\_\+solutes\+::build\+\_\+adj\+\_\+phi (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(in)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{real(dp), dimension(constants \% ncav), intent(in)}]{charges,  }\item[{integer, intent(in)}]{mmax,  }\item[{real(dp), dimension((mmax + 1)$\ast$$\ast$2, params \% nsph), intent(out)}]{adj\+\_\+phi }\end{DoxyParamCaption})}



Given a distribution of point charges at the cavity points, compute the potential and its higher order derivatives up to pmax at the center of the spheres. This is done with or without the FMMs depending on the given flag. This is used in the computation of the forces. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em params} & ddx parameters \\
\hline
\mbox{\texttt{ in}}  & {\em constants} & ddx constants \\
\hline
\mbox{\texttt{ in,out}}  & {\em workspace} & ddx workspace \\
\hline
\mbox{\texttt{ in}}  & {\em multipoles} & multipoles as real spherical harmonics, size ((mmax+1)$\ast$$\ast$2, nsph) \\
\hline
\mbox{\texttt{ in}}  & {\em mmax} & maximum angular momentum of the multipoles \\
\hline
\mbox{\texttt{ out}}  & {\em phi\+\_\+cav} & electric potential at the target points, size (ncav) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source_l00817}{817}} of file \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source}{ddx\+\_\+multipolar\+\_\+solutes.\+f90}}.

\mbox{\Hypertarget{namespaceddx__multipolar__solutes_ac565e05e02661402639fae28bdacc577}\label{namespaceddx__multipolar__solutes_ac565e05e02661402639fae28bdacc577}} 
\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}!build\_adj\_phi\_dense@{build\_adj\_phi\_dense}}
\index{build\_adj\_phi\_dense@{build\_adj\_phi\_dense}!ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}
\doxysubsubsection{\texorpdfstring{build\_adj\_phi\_dense()}{build\_adj\_phi\_dense()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+multipolar\+\_\+solutes\+::build\+\_\+adj\+\_\+phi\+\_\+dense (\begin{DoxyParamCaption}\item[{real(dp), dimension(ncav), intent(in)}]{qcav,  }\item[{real(dp), dimension(3, ncav), intent(in)}]{ccav,  }\item[{integer, intent(in)}]{ncav,  }\item[{real(dp), dimension(3, nm), intent(in)}]{cm,  }\item[{integer, intent(in)}]{mmax,  }\item[{integer, intent(in)}]{nm,  }\item[{real(dp), dimension((mmax + 1)$\ast$$\ast$2, nm), intent(out)}]{adj\+\_\+phi }\end{DoxyParamCaption})}



Given a distribution of point charges at the cavity points, compute the potential and its higher order derivatives up to pmax at the center of the spheres. This is done using two loops and required in the computation of the forces. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em qcav} & charges, size(ncav) \\
\hline
\mbox{\texttt{ in}}  & {\em ccav} & coordinates of the charges, size(3,ncav) \\
\hline
\mbox{\texttt{ in}}  & {\em ncav} & number of charges \\
\hline
\mbox{\texttt{ in}}  & {\em cm} & coordinates of the multipoles, size(3,nm) \\
\hline
\mbox{\texttt{ in}}  & {\em mmax} & maximum angular momentum of the multipoles \\
\hline
\mbox{\texttt{ in}}  & {\em nm} & number of multipoles \\
\hline
\mbox{\texttt{ out}}  & {\em adj\+\_\+phi} & adjoint potential, size((mmax+1)$\ast$$\ast$2,nm) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source_l00847}{847}} of file \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source}{ddx\+\_\+multipolar\+\_\+solutes.\+f90}}.

\mbox{\Hypertarget{namespaceddx__multipolar__solutes_a3a1c0765efbf39c7ef1a0cc2b6c1b826}\label{namespaceddx__multipolar__solutes_a3a1c0765efbf39c7ef1a0cc2b6c1b826}} 
\index{ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}!build\_adj\_phi\_fmm@{build\_adj\_phi\_fmm}}
\index{build\_adj\_phi\_fmm@{build\_adj\_phi\_fmm}!ddx\_multipolar\_solutes@{ddx\_multipolar\_solutes}}
\doxysubsubsection{\texorpdfstring{build\_adj\_phi\_fmm()}{build\_adj\_phi\_fmm()}}
{\footnotesize\ttfamily subroutine ddx\+\_\+multipolar\+\_\+solutes\+::build\+\_\+adj\+\_\+phi\+\_\+fmm (\begin{DoxyParamCaption}\item[{type(\mbox{\hyperlink{structddx__parameters_1_1ddx__params__type}{ddx\+\_\+params\+\_\+type}}), intent(in)}]{params,  }\item[{type(\mbox{\hyperlink{structddx__constants_1_1ddx__constants__type}{ddx\+\_\+constants\+\_\+type}}), intent(in)}]{constants,  }\item[{type(\mbox{\hyperlink{structddx__workspace_1_1ddx__workspace__type}{ddx\+\_\+workspace\+\_\+type}}), intent(inout)}]{workspace,  }\item[{real(dp), dimension(constants \% ncav), intent(in)}]{charges,  }\item[{integer, intent(in)}]{mmax,  }\item[{real(dp), dimension((mmax + 1)$\ast$$\ast$2, params \% nsph), intent(out)}]{adj\+\_\+phi }\end{DoxyParamCaption})}



Given a distribution of point charges at the cavity points, compute the potential and its higher order derivatives up to pmax at the center of the spheres. This is done with FMMs and required in the computation of the forces. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em params} & ddx parameters \\
\hline
\mbox{\texttt{ in}}  & {\em constants} & ddx constants \\
\hline
\mbox{\texttt{ in,out}}  & {\em workspace} & ddx workspace \\
\hline
\mbox{\texttt{ in}}  & {\em multipoles} & multipoles as real spherical harmonics, size ((mmax+1)$\ast$$\ast$2, nsph) \\
\hline
\mbox{\texttt{ in}}  & {\em mmax} & maximum angular momentum of the multipoles \\
\hline
\mbox{\texttt{ out}}  & {\em phi\+\_\+cav} & electric potential at the target points, size (ncav) \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source_l00893}{893}} of file \mbox{\hyperlink{ddx__multipolar__solutes_8f90_source}{ddx\+\_\+multipolar\+\_\+solutes.\+f90}}.

